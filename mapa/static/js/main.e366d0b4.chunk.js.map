{"version":3,"sources":["utils/CheckRouteChanges.js","utils/Utils.js","AppContext.js","components/SearchBar.js","components/Header.js","literals.js","components/Presentacio.js","utils/TileLayer.js","utils/MarkerClusterGroup.js","components/MainMap.js","components/MapaCentre.js","components/MapSection.js","components/SelectProgramsDlg.js","components/Programes.js","components/Error.js","components/FitxaPrograma.js","components/FitxaCentre.js","components/FitxaZona.js","components/Loading.js","components/Footer.js","components/Cerca.js","App.js","serviceWorker.js","index.js"],"names":["CheckRouteChanges","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","updateHandler","prevProps","children","React","Component","withRouter","Utils","loadGFont","fontName","arguments","length","undefined","weights","link","document","createElement","href","concat","rel","head","appendChild","FontFaceObserver","load","then","documentElement","classList","add","replace","toLowerCase","catch","err","console","error","handleFetchErrors","response","ok","Error","statusText","sumAll","obj","values","reduce","acc","v","plainArray","container","keys","forEach","curs","prog","id","nom","simbol","cursos","push","sort","c1","c2","localeCompare","sortObjectArrayBy","array","fields","a","b","map","f","join","cursCurt","substr","DEFAULT_DATA","programes","Map","centres","poligons","estudis","nivells","ambitsCurr","ambitsInn","cursosDisp","DEFAULT_STATE","loading","dataLoaded","polygons","currentPrograms","Set","program","delayedMapUpdate","updateMap","fuseFuncs","menuItems","data","AppContext","createContext","SearchBar","_ref","_ref$closeFn","closeFn","history","_ref$mini","mini","_React$useState","useState","_React$useState2","slicedToArray","searchText","setSearchText","search","ev","preventDefault","react_default","className","onSubmit","IconButton_default","color","aria-label","title","onClick","Search_default","TextField_default","value","InputProps","disableUnderline","onChange","target","Close_default","location","drawerOpened","setDrawerOpened","_React$useState3","_React$useState4","searchOpened","setSearchOpened","src_AppContext","Consumer","_ref2","hasDrawer","searchFn","itemAction","item","path","mi","current","pathname","Fragment","AppBar_default","position","Toolbar_default","disableGutters","Menu_default","components_SearchBar","Typography_default","variant","noWrap","key","role","name","Drawer_default","anchor","open","List_default","ListItem_default","component","divider","button","ListItemIcon_default","ChevronLeft_default","ListItemText_default","primary","intro","MD_OPTIONS","escapeHtml","Presentacio","Paper_default","with_html_default","Button_default","LAYERS","osm","attribution","url","mapbox","accessToken","process","wikimedia","minZoom","maxZoom","BUILT_LAYERS","getTileLayer","_ref$type","type","TileLayer","require","MarkerClusterGroup","_props$clusterProps","clusterProps","el","L","markerClusterGroup","objectSpread","contextValue","leaflet","layerContainer","MapLayer","withLeaflet","TILE_LAYER","PRESERVE_MAP_BOUNDS","REACT_APP_PRESERVE_MAP_BOUNDS","MAP_BOUNDS","MAX_BOUNDS","MARKERCLUSTER_PROPS","showCoverageOnHover","maxClusterRadius","MainMap","_ref$points","points","_ref$polygons","_ref$programa","programa","_ref$poli","poli","_ref$zoom","center","zoom","_ref$maxZoom","OVERLAYS","flag","default","OVERLAY_SETTINGS_STORAGE","window","localStorage","getBool","getItem","setVal","val","setItem","MAP_BOUNDS_STORAGE","sessionStorage","preserveBounds","currentlySavedBounds","str","split","Number","getSavedBounds","boundsChanged","bounds","getBounds","toBBoxString","overlayChange","ov","findIndex","overlayVisible","currentLayer","stored","popupZona","zona","centresPart","size","estudisPart","estudisBase","perCent","toFixed","Popup","style","cursor","es_Map","assign","maxBounds","onBaseLayerChange","layerIndex","p","onOverlayAdd","onOverlayRemove","onZoomEnd","onMoveEnd","utils_TileLayer","LayersControl","i","BaseLayer","checked","tipus","LayerGroup","shapes","filter","sh","n","Polygon","positions","weight","fillOpacity","Overlay","density","utils_MarkerClusterGroup","pt","Marker","lat","lng","centre","adreca","web","popupCentre","dist_default","titleCancel","MapaCentre","point","_ref$center","MapSection","_ref$data","mapChanged","singleCentre","get","w","innerWidth","addSchoolsOfProgram","progId","dest","includes","centresInn","has","find","c","Stepper_default","nonLinear","alternativeLabel","activeStep","k","Step_default","StepButton_default","result","completed","SelectProgramsDlg","dlgOpen","setDlgOpen","ambitInn","setAmbitInn","ambitCurr","setAmbitCurr","_React$useState5","Array","from","_React$useState6","nivellsChk","setNivellsChk","_React$useState7","_React$useState8","setCurrentPrograms","updateCurrentPrograms","progs","ambInn","ambCurr","nivell","tag","useMemo","listSelection","handle","closeDialog","Dialog_default","onEnter","aria-labelledby","classes","paper","DialogTitle_default","DialogContent_default","_ref4","FormControlLabel_default","control","Checkbox_default","defineProperty","label","FormControl_default","InputLabel_default","htmlFor","Select_default","inputProps","MenuItem_default","DialogActions_default","Programes","_ref2$data","allSelected","handleProgClick","handleProgSelect","querySelector","scrollIntoView","ArrowDownward_default","components_SelectProgramsDlg","labelPlacement","_p","clear","_ref3","ListItemAvatar_default","Avatar_default","src","alt","secondary","ListItemSecondaryAction_default","Switch_default","components_MapSection","refetch","ReportProblem_default","Refresh_default","goBack","ArrowBack_default","createExpansionPanel","mdContent","ExpansionPanel_default","classname","ExpansionPanelSummary_default","expandIcon","ExpandMore_default","marginTop","ExpansionPanelDetails_default","FitxaPrograma","match","params","components_Error","descripcio","fitxa","video","objectius","requisits","compromisos","contacte","normativa","arees","t","CloudDownload_default","dense","codi","municipi","titols","MODE_PROG_CENTRE","FitxaCentre","comarca","logo","nodes","web_propi","tel","mail","twitter","sstt","se","pb","public","obrePrograma","servei_territorial","servei_educatiu","e","react_router_dom","to","FitxaZona","cp","fax","correu","obreCentre","Loading","CircularProgress_default","Footer","version","license","repository","DEFAULT_ITEMS_PER_PAGE","Cerca","query","page","setPage","itemsPerPage","setItemsPerPage","queryResults","setQueryResults","currentQuery","setCurrentQuery","qr","ff","goToElement","slice","_ref3$item","Group_default","School_default","TablePagination_default","spacer","toolbar","rowsPerPage","onChangeRowsPerPage","count","onChangePage","labelDisplayedRows","labelRowsPerPage","MAX_DENSITY","MIN_DENSITY","MINMAX_DENSITY","DEBUG_GLOBAL_VAR","REACT_APP_DEBUG_GLOBAL_VAR","theme","createMuiTheme","palette","main","color_error","typography","fontFamily","useNextVariants","overrides","MuiStepIcon","App","state","currentProgramsChanged","setStateMod","requestAnimationFrame","updateLayersDensity","setTimeout","contentUpdated","checkForLayerUpdate","scrollTo","test","check","exec","currentCentres","pid","ce","st","maxDensityST","maxDensitySE","d","Math","max","factorST","factorSE","_this2","callback","setState","_this3","Promise","all","uri","fetch","method","credentials","json","_programes","_instancies","_centres","_poligons","_estudis","pts","vs","nomCurt","ins","titol","log","fuseOptions","caseSensitive","shouldSort","tokenize","matchAllTokens","includeScore","includeMatches","threshold","distance","maxPatternLength","minMatchCharLength","Fuse","entries","toConsumableArray","toString","_this4","loadData","hash","_this$state","basename","CssBaseline_default","MuiThemeProvider_default","Provider","utils_CheckRouteChanges","components_Header","components_Loading","react_router","exact","components_Footer","contextType","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","src_App","getElementById","URL","origin","addEventListener","contentType","headers","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.e366d0b4.chunk.js","sourcesContent":["import React from 'react';\nimport { withRouter } from 'react-router-dom';\n\n// Scroll to top on each router navigation\n// See: https://reacttraining.com/react-router/web/guides/scroll-restoration\nclass CheckRouteChanges extends React.Component {\n  constructor(props) {\n    super(props);\n    this.updateHandler = props.updateHandler;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.updateHandler)\n      this.updateHandler(this.props, prevProps);\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\nexport default withRouter(CheckRouteChanges);\n","// From: https://github.com/zeit/next.js/issues/512#issuecomment-322026199\n\nimport FontFaceObserver from 'fontfaceobserver';\n\n/**\n * Asynchronous loading of Google fonts\n */\nfunction loadGFont(fontName = 'Roboto', weights = '300,400,500,600') {\n  const link = document.createElement('link');\n  link.href = `https://fonts.googleapis.com/css?family=${fontName}:${weights}`;\n  link.rel = 'stylesheet';\n\n  document.head.appendChild(link);\n  const fontLoader = new FontFaceObserver(fontName);\n  fontLoader.load()\n    .then(() => document.documentElement.classList.add(fontName.replace(' ', '-').toLowerCase()))\n    .catch(err => console.error(`Unable to load ${fontName} font due to: ${err}`));\n}\n\n/**\n * Handle errors on fetch calls\n * @param {Object} response \n */\nfunction handleFetchErrors(response) {\n  if (!response.ok)\n    throw Error(response.statusText || 'Error desconegut');\n  return response;\n}\n\n/**\n * Return the addition of all values in an object of type `{key: value, key: value, ...}` where all values are numbers.\n * @param {object} obj \n */\nfunction sumAll(obj) {\n  return Object.values(obj).reduce((acc, v) => acc + v, 0);\n}\n\n/**\n * Used in objects of type {curs1: [prog1, prog2, prog3, ...], curs2: [prog1, ...], ...}\n * Returns a single array of type: [{id: prog1.id, nom: prog1.nom, cursos: [curs1, curs2, ...]}, {id: prog2.id, nom: prog2.nom, cursos: [curs1, ...]}, ...]\n * @param {object} obj - Object structured as in the description\n * @returns {object[]} - The resulting array of objects of type 'program', with a 'cursos' field.\n */\nfunction plainArray(obj) {\n  const container = {};\n  Object.keys(obj).forEach(curs => {\n    obj[curs].forEach(prog => {\n      if (!container[prog.id]) {\n        container[prog.id] = {\n          id: prog.id,\n          nom: prog.nom,\n          simbol: prog.simbol,\n          cursos: [],\n        };\n      }\n      container[prog.id].cursos.push(curs);\n    });\n  });\n  return Object.values(container).sort((c1, c2) => c1.nom.localeCompare(c2.nom));\n}\n\n/**\n * Converts an expression of type '2015-2016' to '2015-16'\n */\nfunction cursCurt(curs) {\n  return curs.length === 9 ? `${curs.substr(0, 5)}${curs.substr(7, 2)}` : curs;\n}\n\n\n/**\n * Sort an array of objects having the same string property\n * @param {Array} array - The array to be sorted\n * @param {string|string[]]} fields - The name or names of the attributes to be compared between array elements\n * @returns {Array} - The sorted array\n */\nfunction sortObjectArrayBy(array, fields) {\n  return typeof fields === 'string'\n    ? array.sort((a, b) => a[fields].localeCompare(b[fields]))\n    : array.sort((a, b) => fields.map(f => a[f]).join(' ').localeCompare(fields.map(f => b[f]).join(' ')));\n}\n\nexport default { loadGFont, handleFetchErrors, sumAll, plainArray, sortObjectArrayBy, cursCurt };\n","import React from 'react';\n\nexport const DEFAULT_DATA = {\n  programes: new Map(),\n  centres: new Map(),\n  poligons: new Map(),\n  estudis: new Map(),\n  nivells: new Map(),\n  ambitsCurr: new Map(),\n  ambitsInn: new Map(),\n  cursosDisp: [],\n};\n\nexport const DEFAULT_STATE = {\n  loading: true,\n  dataLoaded: false,\n  error: false,\n  polygons: [],\n  currentPrograms: new Set(),\n  program: null,\n  cursos: [],\n  delayedMapUpdate: true,\n  // Inmutable attributes\n  updateMap: () => null,\n  fuseFuncs: [],\n  menuItems: [],\n  data: DEFAULT_DATA,\n};\n\nconst AppContext = React.createContext(DEFAULT_STATE);\n\nexport default AppContext;\n","import React from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SearchIcon from '@material-ui/icons/Search';\n\nfunction SearchBar({ closeFn = () => null, history, mini = false }) {\n\n  const [searchText, setSearchText] = React.useState('');\n  const search = (ev) => {\n    ev.preventDefault();\n    closeFn();\n    history.push(`/cerca/${searchText}`);\n    setSearchText('');\n  };\n\n  return (\n    <form\n      className=\"search-bar\"\n      onSubmit={search}>\n      <IconButton\n        className=\"search-btn\"\n        color=\"inherit\"\n        aria-label=\"Cerca\"\n        title=\"Cerca\"\n        onClick={search}\n      >\n        <SearchIcon />\n      </IconButton>\n      <TextField\n        aria-label=\"Cerca text...\"\n        title=\"Cerca text...\"\n        className=\"search-text\"\n        value={searchText}\n        InputProps={{ disableUnderline: true }}\n        onChange={ev => setSearchText(ev.target.value)}\n      />\n      {!mini &&\n        <IconButton\n          className=\"search-close\"\n          color=\"inherit\"\n          aria-label=\"Tanca\"\n          title=\"Tanca\"\n          onClick={closeFn}\n        >\n          <CloseIcon />\n        </IconButton>\n      }\n    </form>\n  );\n}\n\nexport default SearchBar;\n","import React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport AppContext from '../AppContext';\nimport AppBar from '@material-ui/core/AppBar';\nimport ToolBar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Typography from '@material-ui/core/Typography';\nimport SearchBar from './SearchBar';\nimport Drawer from '@material-ui/core/Drawer';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nfunction Header({ history, location }) {\n\n  const [drawerOpened, setDrawerOpened] = React.useState(false);\n  const [searchOpened, setSearchOpened] = React.useState(false);\n\n  return (\n    <AppContext.Consumer>\n      {({ menuItems, searchFn }) => {\n\n        const hasDrawer = menuItems && menuItems.length > 0;\n\n        const itemAction = (item) => () => {\n          setDrawerOpened(false);\n          if (item.path)\n            history.push(item.path);\n        }\n\n        menuItems.forEach(mi => mi.current = mi.path === location.pathname);\n\n        return (\n          <>\n            <AppBar\n              className=\"header\"\n              position=\"fixed\"\n            >\n              <ToolBar\n                disableGutters={true}\n              >\n                {hasDrawer &&\n                  <IconButton\n                    className=\"main-menu-button\"\n                    color=\"inherit\"\n                    aria-label=\"Seccions\"\n                    title=\"Seccions\"\n                    onClick={() => setDrawerOpened(true)}\n                  >\n                    <MenuIcon />\n                  </IconButton>\n                }\n                <div className=\"main-header-block\">\n                  <div className=\"top-bar\">\n                    <a className=\"logo-gencat\" href=\"https://web.gencat.cat/\" title=\"Generalitat de Catalunya\" target=\"_top\">gencat.cat</a>\n                    <SearchBar {...{ className: 'search-bar', history, mini: true }} />\n                  </div>\n                  <Typography className=\"main-title\" variant=\"h6\" color=\"inherit\" noWrap>\n                    Mapa de la Innovaci Educativa\n                </Typography>\n                  <ul className=\"nav-bar\">\n                    {menuItems.map(item => (\n                      <li key={item.id}>\n                        <div className=\"nav-label\" role=\"button\" current={item.current ? 'true' : 'false'} onClick={itemAction(item)}>{item.name}</div>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n                <IconButton\n                  className=\"search-btn-small\"\n                  color=\"inherit\"\n                  aria-label=\"Cerca\"\n                  title=\"Cerca\"\n                  onClick={() => setSearchOpened(!searchOpened)}\n                >\n                  <SearchIcon />\n                </IconButton>\n              </ToolBar>\n              {searchOpened && <SearchBar {...{ closeFn: () => setSearchOpened(false), history }} />}\n            </AppBar>\n            {\n              hasDrawer &&\n              <Drawer\n                variant=\"persistent\"\n                anchor=\"left\"\n                open={drawerOpened}\n              >\n                <List>\n                  <ListItem component=\"li\" divider button onClick={() => setDrawerOpened(false)}>\n                    <ListItemIcon>\n                      <ChevronLeftIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Tanca el men\" />\n                  </ListItem>\n                  {menuItems.map(item => (\n                    <ListItem component=\"li\" button key={item.id} onClick={itemAction(item)}>\n                      <ListItemText primary={item.name} />\n                    </ListItem>\n                  ))}\n                </List>\n              </Drawer>\n            }\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default withRouter(Header);\n","// Textos utilitzats a l'aplicaci\n\nexport const intro = `\n#### ATENCI: Espai en construcci\n\nLarticle 84 de la Llei 12/2009, deducaci, estableix la voluntat dafavorir les iniciatives de desenvolupament de projectes dinnovaci pedaggica\ni curricular amb lobjectiu, entre altres, destimular la capacitat daprenentatge i lxit escolar de tot lalumnat.\n\nEn el context normatiu de la LEC, lordre Ens/303/2015 de reconeixement de la innovaci educativa es desenvolupa a partir dels articles 84 i 85, amb\nlobjectiu de coordinar i impulsar les actuacions que el Departament dEducaci  promou en matria dinnovaci pedaggica i establir el marc de la\ninnovaci pedaggica, que defineix i estableix les diferents modalitats dinnovaci pedaggica i el procediment com pel seu reconeixement.\n\n<img src=\"logos/ambits_innovacio.png\" alt=\"mbits d'innovaci\" style=\"display: block; margin: auto;\"/>\n\nEl mapa de la Innovaci mostra els centres de Catalunya que han dut a terme accions educatives innovadores sota el reconeixement del Marc de la\ninnovaci pedaggica, ja sigui com a membres dels programes dinnovaci proposats pel Departament dEducaci o com a centres on shan implementat\nprojectes dinnovaci pedaggica propis reconeguts.\n\n`;\n\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { intro } from '../literals';\n\nconst MD_OPTIONS = {\n  escapeHtml: false,\n};\n\nfunction Presentacio({ history }) {\n\n  return (\n    <AppContext.Consumer>\n      {() => {\n        return (\n          <section className=\"seccio presenta\">\n            <Paper className=\"paper\">\n              <Typography variant=\"h4\" color=\"inherit\">Presentaci</Typography>\n              <ReactMarkdown {...MD_OPTIONS}>\n                {intro}\n              </ReactMarkdown>\n              <Button\n                className=\"close-intro-btn\"\n                variant=\"outlined\"\n                onClick={() => history.push('/programes')}\n              >Ves al mapa</Button>\n            </Paper>\n          </section>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Presentacio;","import React from 'react';\nimport { TileLayer } from 'react-leaflet';\n\nconst LAYERS = {\n  // Original OpenStreetMap\n  osm: {\n    attribution: '&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\n    url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  },\n  // Mapbox.com\n  // ATENCI: Max. 50.000 visualitzacions / mes\n  // Veure https://mapbox.com\n  // Provar amb id: `mapbox.satellite`, `mapbox.streets`...\n  mapbox: {\n    attribution: 'Dades del mapa  contribudors de <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a>, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imatges  <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n    url: 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',\n    id: 'mapbox.streets',\n    accessToken: process.env.REACT_APP_MAPBOX_TOKEN || '',\n  },\n  // Wikimedia\n  wikimedia: {\n    attribution: '<a href=\"https://wikimediafoundation.org/wiki/Maps_Terms_of_Use\">Wikimedia</a>',\n    url: 'https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png',\n    minZoom: 1,\n    maxZoom: 19,\n  }\n};\n\nconst BUILT_LAYERS = {};\n\nfunction getTileLayer({ type = 'wikimedia' }) {\n  if (!BUILT_LAYERS[type])\n    BUILT_LAYERS[type] = <TileLayer {...LAYERS[type]} />\n  return BUILT_LAYERS[type];\n}\n\nexport default getTileLayer;\n","// Workaround to erors in `react-leaflet-markercluster`\n// From: https://github.com/YUzhva/react-leaflet-markercluster/issues/71#issuecomment-466393028\n\nimport { MapLayer, withLeaflet } from 'react-leaflet';\nimport L from 'leaflet';\nrequire('leaflet.markercluster');\n// Moved to `index.js`\n// import 'leaflet.markercluster/dist/MarkerCluster.css';\n// import 'leaflet.markercluster/dist/MarkerCluster.Default.css';\n\nclass MarkerClusterGroup extends MapLayer {\n\n  createLeafletElement(props) {\n    const { clusterProps = {} } = props;\n    const el = new L.markerClusterGroup({ ...props, ...clusterProps });\n    this.contextValue = {\n      ...props.leaflet,\n      layerContainer: el\n    };\n    return el;\n  }\n}\n\nexport default withLeaflet(MarkerClusterGroup);\n","import React from 'react';\nimport { Map, Polygon, Marker, Popup, LayersControl, LayerGroup } from 'react-leaflet';\nimport TileLayer from '../utils/TileLayer';\nimport MarkerClusterGroup from '../utils/MarkerClusterGroup';\n// Moved to `index.js`:\n// import 'react-leaflet-fullscreen/dist/styles.css';\nimport FullscreenControl from 'react-leaflet-fullscreen';\nimport Utils from '../utils/Utils';\n\n// See ../utils/TileLayer for all available options\nconst TILE_LAYER = process.env.REACT_APP_TILE_LAYER || 'wikimedia';\nconst PRESERVE_MAP_BOUNDS = (process.env.REACT_APP_PRESERVE_MAP_BOUNDS || 'true') === 'true';\n\n// Enlarge map bounds to make space for popups\nconst MAP_BOUNDS = [[40.50, 0.15], [42.90, 3.34]];\nconst MAX_BOUNDS = [[39.50, -0.85], [43.90, 4.34]];\n\n// Options for MarkerCluster\n// See: https://github.com/Leaflet/Leaflet.markercluster\nconst MARKERCLUSTER_PROPS = {\n  showCoverageOnHover: false, // Default is `true`\n  maxClusterRadius: 30, // Default is 80\n};\n\nexport default function MainMap({ points = [], polygons = [], programa = null, poli = null, center = [41.7, 1.8], zoom = 8, maxZoom = 13, history, updateMap }) {\n\n  // Optional overlays\n  const OVERLAYS = [\n    {\n      name: 'Mostra la participaci per zones',\n      flag: 'showDensity',\n      default: false,\n    },\n    {\n      name: 'Mostra els centres',\n      flag: 'showCentres',\n      default: true,\n    },\n  ];\n\n  // Save overlay preferences to browser's local storage\n  const OVERLAY_SETTINGS_STORAGE = window.localStorage;\n  const getBool = key => OVERLAY_SETTINGS_STORAGE.getItem(key) === 'true';\n  const getInt = key => Number(OVERLAY_SETTINGS_STORAGE.getItem(key));\n  const setVal = (key, val) => OVERLAY_SETTINGS_STORAGE.setItem(key, val);\n\n  // Save the current map bounds in session storage, thus allowing to navigate between pages preserving map layout.\n  const MAP_BOUNDS_STORAGE = window.sessionStorage;\n  const saveBounds = (bounds) => MAP_BOUNDS_STORAGE.setItem('mapBounds', bounds.toBBoxString());\n  const getSavedBounds = () => {\n    const str = MAP_BOUNDS_STORAGE.getItem('mapBounds');\n    if (!str)\n      return null;\n    const values = str.split(',');\n    if (values.length !== 4)\n      return null;\n    return [[\n      Number(values[1]), // Lat SW\n      Number(values[0]), // Lng SW\n    ], [\n      Number(values[3]), // Lat NE\n      Number(values[2]), // Lng NE\n    ]];\n  };\n\n  // Don't preserve map bounds in `single polygon` mode\n  const preserveBounds = PRESERVE_MAP_BOUNDS && poli === null;\n  const currentlySavedBounds = preserveBounds && getSavedBounds();\n\n  // Handle zoom changes\n  const boundsChanged = ev => {\n    if (preserveBounds && ev.target && ev.target.getBounds)\n      saveBounds(ev.target.getBounds());\n  }\n\n  // Line width and opacity of polygons\n  const lineWidth = 2;\n  const minOpacity = 0;\n\n  // Force `updateMap` when changing some layout settings\n  const onBaseLayerChange = (ev) => {\n    const layerIndex = polygons.findIndex(p => p.name === ev.name);\n    if (layerIndex >= 0) {\n      setVal('currentLayer', layerIndex);\n      if (getBool(OVERLAYS[0].flag))\n        updateMap({}, false);\n    }\n  }\n\n  // Force `updateMap` when changing some overlay settings\n  const overlayChange = (type) => (ev) => {\n    const ov = OVERLAYS.findIndex(ov => ov.name === ev.name);\n    if (ov >= 0) {\n      const overlayVisible = (type === 'add');\n      OVERLAY_SETTINGS_STORAGE.setItem(OVERLAYS[ov].flag, overlayVisible);\n      if (ov === 0 && overlayVisible)\n        updateMap({}, false);\n    }\n  }\n\n  // Current layer defaults to \"SEZ\" (ndex 1)\n  const currentLayer = getInt('currentLayer');\n  setVal('currentLayer', currentLayer);\n\n  // Set default or stored value in each overlay\n  OVERLAYS.forEach(ov => {\n    const stored = OVERLAY_SETTINGS_STORAGE.getItem(ov.flag);\n    setVal(ov.flag, stored === null ? ov.default : stored);\n  });\n\n  const obreCentre = (id) => () => history.push(`/centre/${id}`);\n\n  const popupCentre = (centre) => (\n    <Popup>\n      <h4 style={{ cursor: 'pointer' }} onClick={obreCentre(centre.id)}>{centre.nom}</h4>\n      {centre.adreca}<br />\n      <a href={centre.web}>{centre.web}</a>\n    </Popup>\n  );\n\n  const obreZona = (key) => () => history.push(`/zona/${key}`);\n\n  const popupZona = (zona) => {\n    const centresPart = zona.centresPart.size;\n    const estudisPart = Utils.sumAll(zona.estudisPart);\n    const estudisBase = Utils.sumAll(zona.estudisBase);\n    const perCent = (estudisBase > 0 ? (estudisPart / estudisBase) * 100 : 0).toFixed(1);\n    return <Popup>\n      <h4 style={{ cursor: 'pointer' }} onClick={obreZona(zona.key)}>{zona.nom}</h4>\n      {(centresPart &&\n        <p>\n          <span>{`Centres participants ${programa ? 'al programa seleccionat' : 'als programes seleccionats'}: ${centresPart}`}</span><br />\n          <span>{`ndex de participaci: ${perCent}%`}</span>\n        </p>) ||\n        <p>No hi ha cap centre que participi als programes seleccionats.</p>\n      }\n    </Popup>\n  };\n\n  return (\n    <Map\n      className=\"mapa markercluster-map\"\n      {...{\n        maxZoom,\n        minZoom: zoom,\n        bounds: (poli && poli.bounds) || currentlySavedBounds || MAP_BOUNDS,\n        maxBounds: MAX_BOUNDS,\n        onBaseLayerChange,\n        onOverlayAdd: overlayChange('add'),\n        onOverlayRemove: overlayChange('remove'),\n        onZoomEnd: boundsChanged,\n        onMoveEnd: boundsChanged,\n      }}\n    >\n      <TileLayer type={TILE_LAYER} />\n      <LayersControl position=\"topright\">\n        {polygons.map((p, i) => (\n          <LayersControl.BaseLayer name={p.name} key={i} checked={poli !== null ? i === (poli.tipus === 'SEZ' ? 1 : 0) : i === currentLayer}>\n            <LayerGroup>\n              {p.shapes.filter(sh => poli === null || poli === sh).map((sh, n) => (\n                <Polygon\n                  key={n}\n                  positions={sh.poligons}\n                  weight={lineWidth}\n                  fillOpacity={minOpacity}\n                >\n                  {popupZona(sh)}\n                </Polygon>))}\n            </LayerGroup>\n          </LayersControl.BaseLayer>\n        ))}\n        <LayersControl.Overlay name={OVERLAYS[0].name} checked={poli === null && getBool(OVERLAYS[0].flag)}>\n          <LayerGroup>\n            {polygons[currentLayer].shapes.filter(sh => poli === null || poli === sh).map((sh, n) => (\n              <Polygon\n                key={n}\n                positions={sh.poligons}\n                weight={0}\n                fillOpacity={sh.density}\n              >\n                {popupZona(sh)}\n              </Polygon>))}\n          </LayerGroup>\n        </LayersControl.Overlay>\n        <LayersControl.Overlay name={OVERLAYS[1].name} checked={poli !== null || getBool(OVERLAYS[1].flag)}>\n          <MarkerClusterGroup clusterProps={MARKERCLUSTER_PROPS}>\n            {points.map(pt => (\n              <Marker key={pt.id} position={[pt.lat, pt.lng]}>\n                {popupCentre(pt)}\n              </Marker>\n            ))}\n          </MarkerClusterGroup>\n        </LayersControl.Overlay>\n      </LayersControl>\n      <FullscreenControl\n        position=\"topleft\"\n        title=\"Mostra el mapa a pantalla completa\"\n        titleCancel=\"Surt de la pantalla completa\"\n      />\n    </Map>\n  )\n}\n","import React from 'react';\nimport { Map, Marker } from 'react-leaflet';\nimport TileLayer from '../utils/TileLayer';\n\n// See ../utils/TileLayer for all available options\nconst TILE_LAYER = process.env.REACT_APP_TILE_LAYER || 'wikimedia';\nconst MAP_BOUNDS = [[40.50, 0.15], [42.90, 3.34]];\n\nexport default function MapaCentre({ point, center = [41.7, 1.8], zoom = 8, maxZoom = 19 }) {\n\n  return (\n    <Map\n      className=\"mapa-centre\"\n      {...{ center, zoom, maxZoom, minZoom: zoom, maxBounds: MAP_BOUNDS }}\n    >\n      <TileLayer type={TILE_LAYER} />\n      <Marker key={point.id} position={[point.lat, point.lng]} />\n    </Map>\n  )\n}","import React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport MainMap from './MainMap';\nimport MapaCentre from './MapaCentre';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepButton from '@material-ui/core/StepButton';\nimport Utils from '../utils/Utils';\n\nfunction MapSection({ data: { programes, centres, poligons, cursosDisp }, programa, centre, zona, cursos, currentPrograms, polygons, mapChanged, history, updateMap }) {\n\n  const singleCentre = centre ? centres.get(centre) : null;\n  const poli = zona ? poligons.get(zona) : null;\n  const w = window.innerWidth;\n  const zoom = w < 600 ? 7 : w < 820 ? 8 : w < 1300 ? 7 : 8;\n\n  const addSchoolsOfProgram = (progId, dest) => {\n    const prog = programes.get(progId);\n    if (prog)\n      Object.keys(prog.centres).forEach(curs => {\n        if (!cursos || cursos.includes(curs))\n          prog.centres[curs].forEach(centre => {\n            if ((!poli || poli.centresInn.has(centre)) && !dest.find(c => c.id === centre.id))\n              dest.push(centre)\n          });\n      });\n    return dest;\n  };\n\n  const points = [];\n  if (!mapChanged) {\n    if (singleCentre) {\n      points.push(singleCentre);\n    }\n    else if (programa)\n      addSchoolsOfProgram(programa, points);\n    else\n      currentPrograms.forEach(progId => addSchoolsOfProgram(progId, points));\n  }\n\n  const handleSelectCurs = curs => ev => {\n    const result = [];\n    cursosDisp.forEach(c => {\n      if ((curs === c && !cursos.includes(c)) || (curs !== c && cursos.includes(c)))\n        result.push(c);\n    });\n    updateMap({ cursos: result }, true, true);\n\n  }\n\n  return (\n    <section className=\"seccio smapa\">\n      <Paper className={singleCentre ? 'paper' : 'paper no-padding-top'}>\n        {(singleCentre &&\n          <MapaCentre\n            {...{\n              point: singleCentre,\n              center: [singleCentre.lat, singleCentre.lng],\n              zoom: 15,\n              maxZoom: 19,\n            }}\n          />) ||\n          <>\n            <Stepper\n              className=\"cursos\"\n              nonLinear\n              alternativeLabel\n              activeStep={null}\n            >\n              {cursosDisp.map((c, k) => (\n                <Step key={c}>\n                  <StepButton\n                    onClick={handleSelectCurs(c)}\n                    completed={cursos.includes(c)}\n                  >{Utils.cursCurt(c)}</StepButton>\n                </Step>\n              ))}\n            </Stepper>\n            <MainMap\n              {...{\n                points,\n                polygons,\n                programa,\n                poli,\n                center: [41.7, 1.8],\n                zoom,\n                maxZoom: 19,\n                history,\n                updateMap\n              }}\n            />\n          </>\n        }\n      </Paper>\n    </section>\n  );\n}\n\nexport default MapSection;\n","import React from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Typography from '@material-ui/core/Typography';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\n\n\nfunction SelectProgramsDlg({ dlgOpen, setDlgOpen, data: { programes, ambitsCurr, ambitsInn, nivells }, updateMap }) {\n\n  const [ambitInn, setAmbitInn] = React.useState('');\n  const [ambitCurr, setAmbitCurr] = React.useState('');\n  const [nivellsChk, setNivellsChk] = React.useState(Array.from(nivells).reduce((v, [n]) => { v[n] = true; return v; }, {}));\n\n  // Better to user a react reducer?\n  const [currentPrograms, setCurrentPrograms] = React.useState(new Set());\n\n  const updateCurrentPrograms = () => {\n    const progs = new Set();\n    programes.forEach((prog, id) => {\n      if (\n        (ambitInn === '' || prog.ambInn.includes(ambitInn)) &&\n        (ambitCurr === '' || prog.ambCurr.includes(ambitCurr)) &&\n        Object.keys(nivellsChk).find(nivell => nivellsChk[nivell] && nivells.get(nivell).find(tag => prog.tipus.includes(tag)))\n      )\n        progs.add(id);\n    });\n    setCurrentPrograms(progs);\n    // TODO: Comptar centres!\n  };\n\n  React.useMemo(updateCurrentPrograms, [ambitInn, ambitCurr, nivellsChk]);\n\n  const listSelection = handle => ev => {\n    handle(ev.target.value);\n  };\n\n  const handleCheckNivell = n => ev => {\n    setNivellsChk({ ...nivellsChk, [n]: ev.target.checked });\n  };\n\n  const closeDialog = ok => ev => {\n    if (ok)\n      updateMap({ currentPrograms }, true, true);\n    setDlgOpen(false);\n  };\n\n  return (\n    <Dialog\n      open={dlgOpen}\n      onEnter={updateCurrentPrograms}\n      aria-labelledby=\"dialog-title\"\n      classes={{ paper: 'stretch-dlg' }}\n    >\n      <DialogTitle id=\"dialog-title\">Tipus de programes</DialogTitle>\n      <DialogContent className=\"dialog-content\">\n        <div className=\"nivells\">\n          {Array.from(nivells).map(([nivell]) => (\n            <FormControlLabel\n              key={nivell}\n              className=\"select-nivell\"\n              control={\n                < Checkbox\n                  onChange={handleCheckNivell(nivell)}\n                  value={nivell}\n                  checked={nivellsChk[nivell]}\n                />}\n              label={nivell}\n            />\n          ))}\n        </div>\n        <FormControl className=\"select-list\">\n          <InputLabel htmlFor=\"select-ambit-curr\">mbit curricular</InputLabel>\n          <Select\n            value={ambitCurr}\n            onChange={listSelection(setAmbitCurr)}\n            inputProps={{\n              name: 'ambitCurr',\n              id: 'select-ambit-curr'\n            }}\n          >\n            <MenuItem value=\"\"><em>Tots els mbits</em></MenuItem>\n            {Array.from(ambitsCurr.keys()).sort().map(key => (\n              <MenuItem key={key} value={key}>{ambitsCurr.get(key)}</MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n\n        <FormControl className=\"select-list\">\n          <InputLabel htmlFor=\"select-ambit-inn\">mbit d'innovaci</InputLabel>\n          <Select\n            value={ambitInn}\n            onChange={listSelection(setAmbitInn)}\n            inputProps={{\n              name: 'ambitInn',\n              id: 'select-ambit-inn'\n            }}\n          >\n            <MenuItem value=\"\"><em>Tots els mbits</em></MenuItem>\n            {Array.from(ambitsInn.keys()).sort().map(key => (\n              <MenuItem key={key} value={key}>{ambitsInn.get(key)}</MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n        <Typography className=\"info\">\n          {currentPrograms.size} {currentPrograms.size === 1 ? 'programa seleccionat' : 'programes seleccionats'}\n        </Typography>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={closeDialog(true)} color=\"primary\" >Aplica la selecci</Button>\n        <Button onClick={closeDialog(false)} color=\"primary\">Cancella</Button>\n      </DialogActions>\n\n    </Dialog>\n  );\n\n}\n\nexport default SelectProgramsDlg;\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport MapSection from './MapSection';\nimport Paper from '@material-ui/core/Paper';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Switch from '@material-ui/core/Switch';\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport ArrowDownward from '@material-ui/icons/ArrowDownward';\nimport SelectProgramsDlg from './SelectProgramsDlg';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Utils from '../utils/Utils';\n\nfunction Programes({ history }) {\n\n  const [dlgOpen, setDlgOpen] = React.useState(false);\n\n  return (\n    <AppContext.Consumer>\n      {({ data, data: { programes, ambitsCurr, ambitsInn, nivells }, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        const allSelected = currentPrograms.size === programes.size;\n\n        // Click on program name\n        const handleProgClick = id => () => history.push(`/programa/${id}`);\n\n        // Select / Unselect program\n        const handleProgSelect = id => ev => {\n          currentPrograms[currentPrograms.has(id) ? 'delete' : 'add'](id);\n          updateMap({ currentPrograms, ambitCurr: '', ambitInn: '', nivell: '' }, true, true);\n        };\n\n        // Select / unselect all programs\n        const handleSelectAll = ev => {\n          if (ev.target.checked)\n            programes.forEach((_p, id) => currentPrograms.add(id));\n          else\n            currentPrograms.clear();\n          updateMap({ currentPrograms }, true, true);\n        };\n\n        const gomap = () => document.querySelector('.smapa').scrollIntoView();\n\n        return (\n          <>\n            <Button className=\"gomap\" aria-label=\"Mapa\" onClick={gomap} >\n              <ArrowDownward className=\"left-icon\" />\n              Mapa\n            </Button>\n            <section className=\"seccio programes\">\n              <SelectProgramsDlg {...{ dlgOpen, setDlgOpen, data: { programes, ambitsCurr, ambitsInn, nivells }, updateMap }} />\n              <Paper className=\"paper\">\n                <h3>Programes d'innovaci</h3>\n                <div className=\"select-progs\">\n                  <Button variant=\"outlined\" color=\"primary\" onClick={() => setDlgOpen(true)}>Selecciona per tipus</Button>\n                  <FormControlLabel\n                    className=\"select-all\"\n                    labelPlacement=\"start\"\n                    control={\n                      <Checkbox\n                        onChange={handleSelectAll}\n                        checked={allSelected}\n                      />}\n                    label=\"Selecciona'ls tots\"\n                  />\n                </div>\n                <List className=\"prog-list\">\n                  {Array.from(programes.values()).map(({ id, nom, simbol, centres }, n) => (\n                    <ListItem key={n} button className=\"list-button\">\n                      <ListItemAvatar>\n                        <Avatar src={`logos/${simbol}`} alt={nom} />\n                      </ListItemAvatar>\n                      <ListItemText\n                        primary={nom}\n                        secondary={'Centres: ' + Object.keys(centres).sort().map(k => `${Utils.cursCurt(k)}: ${centres[k].length}`).join(', ')}\n                        onClick={handleProgClick(id)} />\n                      <ListItemSecondaryAction>\n                        <Switch onChange={handleProgSelect(id)} checked={currentPrograms.has(id)} />\n                      </ListItemSecondaryAction>\n                    </ListItem>\n                  ))}\n                </List>\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: null, zona: null, cursos, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Programes;\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport ReportProblem from '@material-ui/icons/ReportProblem';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport Refresh from '@material-ui/icons/Refresh';\n\nfunction Error({ error, history, refetch }) {\n  return (\n    <div className=\"err-msg\">\n      <Typography >\n        <ReportProblem className=\"err-icon\" color=\"secondary\" />\n        {error || 'Error desconegut!'}\n      </Typography>\n      {\n        (refetch &&\n          <Button\n            className='action-btn'\n            aria-label=\"Reintenta\"\n            onClick={refetch}\n            variant='outlined' >\n            <Refresh className=\"left-icon\" />\n            Reintenta\n        </Button>) ||\n        (history && history.length > 1 &&\n          <Button\n            className=\"action-btn\"\n            aria-label=\"Torna\"\n            variant=\"outlined\"\n            onClick={() => history.goBack()} >\n            <ArrowBack className=\"left-icon\" />\n            Torna\n        </Button>)\n      }\n    </div>\n  );\n}\n\nexport default Error;","import React from 'react';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\nimport Error from './Error';\nimport MapSection from './MapSection';\n\nconst MD_OPTIONS = {\n  escapeHtml: false,\n};\n\nfunction createExpansionPanel(className, title, mdContent) {\n  return (\n    <ExpansionPanel classname={className}>\n      <ExpansionPanelSummary className=\"small-padding-h\" expandIcon={<ExpandMoreIcon />}>\n        <h4 style={{ marginTop: 0 }}>{title}</h4>\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails className=\"small-padding-h\">\n        <div>\n          <ReactMarkdown {...MD_OPTIONS}>\n            {mdContent}\n          </ReactMarkdown>\n        </div>\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  );\n}\n\nfunction FitxaPrograma({ history, match: { params: { id } } }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        const { programes, estudis, ambitsCurr, ambitsInn } = data;\n\n        // Find the specified program\n        const programa = programes.get(id);\n        if (!programa)\n          return <Error {...{ error: `No hi ha cap programa amb el codi: ${id}`, history }} />\n\n        // Els camps id, nomCurt i color no s'utilitzen\n        const { nom, descripcio, link, ambCurr, ambInn, fitxa, video, objectius, requisits, compromisos, contacte, normativa, arees, simbol, tipus, centres } = programa;\n\n        const torna = () => history.goBack();\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={torna} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio programa\">\n              <Paper className=\"paper\">\n                <h3>{nom}</h3>\n                <div id=\"descripcio\">\n                  {simbol && <img className=\"prog-logo\" src={`logos/${simbol}`} alt={nom}></img>}\n                  <ReactMarkdown {...MD_OPTIONS}>\n                    {descripcio}\n                  </ReactMarkdown>\n                  <br clear=\"all\" />\n                </div>\n                {objectius && createExpansionPanel('prog-objectius', 'Objectius', objectius)}\n                {requisits && createExpansionPanel('prog-requisits', 'Requisits', requisits)}\n                {compromisos && createExpansionPanel('prog-compromisos', 'Compromisos', compromisos)}\n                {normativa && createExpansionPanel('prog-normativa', 'Normativa', normativa)}\n                {contacte &&\n                  <div className=\"prog-contacte\">\n                    <h4>Contacte</h4>\n                    <div><a href={`mailto:${contacte}`}>{contacte}</a></div>\n                  </div>\n                }\n                {ambInn.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>mbits d'innovaci:</h4>\n                    <ul>\n                      {ambInn.map(a => <li key={a}>{ambitsInn.get(a)}</li>)}\n                    </ul>\n                  </div>\n                }\n                {ambCurr.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>mbits curriculars:</h4>\n                    <ul>\n                      {ambCurr.map(a => <li key={a}>{ambitsCurr.get(a)}</li>)}\n                    </ul>\n                  </div>\n                }\n                {arees.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>rees curriculars:</h4>\n                    <ul>\n                      {arees.map((a, n) => <li key={n}>{a}</li>)}\n                    </ul>\n                  </div>\n                }\n                {tipus.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>Nivells educatius:</h4>\n                    <ul>\n                      {tipus.map((t, n) => <li key={n}>{estudis.get(t)}</li>)}\n                    </ul>\n                  </div>\n                }\n                {link &&\n                  <p><a href={link} target=\"_blank\" rel=\"noopener noreferrer\">Ms informaci sobre el programa</a></p>\n                }\n                {fitxa &&\n                  <Button variant=\"contained\" className=\"prog-fitxa\" href={fitxa} >\n                    <CloudDownloadIcon className=\"left-icon\" />\n                    Fitxa\n                  </Button>\n                }\n                {video &&\n                  <div className=\"prog-video\">\n                    <br />\n                    <ReactMarkdown {...MD_OPTIONS}>\n                      {video}\n                    </ReactMarkdown>\n                  </div>\n                }\n                <h4>Centres:</h4>\n                <br />\n                {Object.keys(centres).map((curs, n) => (\n                  <ExpansionPanel key={n}>\n                    <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                      <Typography className=\"wider\">{`CURS ${curs}`}</Typography>\n                      <Typography>{`${centres[curs].length} ${centres[curs].length === 1 ? 'centre' : 'centres'}`}</Typography>\n                    </ExpansionPanelSummary>\n                    <ExpansionPanelDetails className=\"small-padding-h\">\n                      <List dense>\n                        {centres[curs].sort((a, b) => a.nom.localeCompare(b.nom)).map(({ id: codi, nom, municipi, titols }, c) => (\n                          <ListItem key={c} button component=\"a\" href={`#/centre/${codi}`} className=\"small-padding-h\">\n                            <ListItemText\n                              primary={`${nom} (${municipi})`}\n                              secondary={(titols && titols[id] ? titols[id] : null)}\n                            />\n                          </ListItem>\n                        ))}\n                      </List>\n                    </ExpansionPanelDetails>\n                  </ExpansionPanel>\n                ))}\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: id, centre: null, zona: null, cursos, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaPrograma;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Avatar from '@material-ui/core/Avatar';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport Utils from '../utils/Utils';\nimport Error from './Error';\nimport MapSection from './MapSection';\n\n// Possible values are `perCurs` and `agregat`\nconst MODE_PROG_CENTRE = process.env.REACT_APP_MODE_PROG_CENTRE || 'agregat';\n\nfunction FitxaCentre({ history, match: { params: { codi } } }) {\n  return (\n    <AppContext.Consumer>\n      {({ data, currentPrograms, polygons, mapChanged, updateMap }) => {\n        // Find the specified program\n        const centre = data.centres.get(codi);\n        if (!centre)\n          return <Error {...{ error: `No hi ha cap programa amb el codi: ${codi}`, history }} />\n\n        // Els camps tipus, sstt, se tamb estan disponibles\n        const { nom, municipi, comarca, estudis, adreca, web, logo, nodes, web_propi, tel, mail, twitter, sstt, se, public: pb, programes, titols } = centre;\n        const url = nodes || web || web_propi;\n        const tancaFitxa = () => history.goBack();\n        const obrePrograma = id => () => history.push(`/programa/${id}`);\n        const servei_territorial = data.poligons.get(sstt);\n        const servei_educatiu = data.poligons.get(se);\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={tancaFitxa} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio centre\">\n              <Paper className=\"paper\">\n                {logo && <><br clear=\"all\" /><img className=\"cent-logo\" src={logo} alt={nom}></img></>}\n                <h3>{nom}</h3>\n                <div id=\"tipus\">Centre {pb ? 'pblic' : 'privat concertat'}</div>\n                <br clear=\"all\" />\n                <div id=\"adreca\">\n                  <p>\n                    {adreca}<br />\n                    {`${municipi} (${comarca})`}<br />\n                    {tel && <>{`Tel. ${tel}`}<br /></>}\n                    {mail && <><a href={`mailto:${mail}`}>{mail}</a><br /></>}\n                    {twitter && <><a href={`https://twitter.com/${twitter}`} target=\"_blank\" rel=\"noopener noreferrer\">{twitter}</a><br /></>}\n                  </p>\n                </div>\n                {url && (\n                  <div id=\"link\">\n                    <h4>Portal web del centre:</h4>\n                    <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">{url}</a>\n                  </div>)}\n                <div id=\"estudis\">\n                  <h4>Estudis que s'hi imparteixen:</h4>\n                  <ul>\n                    {estudis.map((e, n) => <li key={n}>{data.estudis.get(e)}</li>)}\n                  </ul>\n                </div>\n                <div id=\"zones\">\n                  <h4>Zona:</h4>\n                  <ul>\n                    {servei_territorial && <li><Link to={`/zona/${sstt}`}>{servei_territorial.nom}</Link></li>}\n                    {servei_educatiu && <li><Link to={`/zona/${se}`}>{servei_educatiu.nom}</Link></li>}\n                  </ul>\n                </div>\n                <h4>Programes d'innovaci educativa on participa:</h4>\n                <br />\n                {(MODE_PROG_CENTRE === 'perCurs' &&\n                  Object.keys(programes)\n                    .map((curs, n) => (\n                      <ExpansionPanel key={n}>\n                        <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                          <Typography className=\"wider\">CURS {curs}</Typography>\n                          <Typography>{`${programes[curs].length} ${programes[curs].length === 1 ? 'programa' : 'programes'}`}</Typography>\n                        </ExpansionPanelSummary>\n                        <ExpansionPanelDetails>\n                          <ul>\n                            {programes[curs].map(({ id, nom }, c) => {\n                              return (\n                                <li key={c} >\n                                  <Button onClick={obrePrograma(id)}>{nom}{(titols && titols[id]) ? ` - ${titols[id]}` : ''}</Button>\n                                </li>\n                              );\n                            })}\n                          </ul>\n                        </ExpansionPanelDetails>\n                      </ExpansionPanel>\n                    )))\n                  ||\n                  <List >\n                    {Utils.plainArray(programes).map(({ id, nom, simbol, cursos }, n) => (\n                      <ListItem key={n} button className=\"no-padding-h-small\">\n                        <ListItemAvatar>\n                          <Avatar src={`logos/${simbol}`} alt={nom} />\n                        </ListItemAvatar>\n                        <ListItemText\n                          primary={nom}\n                          secondary={(titols && titols[id]) || `${cursos.sort().join(', ')}`}\n                          onClick={obrePrograma(id)} />\n                      </ListItem>\n                    ))}\n                  </List>\n                }\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: codi, zona: null, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaCentre;\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport IconButton from '@material-ui/core/IconButton';\nimport Error from './Error';\nimport MapSection from './MapSection';\nimport Utils from '../utils/Utils';\n\nfunction FitxaZona({ history, match: { params: { key } } }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        // Find the specified program\n        const zona = data.poligons.get(key);\n        if (!zona)\n          return <Error {...{ error: `No hi ha cap zona amb el codi: ${key}`, history }} />\n\n        // Els camps id, nomCurt i color no s'utilitzen\n        const { tipus, nom, logo, cp, adreca, municipi, comarca, tel, fax, correu, web, centresInn } = zona;\n\n        const torna = () => history.goBack();\n        const obreCentre = codi => () => history.push(`/centre/${codi}`);\n        const obrePrograma = id => () => history.push(`/programa/${id}`);\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={torna} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio zona\">\n              <Paper className=\"paper\">\n                {logo && <><br clear=\"all\" /><img className={tipus==='ST' ? 'cent-logo' : 'se-logo'} src={logo} alt={nom}></img></>}\n                <h3>{nom}</h3>\n                <br clear=\"all\" />\n                <div id=\"adreca\">\n                  <p>\n                    {adreca}<br />\n                    {`${cp} ${municipi} (${comarca})`}<br />\n                    {tel && <>{`Tel. ${tel}`}<br /></>}\n                    {fax && <>{`Fax. ${fax}`}<br /></>}\n                    {correu && <><a href={`mailto:${correu}`}>{correu}</a><br /></>}\n                  </p>\n                </div>\n                {web && (\n                  <div id=\"link\">\n                    <h4>Portal web:</h4>\n                    <a href={web} target=\"_blank\" rel=\"noopener noreferrer\">{web}</a>\n                  </div>)}\n                <h4>Centres d'aquest servei que participen en programes d'innovaci:</h4>\n                <List >\n                  {Array.from(centresInn).sort((a, b) => a.nom.localeCompare(b.nom)).map(({ id: codi, nom, municipi, programes, titols }, n) => {\n                    return (\n                      <ListItem key={n} button className=\"small-padding-h\">\n                        <ListItemText\n                          primary={`${nom} (${municipi})`}\n                          onClick={obreCentre(codi)}\n                        />\n                        <div className=\"prog-icons\">\n                          {Utils.plainArray(programes).map(({ id, nom, simbol }, k) => {\n                            const label = `${nom}${titols && titols[id] ? `: ${titols[id]}` : ''}`;\n                            return (\n                              <IconButton\n                                key={k}\n                                className=\"prog-icon\"\n                                aria-label={label}\n                                onClick={obrePrograma(id)}\n                              >\n                                <img src={`logos/${simbol}`} alt={label} title={label} />\n                              </IconButton>\n                            );\n                          })}\n                        </div>\n                      </ListItem>\n                    )\n                  })}\n                </List>\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: null, zona: key, cursos, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaZona;\n","import React from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Typography from '@material-ui/core/Typography';\n\n/**\n * Basic 'loading data...' page\n */\nfunction Loading() {\n  return (\n    <div className='err-msg'>\n      <Typography>S'estan carregant les dades...</Typography>\n      <CircularProgress className='progress' />\n    </div>\n  );\n}\n\nexport default Loading;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { title, version, repository, license } from '../../package.json';\n\nfunction Footer() {\n  return (\n    <footer>\n      <div className=\"footer-content\">\n        <a className=\"logo-gencat\" href=\"https://web.gencat.cat/\" title=\"Generalitat de Catalunya\" target=\"_top\">gencat.cat</a>\n        <Typography variant=\"body2\" className=\"copyright\">\n          <a href=\"https://innovacio.xtec.cat/\">{title} v{version}</a><br />\n          <a href=\"http://www.xtec.cat\"> 2019 Departament d'Educaci de la Generalitat de Catalunya</a><br />\n          <a href={`https://spdx.org/licenses/${license}.html`}>Llicncia Pblica de la Uni Europea {license}</a><br />\n          <a href={repository.url}>{repository.url}</a><br />\n          <br />\n          <a href=\"https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/\"><strong>Avs legal</strong></a>: Dacord amb larticle 17.1 de la Llei 19/2014, la Generalitat de Catalunya permet la reutilitzaci dels continguts i de les dades sempre que se'n citi la font i la data d'actualitzaci i que no es desnaturalitzi la informaci (article 8 de la Llei 37/2007) i tamb que no es contradigui amb una llicncia especfica.\n        </Typography>\n      </div>\n    </footer>\n  );\n}\n\nexport default Footer;","import React from 'react';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport TablePagination from \"@material-ui/core/TablePagination\";\nimport ProgramIcon from '@material-ui/icons/Group';\nimport SchoolIcon from '@material-ui/icons/School';\n\nconst DEFAULT_ITEMS_PER_PAGE = Number(process.env.REACT_APP_ITEMS_PER_PAGE || 25);\n\nfunction Cerca({ history, match: { params: { query } } }) {\n\n  const [page, setPage] = React.useState(0);\n  const [itemsPerPage, setItemsPerPage] = React.useState(DEFAULT_ITEMS_PER_PAGE);\n  const [queryResults, setQueryResults] = React.useState([]);\n  const [currentQuery, setCurrentQuery] = React.useState('');\n\n  return (\n    <AppContext.Consumer>\n      {({ fuseFuncs }) => {\n\n        if (query !== currentQuery) {\n          // Perform full text search using Fuse.js\n          // See `loadData` in App.js for details about how these functions are built\n          setCurrentQuery(query);\n          setQueryResults(fuseFuncs.reduce((qr, ff) => qr.concat(ff.search(query)), []));\n        }\n\n        const goToElement = (tipus, id) => ev => {\n          history.push(`/${tipus}/${id}`);\n        };\n\n        return (\n          <>\n            <Button\n              className=\"torna\"\n              aria-label=\"Torna\"\n              onClick={() => history.goBack()} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio cerca\">\n              <Paper className=\"paper\">\n                <h2>Resultats de la cerca \"{currentQuery}\"</h2>\n                {(queryResults.length === 0 && <p>No s'ha trobat cap element concident amb el criteri de cerca!</p>) ||\n                  <div>\n                    <List component=\"ul\">\n                      {queryResults.slice(page * itemsPerPage, (page + 1) * itemsPerPage).map(({ item: { nom, id, tipus } }, n) => (\n                        <ListItem\n                          key={n}\n                          button\n                          onClick={goToElement(tipus, id)}\n                        >\n                          <ListItemIcon>\n                            {tipus === 'programa' ? <ProgramIcon /> : <SchoolIcon />}\n                          </ListItemIcon>\n                          <ListItemText primary={nom} />\n                        </ListItem>\n                      ))}\n                    </List>\n                    <hr />\n                    <TablePagination\n                      classes={{ spacer: 'hidden', toolbar: 'no-padding' }}\n                      component=\"nav\"\n                      page={page}\n                      rowsPerPage={itemsPerPage}\n                      onChangeRowsPerPage={ev => setItemsPerPage(ev.target.value)}\n                      count={queryResults.length}\n                      onChangePage={(ev, p) => setPage(p)}\n                      labelDisplayedRows={({ from, to, count }) => `Resultats ${from} al ${to} de ${count}`}\n                      labelRowsPerPage=\"Resultats per pgina:\"\n                    />\n                  </div>\n                }\n              </Paper>\n            </section>\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Cerca;","import React, { Component } from 'react';\nimport { HashRouter as Router, Route } from 'react-router-dom';\nimport CheckRouteChanges from './utils/CheckRouteChanges';\n\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport MuiThemeProvider from '@material-ui/core/styles/MuiThemeProvider';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport color_error from '@material-ui/core/colors/red';\nimport Fuse from 'fuse.js';\n\nimport Utils from './utils/Utils';\nimport Header from './components/Header';\nimport Presentacio from './components/Presentacio';\nimport Programes from './components/Programes';\nimport FitxaPrograma from './components/FitxaPrograma';\nimport FitxaCentre from './components/FitxaCentre';\nimport FitxaZona from './components/FitxaZona';\nimport Error from './components/Error';\nimport Loading from './components/Loading';\nimport Footer from './components/Footer';\nimport Cerca from './components/Cerca';\nimport AppContext, { DEFAULT_STATE } from './AppContext';\n\n// Gencat dark gray\nconst color_primary = { 500: '#333' };\n\n// Gencat red\nconst color_secondary = { 500: '#c00000' };\n\n/**\n * Miscellanous values taken from environment variables\n * and from files: `.env`, `.env.development` and `.env.production`\n */\n//const API_ROOT = process.env.REACT_APP_API_ROOT || '../api';\nconst MAX_DENSITY = process.env.REACT_APP_MAX_DENSITY || 0.8;\nconst MIN_DENSITY = process.env.REACT_APP_MIN_DENSITY || 0.000001;\nconst MINMAX_DENSITY = process.env.REACT_APP_MINMAX_DENSITY || 0.4;\nconst DEBUG_GLOBAL_VAR = process.env.REACT_APP_DEBUG_GLOBAL_VAR || '';\n\n/**\n * Main Material-UI theme\n */\nconst theme = createMuiTheme({\n  palette: {\n    primary: { main: color_primary[500] },\n    secondary: { main: color_secondary[500] },\n    error: { main: color_error[500] },\n  },\n  typography: {\n    fontFamily: [\n      'Open Sans',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n    ].join(','),\n    useNextVariants: true,\n  },\n  overrides: {\n    \"MuiStepIcon\": {\n      completed: {\n        color: '#c00000 !important',\n      }\n    }\n  },\n});\n\n/**\n * Main React component\n */\nclass App extends Component {\n\n  static contextType = AppContext;\n\n  constructor() {\n    super();\n\n    // Current app sections\n    this.menuItems = [\n      {\n        id: 'presenta',\n        name: 'Presentaci',\n        path: '/',\n      },\n      {\n        id: 'programes',\n        name: 'Programes',\n        path: '/programes',\n      },\n    ];\n\n    // Set the initial state\n    this.state = {\n      ...DEFAULT_STATE,\n      // Immutable attributes:\n      updateMap: this.updateMap,\n      // Functions used to perform full-text search with Fuse.js on 'centres' and 'programes', built after loading\n      fuseFuncs: [],\n      menuItems: this.menuItems,\n    };\n  }\n\n  setStateMod(values, callback = null) {\n    this.setState(values, () => {\n      if (DEBUG_GLOBAL_VAR)\n        window[DEBUG_GLOBAL_VAR] = this.state;\n      if (callback)\n        callback();\n    });\n  }\n\n\n  /**\n   * Load datasets from API or JSON files\n   */\n  loadData() {\n    this.setStateMod({ loading: true });\n    return Promise.all(\n      [\n        'data/programes.json', // `${API_ROOT}/programes/`\n        'data/instancies.json', // `${API_ROOT}/instancies/`\n        'data/centres.json',\n        'data/poligons.json',\n        'data/estudis.json',\n      ].map(uri => {\n        return fetch(uri, { method: 'GET', credentials: 'same-origin' })\n          .then(Utils.handleFetchErrors)\n          .then(response => response.json());\n      })\n    )\n      .then(([_programes, _instancies, _centres, _poligons, _estudis]) => {\n\n        // Sort data (step to be supressed with well ordered JSON sources!)\n        _centres = Utils.sortObjectArrayBy(_centres, ['sstt', 'municipi', 'nom']);\n        _programes = Utils.sortObjectArrayBy(_programes, 'nom');\n        _poligons = Utils.sortObjectArrayBy(_poligons, ['tipus', 'id', 'key']);\n\n        // Build an object with centre ids as keys, useful for optimizing searches\n        _centres.forEach(c => {\n          c.programes = [];\n        });\n\n        // Convert synthetic multi-point expressions into arrays of co-ordinates suitable for leaflet polygons\n        _poligons.forEach(p => {\n          p.poligons = p.poligons.map(pts => pts.split(',').map(pt => pt.split('|').map(vs => Number(vs))));\n          p.centresInn = new Set();\n          p.density = MIN_DENSITY;\n          p.estudisBase = {};\n          p.estudisPart = {};\n          p.centresPart = new Set();\n        });\n\n        // Prepare sets for auto-detected data\n        const currentPrograms = new Set();\n\n        // Guess missing fields in `programes`\n        // (to be supressed!)\n        _programes.forEach(p => {\n\n          // Set all programs initially selected\n          currentPrograms.add(p.id);\n\n          // Initialize `centres` (to be filled later)\n          p.centres = {};\n\n          // Empty `tipus`? then try to guess them from title and description\n          if (p.tipus.length === 0) {\n            const str = `${p.nom} ${p.nomCurt} ${p.descripcio}`;\n            if (/(FP|fp|[pP]rofessio)/.test(str))\n              p.tipus = ['CFPM', 'CFPS'];\n            else if (/(infantil|primria|escola)/.test(str))\n              p.tipus = ['EINF2C', 'EPRI'];\n            else\n              p.tipus = ['EINF2C', 'EPRI', 'ESO'];\n          }\n        });\n\n        // Convert arrays to maps\n        const centres = new Map(_centres.map(c => [c.id, c]));\n        const programes = new Map(_programes.map(p => [p.id, p]));\n        const poligons = new Map(_poligons.map(p => [p.key, p]));\n\n        // Initialize arrays of `centres` for each program, and `programa` for each centre, by curs\n        _instancies.forEach(ins => {\n          const programa = programes.get(ins.programa);\n          const centre = centres.get(ins.centre);\n          if (programa && centre) {\n            (programa.centres[ins.curs] = programa.centres[ins.curs] || []).push(centre);\n            (centre.programes[ins.curs] = centre.programes[ins.curs] || []).push(programa);\n            if (centre.sstt)\n              poligons.get(centre.sstt).centresInn.add(centre);\n            if (centre.se)\n              poligons.get(centre.se).centresInn.add(centre);\n            if (ins.titol) {\n              if (!programa.titols)\n                programa.titols = {};\n              programa.titols[centre.id] = `${programa.titols[centre.id] ? `${programa.titols[centre.id]}, ` : ''}\"${ins.titol}\" (${ins.curs})`;\n              if (!centre.titols)\n                centre.titols = {};\n              centre.titols[programa.id] = `${centre.titols[programa.id] ? `${centre.titols[programa.id]}, ` : ''}\"${ins.titol}\" (${ins.curs})`;\n            }\n          }\n          else\n            console.log(`WARNING: Instncia amb programa o centre desconegut: ${ins.programa} - ${ins.centre} - ${ins.curs}`);\n        });\n\n        // Build the Fuse.js objects\n        // See: https://fusejs.io/\n        const fuseOptions = {\n          caseSensitive: false,\n          shouldSort: true,\n          tokenize: true,\n          matchAllTokens: true,\n          includeScore: true,\n          includeMatches: true,\n          threshold: 0.3,\n          location: 0,\n          distance: 4,\n          maxPatternLength: 32,\n          minMatchCharLength: 2,\n        };\n\n        const fuseFuncs = [\n          new Fuse(\n            _programes.map(({ id, nom, descripcio, titols, ambCurr, ambInn, arees, objectius, requisits, compromisos, contacte, normativa }) => ({\n              id,\n              nom,\n              descripcio,\n              titols: titols ? Object.values(titols).join(', ') : '',\n              ambCurr: ambCurr.map(a => _estudis.ambitsCurr[a]).join(', '),\n              ambInn: ambCurr.map(a => _estudis.ambitsInn[a]).join(', '),\n              arees: arees.join(', '),\n              objectius,\n              requisits,\n              compromisos,\n              contacte,\n              normativa,\n              tipus: 'programa',\n            })),\n            { ...fuseOptions, keys: ['id', 'nom', 'descripcio', 'titols', 'ambCurr', 'ambInn', 'arees', 'objectius', 'requisits', 'compromisos', 'contacte', 'normativa'] }),\n          new Fuse(\n            _centres.map(({ id, nom, municipi, comarca, titols }) => ({\n              id,\n              nom: `${nom} (${municipi})`,\n              comarca,\n              titols: titols ? Object.values(titols).join(', ') : '',\n              tipus: 'centre',\n            })),\n            { ...fuseOptions, keys: ['id', 'nom', 'comarca', 'titols'] }),\n        ];\n\n        // Update main data object\n        const data = {\n          ...this.state.data,\n          programes,\n          centres,\n          poligons,\n          estudis: new Map(Object.entries(_estudis.estudis)),\n          nivells: new Map(Object.entries(_estudis.nivells)),\n          ambitsCurr: new Map(Object.entries(_estudis.ambitsCurr)),\n          ambitsInn: new Map(Object.entries(_estudis.ambitsInn)),\n          cursosDisp: _estudis.cursos,\n        };\n\n        //this.updateLayersDensity(currentPrograms, null, data);\n\n        // Update the main state\n        this.setStateMod({\n          data,\n          dataLoaded: true,\n          polygons: [\n            { name: 'Serveis Territorials', shapes: _poligons.filter(p => p.tipus === 'ST') },\n            { name: 'Serveis Educatius de Zona', shapes: _poligons.filter(p => p.tipus === 'SEZ') },\n          ],\n          cursos: [...data.cursosDisp],\n          fuseFuncs,\n          currentPrograms,\n          loading: false,\n          error: false,\n        });\n      })\n      .catch(error => {\n        // Something wrong happened!\n        console.log(error);\n        this.setStateMod({ error: error.toString() });\n      });\n  }\n\n  /**\n   * Miscellaneous operations to be performed at startup\n   */\n  componentDidMount() {\n    // Load Google's \"Roboto\" font\n    //Utils.loadGFont('Roboto');\n    Utils.loadGFont('Open Sans');\n    // Load datasets\n    this.loadData()\n      .then(() => {\n        this.checkForLayerUpdate(window.location.hash ? window.location.hash.substr(1) : '/');\n      });\n  }\n\n  /**\n   * Update the state of the main component, scrolling to new sections when needed\n   * @param {object} state - The new settings for `state`\n   * @param {boolean} mapChanged - `true` when this change involves map points\n   */\n  updateMap = (state = {}, mapChanged = true, currentProgramsChanged = false) => {\n    this.setStateMod({ ...state, mapChanged, currentProgramsChanged });\n    window.requestAnimationFrame(() => {\n      if (currentProgramsChanged)\n        this.updateLayersDensity(this.state.programa ? new Set([this.state.programa]) : this.state.currentPrograms, this.state.cursos);\n      if (mapChanged)\n        window.setTimeout(() => this.setStateMod({ mapChanged: false }), 0);\n    });\n  }\n\n  /**\n   * Called from CheckRouteChanges when a new path is entered\n   * @param {object} props - New properties used, including a react-route location object\n   * @param {object} prevProps - Old properties, used for checking changes\n   */\n  contentUpdated = (props, prevProps) => {\n    if (props.location.pathname !== prevProps.location.pathname) {\n      this.checkForLayerUpdate(props.location.pathname);\n      window.scrollTo(0, 0);\n    }\n  };\n\n  /**\n   * Checks if the polygons density needs to be recalculated, based on the current path\n   * @param {string} pathname - Current path\n   */\n  checkForLayerUpdate = (pathname) => {\n    if (/^\\/(programes|programa\\/|centre\\/|zona\\/)/.test(pathname)) {\n      const check = /^\\/programa\\/(.*)$/.exec(pathname);\n      const programa = check && check.length === 2 ? check[1] : null;\n      this.updateMap({ programa }, true, true);\n    }\n  };\n\n  /**\n   * Update the `density` value on each polygon, based on the number of schools enroled to\n   * the current programs among the total number of schools on the polygon having at least\n   * one of the educational levels targeted by at least one of the current programs.\n   * Values can also be filtered by school year.\n   * @param {Set} currentPrograms - Set with the `id`s of the programs to be included on the calculation\n   * @param {string[]=} cursos - School years to be considered. Defaults to _null_, meaning all available years.\n   * @param {object=} data - Object containing the current datasets. Defaults to `data` in the current state.\n   */\n  updateLayersDensity = (currentPrograms, cursos = null, data = this.state.data) => {\n\n    const { poligons, programes } = data;\n\n    // Clear base arrays\n    poligons.forEach(poli => {\n      // Clear current density\n      poli.density = MIN_DENSITY;\n\n      // `estudisBase` will be filled with the number of \"school groups\" involved in at least\n      // one of the current programs, where each \"school group\" is an educational level inside a school.\n      // key: educational level (EINF2C, EPRI...)      \n      // value: number of \"school groups\" of this educational level on this polygon\n      poli.estudisBase = {};\n\n      // `estudisPart` will be filled with the total number of \"school groups\" participating in at least\n      // one of the current programs, where each \"school group\" is an educational level inside a school.\n      // key: educational level (EINF2C, EPRI...)      \n      // value: number of \"school groups\" of this type participating in the current programs on this polygon\n      poli.estudisPart = {};\n\n      poli.centresPart = new Set();\n    });\n\n    // Object with all `centres` participating in current programs\n    // key: school id\n    // value: school\n    const currentCentres = {};\n\n    // For program, fill `estudisBase` and `currentCentres`\n    currentPrograms.forEach(pid => {\n      const program = programes.get(pid);\n      if (program && program.tipus.length && Object.keys(program.centres).length) {\n        program.tipus.forEach(t => {\n          poligons.forEach(poli => {\n            poli.estudisBase[t] = poli.centres[t] || 0;\n          });\n        });\n\n        Object.keys(program.centres).forEach(ce => {\n          if (!cursos || cursos.includes(ce)) {\n            program.centres[ce].forEach(centre => {\n              currentCentres[centre.id] = centre;\n            });\n          }\n        });\n      }\n    });\n\n    // For each school, fill `estudisPart` on their associated polygons (ST and SZ)\n    Object.values(currentCentres).forEach(centre => {\n      const st = poligons.get(centre.sstt);\n      const se = poligons.get(centre.se);\n      centre.estudis.forEach(tipus => {\n        if (st && st.estudisBase[tipus]) {\n          st.estudisPart[tipus] = (st.estudisPart[tipus] ? st.estudisPart[tipus] + 1 : 1);\n          st.centresPart.add(centre.id);\n        }\n        if (se && se.estudisBase[tipus]) {\n          se.estudisPart[tipus] = (se.estudisPart[tipus] ? se.estudisPart[tipus] + 1 : 1);\n          se.centresPart.add(centre.id);\n        }\n      });\n    });\n\n    // Finally, calculate the density of each polygon\n    // (ratio between the summations of `estudisPart` and `estudisBase`)\n    let maxDensityST = 0, maxDensitySE = 0;\n    poligons.forEach(poli => {\n      let n = 0, d = 0;\n      Object.keys(poli.estudisPart).forEach(tipus => {\n        if (poli.estudisBase[tipus]) {\n          n += poli.estudisPart[tipus];\n          d += poli.estudisBase[tipus];\n        }\n      });\n      if (d > 0) {\n        poli.density = n / d;\n        if (poli.tipus === 'ST')\n          maxDensityST = Math.max(maxDensityST, poli.density);\n        else\n          maxDensitySE = Math.max(maxDensitySE, poli.density);\n      }\n    });\n\n    // Compute correction factors\n    const factorST = (maxDensityST > MIN_DENSITY && maxDensityST < MINMAX_DENSITY)\n      ? MINMAX_DENSITY / maxDensityST\n      : maxDensityST > MAX_DENSITY\n        ? MAX_DENSITY / maxDensityST\n        : 1;\n    const factorSE = (maxDensitySE > MIN_DENSITY && maxDensitySE < MINMAX_DENSITY)\n      ? MINMAX_DENSITY / maxDensitySE\n      : maxDensitySE > MAX_DENSITY\n        ? MAX_DENSITY / maxDensitySE\n        : 1;\n\n    // Apply correction factors\n    poligons.forEach(poli => poli.density *= (poli.tipus === 'ST' ? factorST : factorSE));\n  }\n\n  /**\n   * Builds the App main component\n   */\n  render() {\n\n    const { error, loading } = this.state;\n\n    return (\n      <Router basename={window.location.pathname}>\n        <CssBaseline>\n          <MuiThemeProvider theme={theme}>\n            <AppContext.Provider value={this.state}>\n              <CheckRouteChanges updateHandler={this.contentUpdated}>\n                <Header />\n                <div id=\"filler\" />\n                <main>\n                  {\n                    (loading && <Loading />) ||\n                    (error && <Error {...{ error, refetch: this.loadData }} />) ||\n                    (<>\n                      <Route exact path=\"/\" component={Presentacio} />\n                      <Route path=\"/programes\" component={Programes} />\n                      <Route path=\"/centre/:codi\" component={FitxaCentre} />\n                      <Route path=\"/programa/:id\" component={FitxaPrograma} />\n                      <Route path=\"/zona/:key\" component={FitxaZona} />\n                      <Route path=\"/cerca/:query\" component={Cerca} />\n                    </>\n                    )\n                  }\n                </main>\n                <Footer />\n              </CheckRouteChanges>\n            </AppContext.Provider>\n          </MuiThemeProvider>\n        </CssBaseline>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './main.css';\nimport '../node_modules/leaflet.markercluster/dist/MarkerCluster.css';\nimport '../node_modules/leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport '../node_modules/react-leaflet-fullscreen/dist/styles.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nserviceWorker.register();\n"],"sourceRoot":""}