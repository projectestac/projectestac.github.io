{"version":3,"sources":["utils/CheckRouteChanges.js","utils/Utils.js","AppContext.js","components/SearchBar.js","components/Header.js","literals.js","components/Presentacio.js","utils/TileLayer.js","utils/MarkerClusterGroup.js","components/MainMap.js","components/MapaCentre.js","components/MapSection.js","components/SelectProgramsDlg.js","components/Programes.js","components/Error.js","components/FitxaPrograma.js","components/FitxaCentre.js","components/FitxaZona.js","components/Loading.js","components/Footer.js","components/Cerca.js","App.js","serviceWorker.js","index.js"],"names":["CheckRouteChanges","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","updateHandler","prevProps","children","React","Component","withRouter","Utils","loadGFont","fontName","arguments","length","undefined","weights","link","document","createElement","href","concat","rel","head","appendChild","FontFaceObserver","load","then","documentElement","classList","add","replace","toLowerCase","catch","err","console","error","handleFetchErrors","response","ok","Error","statusText","sumAll","obj","values","reduce","acc","v","plainArray","container","keys","forEach","curs","prog","id","nom","simbol","cursos","push","sort","c1","c2","localeCompare","sortObjectArrayBy","array","fields","a","b","map","f","join","cursCurt","substr","DEFAULT_DATA","programes","Map","centres","poligons","estudis","nivells","ambitsCurr","ambitsInn","cursosDisp","DEFAULT_STATE","loading","dataLoaded","polygons","currentPrograms","Set","program","delayedMapUpdate","updateMap","fuseFuncs","menuItems","data","AppContext","createContext","SearchBar","_ref","_ref$closeFn","closeFn","history","_ref$mini","mini","_React$useState","useState","_React$useState2","slicedToArray","searchText","setSearchText","search","ev","preventDefault","react_default","className","onSubmit","IconButton_default","color","aria-label","title","onClick","Search_default","TextField_default","value","InputProps","disableUnderline","onChange","target","Close_default","location","drawerOpened","setDrawerOpened","_React$useState3","_React$useState4","searchOpened","setSearchOpened","src_AppContext","Consumer","_ref2","hasDrawer","searchFn","itemAction","item","path","mi","current","pathname","Fragment","AppBar_default","position","Toolbar_default","disableGutters","Menu_default","components_SearchBar","Typography_default","variant","noWrap","key","role","name","Drawer_default","anchor","open","List_default","ListItem_default","component","divider","button","ListItemIcon_default","ChevronLeft_default","ListItemText_default","primary","intro","MD_OPTIONS","escapeHtml","Presentacio","Paper_default","with_html_default","Button_default","LAYERS","osm","attribution","url","mapbox","accessToken","process","wikimedia","minZoom","maxZoom","BUILT_LAYERS","getTileLayer","_ref$type","type","TileLayer","require","MarkerClusterGroup","_props$clusterProps","clusterProps","el","L","markerClusterGroup","objectSpread","contextValue","leaflet","layerContainer","MapLayer","withLeaflet","TILE_LAYER","PRESERVE_MAP_BOUNDS","MAP_BOUNDS","MAX_BOUNDS","MARKERCLUSTER_PROPS","showCoverageOnHover","maxClusterRadius","MainMap","_ref$points","points","_ref$polygons","_ref$programa","programa","_ref$poli","poli","_ref$zoom","center","zoom","_ref$maxZoom","OVERLAYS","flag","default","OVERLAY_SETTINGS_STORAGE","window","localStorage","getBool","getItem","setVal","val","setItem","MAP_BOUNDS_STORAGE","sessionStorage","preserveBounds","currentlySavedBounds","str","split","Number","getSavedBounds","boundsChanged","bounds","getBounds","toBBoxString","overlayChange","ov","findIndex","overlayVisible","currentLayer","stored","popupZona","zona","centresPart","size","estudisPart","estudisBase","perCent","toFixed","Popup","style","cursor","es_Map","assign","maxBounds","onBaseLayerChange","layerIndex","p","onOverlayAdd","onOverlayRemove","onZoomEnd","onMoveEnd","utils_TileLayer","LayersControl","i","BaseLayer","checked","tipus","LayerGroup","shapes","filter","sh","n","Polygon","positions","weight","fillOpacity","Overlay","density","utils_MarkerClusterGroup","pt","Marker","lat","lng","centre","adreca","web","popupCentre","dist_default","titleCancel","MapaCentre","point","_ref$center","MapSection","_ref$data","mapChanged","singleCentre","get","w","innerWidth","addSchoolsOfProgram","progId","dest","includes","centresInn","has","find","c","Stepper_default","nonLinear","alternativeLabel","activeStep","k","Step_default","StepButton_default","result","completed","SelectProgramsDlg","dlgOpen","setDlgOpen","ambitInn","setAmbitInn","ambitCurr","setAmbitCurr","_React$useState5","Array","from","_React$useState6","nivellsChk","setNivellsChk","_React$useState7","_React$useState8","setCurrentPrograms","updateCurrentPrograms","progs","ambInn","ambCurr","nivell","tag","useMemo","listSelection","handle","closeDialog","Dialog_default","onEnter","aria-labelledby","classes","paper","DialogTitle_default","DialogContent_default","_ref4","FormControlLabel_default","control","Checkbox_default","defineProperty","label","FormControl_default","InputLabel_default","htmlFor","Select_default","inputProps","MenuItem_default","DialogActions_default","Programes","_ref2$data","allSelected","handleProgClick","handleProgSelect","querySelector","scrollIntoView","ArrowDownward_default","components_SelectProgramsDlg","labelPlacement","_p","clear","_ref3","ListItemAvatar_default","Avatar_default","src","alt","secondary","ListItemSecondaryAction_default","Switch_default","components_MapSection","refetch","ReportProblem_default","Refresh_default","goBack","ArrowBack_default","FitxaPrograma","match","params","components_Error","descripcio","fitxa","video","objectius","requisits","compromisos","contacte","normativa","arees","t","CloudDownload_default","ExpansionPanel_default","ExpansionPanelSummary_default","expandIcon","ExpandMore_default","ExpansionPanelDetails_default","dense","codi","municipi","titols","MODE_PROG_CENTRE","FitxaCentre","comarca","logo","nodes","web_propi","tel","mail","twitter","sstt","se","pb","public","obrePrograma","servei_territorial","servei_educatiu","e","react_router_dom","to","FitxaZona","obreCentre","Loading","CircularProgress_default","Footer","version","license","repository","DEFAULT_ITEMS_PER_PAGE","Cerca","query","page","setPage","itemsPerPage","setItemsPerPage","queryResults","setQueryResults","currentQuery","setCurrentQuery","qr","ff","goToElement","slice","_ref3$item","Group_default","School_default","TablePagination_default","spacer","toolbar","rowsPerPage","onChangeRowsPerPage","count","onChangePage","labelDisplayedRows","labelRowsPerPage","MAX_DENSITY","MIN_DENSITY","MINMAX_DENSITY","DEBUG_GLOBAL_VAR","REACT_APP_DEBUG_GLOBAL_VAR","theme","createMuiTheme","palette","main","color_error","typography","fontFamily","useNextVariants","overrides","MuiStepIcon","App","state","currentProgramsChanged","setStateMod","requestAnimationFrame","updateLayersDensity","setTimeout","contentUpdated","checkForLayerUpdate","scrollTo","test","check","exec","currentCentres","pid","ce","st","maxDensityST","maxDensitySE","d","Math","max","factorST","factorSE","_this2","callback","setState","_this3","Promise","all","uri","fetch","method","credentials","json","_programes","_instancies","_centres","_poligons","_estudis","pts","vs","nomCurt","ins","titol","log","fuseOptions","caseSensitive","shouldSort","tokenize","matchAllTokens","includeScore","includeMatches","threshold","distance","maxPatternLength","minMatchCharLength","Fuse","entries","toConsumableArray","toString","_this4","loadData","hash","_this$state","basename","CssBaseline_default","MuiThemeProvider_default","Provider","utils_CheckRouteChanges","components_Header","components_Loading","react_router","exact","components_Footer","contextType","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","navigator","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","src_App","getElementById","URL","origin","addEventListener","contentType","headers","status","indexOf","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.e42e25ac.chunk.js","sourcesContent":["import React from 'react';\nimport { withRouter } from 'react-router-dom';\n\n// Scroll to top on each router navigation\n// See: https://reacttraining.com/react-router/web/guides/scroll-restoration\nclass CheckRouteChanges extends React.Component {\n  constructor(props) {\n    super(props);\n    this.updateHandler = props.updateHandler;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.updateHandler)\n      this.updateHandler(this.props, prevProps);\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\nexport default withRouter(CheckRouteChanges);\n","// From: https://github.com/zeit/next.js/issues/512#issuecomment-322026199\n\nimport FontFaceObserver from 'fontfaceobserver';\n\n/**\n * Asynchronous loading of Google fonts\n */\nfunction loadGFont(fontName = 'Roboto', weights = '300,400,500,600') {\n  const link = document.createElement('link');\n  link.href = `https://fonts.googleapis.com/css?family=${fontName}:${weights}`;\n  link.rel = 'stylesheet';\n\n  document.head.appendChild(link);\n  const fontLoader = new FontFaceObserver(fontName);\n  fontLoader.load()\n    .then(() => document.documentElement.classList.add(fontName.replace(' ', '-').toLowerCase()))\n    .catch(err => console.error(`Unable to load ${fontName} font due to: ${err}`));\n}\n\n/**\n * Handle errors on fetch calls\n * @param {Object} response \n */\nfunction handleFetchErrors(response) {\n  if (!response.ok)\n    throw Error(response.statusText || 'Error desconegut');\n  return response;\n}\n\n/**\n * Return the addition of all values in an object of type `{key: value, key: value, ...}` where all values are numbers.\n * @param {object} obj \n */\nfunction sumAll(obj) {\n  return Object.values(obj).reduce((acc, v) => acc + v, 0);\n}\n\n/**\n * Used in objects of type {curs1: [prog1, prog2, prog3, ...], curs2: [prog1, ...], ...}\n * Returns a single array of type: [{id: prog1.id, nom: prog1.nom, cursos: [curs1, curs2, ...]}, {id: prog2.id, nom: prog2.nom, cursos: [curs1, ...]}, ...]\n * @param {object} obj - Object structured as in the description\n * @returns {object[]} - The resulting array of objects of type 'program', with a 'cursos' field.\n */\nfunction plainArray(obj) {\n  const container = {};\n  Object.keys(obj).forEach(curs => {\n    obj[curs].forEach(prog => {\n      if (!container[prog.id]) {\n        container[prog.id] = {\n          id: prog.id,\n          nom: prog.nom,\n          simbol: prog.simbol,\n          cursos: [],\n        };\n      }\n      container[prog.id].cursos.push(curs);\n    });\n  });\n  return Object.values(container).sort((c1, c2) => c1.nom.localeCompare(c2.nom));\n}\n\n/**\n * Converts an expression of type '2015-2016' to '2015-16'\n */\nfunction cursCurt(curs) {\n  return curs.length === 9 ? `${curs.substr(0, 5)}${curs.substr(7, 2)}` : curs;\n}\n\n\n/**\n * Sort an array of objects having the same string property\n * @param {Array} array - The array to be sorted\n * @param {string|string[]]} fields - The name or names of the attributes to be compared between array elements\n * @returns {Array} - The sorted array\n */\nfunction sortObjectArrayBy(array, fields) {\n  return typeof fields === 'string'\n    ? array.sort((a, b) => a[fields].localeCompare(b[fields]))\n    : array.sort((a, b) => fields.map(f => a[f]).join(' ').localeCompare(fields.map(f => b[f]).join(' ')));\n}\n\nexport default { loadGFont, handleFetchErrors, sumAll, plainArray, sortObjectArrayBy, cursCurt };\n","import React from 'react';\n\nexport const DEFAULT_DATA = {\n  programes: new Map(),\n  centres: new Map(),\n  poligons: new Map(),\n  estudis: new Map(),\n  nivells: new Map(),\n  ambitsCurr: new Map(),\n  ambitsInn: new Map(),\n  cursosDisp: [],\n};\n\nexport const DEFAULT_STATE = {\n  loading: true,\n  dataLoaded: false,\n  error: false,\n  polygons: [],\n  currentPrograms: new Set(),\n  program: null,\n  cursos: [],\n  delayedMapUpdate: true,\n  // Inmutable attributes\n  updateMap: () => null,\n  fuseFuncs: [],\n  menuItems: [],\n  data: DEFAULT_DATA,\n};\n\nconst AppContext = React.createContext(DEFAULT_STATE);\n\nexport default AppContext;\n","import React from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SearchIcon from '@material-ui/icons/Search';\n\nfunction SearchBar({ closeFn = () => null, history, mini = false }) {\n\n  const [searchText, setSearchText] = React.useState('');\n  const search = (ev) => {\n    ev.preventDefault();\n    closeFn();\n    history.push(`/cerca/${searchText}`);\n    setSearchText('');\n  };\n\n  return (\n    <form\n      className=\"search-bar\"\n      onSubmit={search}>\n      <IconButton\n        className=\"search-btn\"\n        color=\"inherit\"\n        aria-label=\"Cerca\"\n        title=\"Cerca\"\n        onClick={search}\n      >\n        <SearchIcon />\n      </IconButton>\n      <TextField\n        aria-label=\"Cerca text...\"\n        title=\"Cerca text...\"\n        className=\"search-text\"\n        value={searchText}\n        InputProps={{ disableUnderline: true }}\n        onChange={ev => setSearchText(ev.target.value)}\n      />\n      {!mini &&\n        <IconButton\n          className=\"search-close\"\n          color=\"inherit\"\n          aria-label=\"Tanca\"\n          title=\"Tanca\"\n          onClick={closeFn}\n        >\n          <CloseIcon />\n        </IconButton>\n      }\n    </form>\n  );\n}\n\nexport default SearchBar;\n","import React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport AppContext from '../AppContext';\nimport AppBar from '@material-ui/core/AppBar';\nimport ToolBar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Typography from '@material-ui/core/Typography';\nimport SearchBar from './SearchBar';\nimport Drawer from '@material-ui/core/Drawer';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nfunction Header({ history, location }) {\n\n  const [drawerOpened, setDrawerOpened] = React.useState(false);\n  const [searchOpened, setSearchOpened] = React.useState(false);\n\n  return (\n    <AppContext.Consumer>\n      {({ menuItems, searchFn }) => {\n\n        const hasDrawer = menuItems && menuItems.length > 0;\n\n        const itemAction = (item) => () => {\n          setDrawerOpened(false);\n          if (item.path)\n            history.push(item.path);\n        }\n\n        menuItems.forEach(mi => mi.current = mi.path === location.pathname);\n\n        return (\n          <>\n            <AppBar\n              className=\"header\"\n              position=\"fixed\"\n            >\n              <ToolBar\n                disableGutters={true}\n              >\n                {hasDrawer &&\n                  <IconButton\n                    className=\"main-menu-button\"\n                    color=\"inherit\"\n                    aria-label=\"Seccions\"\n                    title=\"Seccions\"\n                    onClick={() => setDrawerOpened(true)}\n                  >\n                    <MenuIcon />\n                  </IconButton>\n                }\n                <div className=\"main-header-block\">\n                  <div className=\"top-bar\">\n                    <a className=\"logo-gencat\" href=\"https://web.gencat.cat/\" title=\"Generalitat de Catalunya\" target=\"_top\">gencat.cat</a>\n                    <SearchBar {...{ className: 'search-bar', history, mini: true }} />\n                  </div>\n                  <Typography className=\"main-title\" variant=\"h6\" color=\"inherit\" noWrap>\n                    Mapa de la Innovació Educativa\n                </Typography>\n                  <ul className=\"nav-bar\">\n                    {menuItems.map(item => (\n                      <li key={item.id}>\n                        <div className=\"nav-label\" role=\"button\" current={item.current ? 'true' : 'false'} onClick={itemAction(item)}>{item.name}</div>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n                <IconButton\n                  className=\"search-btn-small\"\n                  color=\"inherit\"\n                  aria-label=\"Cerca\"\n                  title=\"Cerca\"\n                  onClick={() => setSearchOpened(!searchOpened)}\n                >\n                  <SearchIcon />\n                </IconButton>\n              </ToolBar>\n              {searchOpened && <SearchBar {...{ closeFn: () => setSearchOpened(false), history }} />}\n            </AppBar>\n            {\n              hasDrawer &&\n              <Drawer\n                variant=\"persistent\"\n                anchor=\"left\"\n                open={drawerOpened}\n              >\n                <List>\n                  <ListItem component=\"li\" divider button onClick={() => setDrawerOpened(false)}>\n                    <ListItemIcon>\n                      <ChevronLeftIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Tanca el menú\" />\n                  </ListItem>\n                  {menuItems.map(item => (\n                    <ListItem component=\"li\" button key={item.id} onClick={itemAction(item)}>\n                      <ListItemText primary={item.name} />\n                    </ListItem>\n                  ))}\n                </List>\n              </Drawer>\n            }\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default withRouter(Header);\n","// Textos utilitzats a l'aplicació\n\nexport const intro = `\n#### ATENCIÓ: Espai en construcció\n\nLorem ipsum _dolor_ sit amet, __consectetur__ adipiscing elit. Sed et eleifend diam, sed commodo orci. Sed ut eros faucibus, varius velit eget, euismod quam. Vivamus sed odio erat.\n\nCras ac sem egestas nisi vestibulum ultricies. Sed mattis sem quis sagittis pretium. Nulla vel tortor lacinia, venenatis diam non, vulputate ante. Aenean sed nibh eget erat varius aliquet.\n\n---\n\nSed in [condimentum](http://condimentum.com.mx/ \"Una web mexicana de condiments\") ex, vel elementum ipsum. Morbi rutrum felis sit amet iaculis maximus. Nulla laoreet ante vel lacinia feugiat. Mauris suscipit interdum tellus vitae ultrices. Pellentesque ligula sem, sodales et consequat ut, interdum ut tellus. In laoreet aliquam luctus. Vestibulum at diam ut diam ornare mollis.\n\n`;\n\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport { intro } from '../literals';\n\nconst MD_OPTIONS = {\n  escapeHtml: false,\n};\n\nfunction Presentacio({ history }) {\n\n  return (\n    <AppContext.Consumer>\n      {() => {\n        return (\n          <section className=\"seccio presenta\">\n            <Paper className=\"paper\">\n              <Typography variant=\"h4\" color=\"inherit\">Presentació</Typography>\n              <ReactMarkdown {...MD_OPTIONS}>\n                {intro}\n              </ReactMarkdown>\n              <Button\n                className=\"close-intro-btn\"\n                variant=\"outlined\"\n                onClick={() => history.push('/programes')}\n              >Ves al mapa</Button>\n            </Paper>\n          </section>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Presentacio;","import React from 'react';\nimport { TileLayer } from 'react-leaflet';\n\nconst LAYERS = {\n  // Original OpenStreetMap\n  osm: {\n    attribution: '&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\n    url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  },\n  // Mapbox.com\n  // ATENCIÓ: Max. 50.000 visualitzacions / mes\n  // Veure https://mapbox.com\n  // Provar amb id: `mapbox.satellite`, `mapbox.streets`...\n  mapbox: {\n    attribution: 'Dades del mapa © contribuïdors de <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a>, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imatges © <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n    url: 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',\n    id: 'mapbox.streets',\n    accessToken: process.env.REACT_APP_MAPBOX_TOKEN || '',\n  },\n  // Wikimedia\n  wikimedia: {\n    attribution: '<a href=\"https://wikimediafoundation.org/wiki/Maps_Terms_of_Use\">Wikimedia</a>',\n    url: 'https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png',\n    minZoom: 1,\n    maxZoom: 19,\n  }\n};\n\nconst BUILT_LAYERS = {};\n\nfunction getTileLayer({ type = 'wikimedia' }) {\n  if (!BUILT_LAYERS[type])\n    BUILT_LAYERS[type] = <TileLayer {...LAYERS[type]} />\n  return BUILT_LAYERS[type];\n}\n\nexport default getTileLayer;\n","// Workaround to erors in `react-leaflet-markercluster`\n// From: https://github.com/YUzhva/react-leaflet-markercluster/issues/71#issuecomment-466393028\n\nimport { MapLayer, withLeaflet } from 'react-leaflet';\nimport L from 'leaflet';\nrequire('leaflet.markercluster');\n// Moved to `index.js`\n// import 'leaflet.markercluster/dist/MarkerCluster.css';\n// import 'leaflet.markercluster/dist/MarkerCluster.Default.css';\n\nclass MarkerClusterGroup extends MapLayer {\n\n  createLeafletElement(props) {\n    const { clusterProps = {} } = props;\n    const el = new L.markerClusterGroup({ ...props, ...clusterProps });\n    this.contextValue = {\n      ...props.leaflet,\n      layerContainer: el\n    };\n    return el;\n  }\n}\n\nexport default withLeaflet(MarkerClusterGroup);\n","import React from 'react';\nimport { Map, Polygon, Marker, Popup, LayersControl, LayerGroup } from 'react-leaflet';\nimport TileLayer from '../utils/TileLayer';\nimport MarkerClusterGroup from '../utils/MarkerClusterGroup';\n// Moved to `index.js`:\n// import 'react-leaflet-fullscreen/dist/styles.css';\nimport FullscreenControl from 'react-leaflet-fullscreen';\nimport Utils from '../utils/Utils';\n\n// See ../utils/TileLayer for all available options\nconst TILE_LAYER = process.env.REACT_APP_TILE_LAYER || 'wikimedia';\nconst PRESERVE_MAP_BOUNDS = (process.env.REACT_APP_PRESERVE_MAP_BOUNDS || 'true') === 'true';\n\n// Enlarge map bounds to make space for popups\nconst MAP_BOUNDS = [[40.50, 0.15], [42.90, 3.34]];\nconst MAX_BOUNDS = [[39.50, -0.85], [43.90, 4.34]];\n\n// Options for MarkerCluster\n// See: https://github.com/Leaflet/Leaflet.markercluster\nconst MARKERCLUSTER_PROPS = {\n  showCoverageOnHover: false, // Default is `true`\n  maxClusterRadius: 30, // Default is 80\n};\n\nexport default function MainMap({ points = [], polygons = [], programa = null, poli = null, center = [41.7, 1.8], zoom = 8, maxZoom = 13, history, updateMap }) {\n\n  // Optional overlays\n  const OVERLAYS = [\n    {\n      name: 'Mostra la participació per zones',\n      flag: 'showDensity',\n      default: false,\n    },\n    {\n      name: 'Mostra els centres',\n      flag: 'showCentres',\n      default: true,\n    },\n  ];\n\n  // Save overlay preferences to browser's local storage\n  const OVERLAY_SETTINGS_STORAGE = window.localStorage;\n  const getBool = key => OVERLAY_SETTINGS_STORAGE.getItem(key) === 'true';\n  const getInt = key => Number(OVERLAY_SETTINGS_STORAGE.getItem(key));\n  const setVal = (key, val) => OVERLAY_SETTINGS_STORAGE.setItem(key, val);\n\n  // Save the current map bounds in session storage, thus allowing to navigate between pages preserving map layout.\n  const MAP_BOUNDS_STORAGE = window.sessionStorage;\n  const saveBounds = (bounds) => MAP_BOUNDS_STORAGE.setItem('mapBounds', bounds.toBBoxString());\n  const getSavedBounds = () => {\n    const str = MAP_BOUNDS_STORAGE.getItem('mapBounds');\n    if (!str)\n      return null;\n    const values = str.split(',');\n    if (values.length !== 4)\n      return null;\n    return [[\n      Number(values[1]), // Lat SW\n      Number(values[0]), // Lng SW\n    ], [\n      Number(values[3]), // Lat NE\n      Number(values[2]), // Lng NE\n    ]];\n  };\n\n  // Don't preserve map bounds in `single polygon` mode\n  const preserveBounds = PRESERVE_MAP_BOUNDS && poli === null;\n  const currentlySavedBounds = preserveBounds && getSavedBounds();\n\n  // Handle zoom changes\n  const boundsChanged = ev => {\n    if (preserveBounds && ev.target && ev.target.getBounds)\n      saveBounds(ev.target.getBounds());\n  }\n\n  // Line width and opacity of polygons\n  const lineWidth = 2;\n  const minOpacity = 0;\n\n  // Force `updateMap` when changing some layout settings\n  const onBaseLayerChange = (ev) => {\n    const layerIndex = polygons.findIndex(p => p.name === ev.name);\n    if (layerIndex >= 0) {\n      setVal('currentLayer', layerIndex);\n      if (getBool(OVERLAYS[0].flag))\n        updateMap({}, false);\n    }\n  }\n\n  // Force `updateMap` when changing some overlay settings\n  const overlayChange = (type) => (ev) => {\n    const ov = OVERLAYS.findIndex(ov => ov.name === ev.name);\n    if (ov >= 0) {\n      const overlayVisible = (type === 'add');\n      OVERLAY_SETTINGS_STORAGE.setItem(OVERLAYS[ov].flag, overlayVisible);\n      if (ov === 0 && overlayVisible)\n        updateMap({}, false);\n    }\n  }\n\n  // Current layer defaults to \"SEZ\" (índex 1)\n  const currentLayer = getInt('currentLayer');\n  setVal('currentLayer', currentLayer);\n\n  // Set default or stored value in each overlay\n  OVERLAYS.forEach(ov => {\n    const stored = OVERLAY_SETTINGS_STORAGE.getItem(ov.flag);\n    setVal(ov.flag, stored === null ? ov.default : stored);\n  });\n\n  const obreCentre = (id) => () => history.push(`/centre/${id}`);\n\n  const popupCentre = (centre) => (\n    <Popup>\n      <h4 style={{ cursor: 'pointer' }} onClick={obreCentre(centre.id)}>{centre.nom}</h4>\n      {centre.adreca}<br />\n      <a href={centre.web}>{centre.web}</a>\n    </Popup>\n  );\n\n  const obreZona = (key) => () => history.push(`/zona/${key}`);\n\n  const popupZona = (zona) => {\n    const centresPart = zona.centresPart.size;\n    const estudisPart = Utils.sumAll(zona.estudisPart);\n    const estudisBase = Utils.sumAll(zona.estudisBase);\n    const perCent = (estudisBase > 0 ? (estudisPart / estudisBase) * 100 : 0).toFixed(1);\n    return <Popup>\n      <h4 style={{ cursor: 'pointer' }} onClick={obreZona(zona.key)}>{zona.nom}</h4>\n      {(centresPart &&\n        <p>\n          <span>{`Centres participants ${programa ? 'al programa seleccionat' : 'als programes seleccionats'}: ${centresPart}`}</span><br />\n          <span>{`Índex de participació: ${perCent}%`}</span>\n        </p>) ||\n        <p>No hi ha cap centre que participi als programes seleccionats.</p>\n      }\n    </Popup>\n  };\n\n  return (\n    <Map\n      className=\"mapa markercluster-map\"\n      {...{\n        maxZoom,\n        minZoom: zoom,\n        bounds: (poli && poli.bounds) || currentlySavedBounds || MAP_BOUNDS,\n        maxBounds: MAX_BOUNDS,\n        onBaseLayerChange,\n        onOverlayAdd: overlayChange('add'),\n        onOverlayRemove: overlayChange('remove'),\n        onZoomEnd: boundsChanged,\n        onMoveEnd: boundsChanged,\n      }}\n    >\n      <TileLayer type={TILE_LAYER} />\n      <LayersControl position=\"topright\">\n        {polygons.map((p, i) => (\n          <LayersControl.BaseLayer name={p.name} key={i} checked={poli !== null ? i === (poli.tipus === 'SEZ' ? 1 : 0) : i === currentLayer}>\n            <LayerGroup>\n              {p.shapes.filter(sh => poli === null || poli === sh).map((sh, n) => (\n                <Polygon\n                  key={n}\n                  positions={sh.poligons}\n                  weight={lineWidth}\n                  fillOpacity={minOpacity}\n                >\n                  {popupZona(sh)}\n                </Polygon>))}\n            </LayerGroup>\n          </LayersControl.BaseLayer>\n        ))}\n        <LayersControl.Overlay name={OVERLAYS[0].name} checked={poli === null && getBool(OVERLAYS[0].flag)}>\n          <LayerGroup>\n            {polygons[currentLayer].shapes.filter(sh => poli === null || poli === sh).map((sh, n) => (\n              <Polygon\n                key={n}\n                positions={sh.poligons}\n                weight={0}\n                fillOpacity={sh.density}\n              >\n                {popupZona(sh)}\n              </Polygon>))}\n          </LayerGroup>\n        </LayersControl.Overlay>\n        <LayersControl.Overlay name={OVERLAYS[1].name} checked={poli !== null || getBool(OVERLAYS[1].flag)}>\n          <MarkerClusterGroup clusterProps={MARKERCLUSTER_PROPS}>\n            {points.map(pt => (\n              <Marker key={pt.id} position={[pt.lat, pt.lng]}>\n                {popupCentre(pt)}\n              </Marker>\n            ))}\n          </MarkerClusterGroup>\n        </LayersControl.Overlay>\n      </LayersControl>\n      <FullscreenControl\n        position=\"topleft\"\n        title=\"Mostra el mapa a pantalla completa\"\n        titleCancel=\"Surt de la pantalla completa\"\n      />\n    </Map>\n  )\n}\n","import React from 'react';\nimport { Map, Marker } from 'react-leaflet';\nimport TileLayer from '../utils/TileLayer';\n\n// See ../utils/TileLayer for all available options\nconst TILE_LAYER = process.env.REACT_APP_TILE_LAYER || 'wikimedia';\nconst MAP_BOUNDS = [[40.50, 0.15], [42.90, 3.34]];\n\nexport default function MapaCentre({ point, center = [41.7, 1.8], zoom = 8, maxZoom = 19 }) {\n\n  return (\n    <Map\n      className=\"mapa-centre\"\n      {...{ center, zoom, maxZoom, minZoom: zoom, maxBounds: MAP_BOUNDS }}\n    >\n      <TileLayer type={TILE_LAYER} />\n      <Marker key={point.id} position={[point.lat, point.lng]} />\n    </Map>\n  )\n}","import React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport MainMap from './MainMap';\nimport MapaCentre from './MapaCentre';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepButton from '@material-ui/core/StepButton';\nimport Utils from '../utils/Utils';\n\nfunction MapSection({ data: { programes, centres, poligons, cursosDisp }, programa, centre, zona, cursos, currentPrograms, polygons, mapChanged, history, updateMap }) {\n\n  const singleCentre = centre ? centres.get(centre) : null;\n  const poli = zona ? poligons.get(zona) : null;\n  const w = window.innerWidth;\n  const zoom = w < 600 ? 7 : w < 820 ? 8 : w < 1300 ? 7 : 8;\n\n  const addSchoolsOfProgram = (progId, dest) => {\n    const prog = programes.get(progId);\n    if (prog)\n      Object.keys(prog.centres).forEach(curs => {\n        if (!cursos || cursos.includes(curs))\n          prog.centres[curs].forEach(centre => {\n            if ((!poli || poli.centresInn.has(centre)) && !dest.find(c => c.id === centre.id))\n              dest.push(centre)\n          });\n      });\n    return dest;\n  };\n\n  const points = [];\n  if (!mapChanged) {\n    if (singleCentre) {\n      points.push(singleCentre);\n    }\n    else if (programa)\n      addSchoolsOfProgram(programa, points);\n    else\n      currentPrograms.forEach(progId => addSchoolsOfProgram(progId, points));\n  }\n\n  const handleSelectCurs = curs => ev => {\n    const result = [];\n    cursosDisp.forEach(c => {\n      if ((curs === c && !cursos.includes(c)) || (curs !== c && cursos.includes(c)))\n        result.push(c);\n    });\n    updateMap({ cursos: result }, true, true);\n\n  }\n\n  return (\n    <section className=\"seccio smapa\">\n      <Paper className={singleCentre ? 'paper' : 'paper no-padding-top'}>\n        {(singleCentre &&\n          <MapaCentre\n            {...{\n              point: singleCentre,\n              center: [singleCentre.lat, singleCentre.lng],\n              zoom: 15,\n              maxZoom: 19,\n            }}\n          />) ||\n          <>\n            <Stepper\n              className=\"cursos\"\n              nonLinear\n              alternativeLabel\n              activeStep={null}\n            >\n              {cursosDisp.map((c, k) => (\n                <Step key={c}>\n                  <StepButton\n                    onClick={handleSelectCurs(c)}\n                    completed={cursos.includes(c)}\n                  >{Utils.cursCurt(c)}</StepButton>\n                </Step>\n              ))}\n            </Stepper>\n            <MainMap\n              {...{\n                points,\n                polygons,\n                programa,\n                poli,\n                center: [41.7, 1.8],\n                zoom,\n                maxZoom: 19,\n                history,\n                updateMap\n              }}\n            />\n          </>\n        }\n      </Paper>\n    </section>\n  );\n}\n\nexport default MapSection;\n","import React from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Typography from '@material-ui/core/Typography';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\n\n\nfunction SelectProgramsDlg({ dlgOpen, setDlgOpen, data: { programes, ambitsCurr, ambitsInn, nivells }, updateMap }) {\n\n  const [ambitInn, setAmbitInn] = React.useState('');\n  const [ambitCurr, setAmbitCurr] = React.useState('');\n  const [nivellsChk, setNivellsChk] = React.useState(Array.from(nivells).reduce((v, [n]) => { v[n] = true; return v; }, {}));\n\n  // Better to user a react reducer?\n  const [currentPrograms, setCurrentPrograms] = React.useState(new Set());\n\n  const updateCurrentPrograms = () => {\n    const progs = new Set();\n    programes.forEach((prog, id) => {\n      if (\n        (ambitInn === '' || prog.ambInn.includes(ambitInn)) &&\n        (ambitCurr === '' || prog.ambCurr.includes(ambitCurr)) &&\n        Object.keys(nivellsChk).find(nivell => nivellsChk[nivell] && nivells.get(nivell).find(tag => prog.tipus.includes(tag)))\n      )\n        progs.add(id);\n    });\n    setCurrentPrograms(progs);\n    // TODO: Comptar centres!\n  };\n\n  React.useMemo(updateCurrentPrograms, [ambitInn, ambitCurr, nivellsChk]);\n\n  const listSelection = handle => ev => {\n    handle(ev.target.value);\n  };\n\n  const handleCheckNivell = n => ev => {\n    setNivellsChk({ ...nivellsChk, [n]: ev.target.checked });\n  };\n\n  const closeDialog = ok => ev => {\n    if (ok)\n      updateMap({ currentPrograms }, true, true);\n    setDlgOpen(false);\n  };\n\n  return (\n    <Dialog\n      open={dlgOpen}\n      onEnter={updateCurrentPrograms}\n      aria-labelledby=\"dialog-title\"\n      classes={{ paper: 'stretch-dlg' }}\n    >\n      <DialogTitle id=\"dialog-title\">Tipus de programes</DialogTitle>\n      <DialogContent className=\"dialog-content\">\n        <div className=\"nivells\">\n          {Array.from(nivells).map(([nivell]) => (\n            <FormControlLabel\n              key={nivell}\n              className=\"select-nivell\"\n              control={\n                < Checkbox\n                  onChange={handleCheckNivell(nivell)}\n                  value={nivell}\n                  checked={nivellsChk[nivell]}\n                />}\n              label={nivell}\n            />\n          ))}\n        </div>\n        <FormControl className=\"select-list\">\n          <InputLabel htmlFor=\"select-ambit-curr\">Àmbit curricular</InputLabel>\n          <Select\n            value={ambitCurr}\n            onChange={listSelection(setAmbitCurr)}\n            inputProps={{\n              name: 'ambitCurr',\n              id: 'select-ambit-curr'\n            }}\n          >\n            <MenuItem value=\"\"><em>Tots els àmbits</em></MenuItem>\n            {Array.from(ambitsCurr.keys()).sort().map(key => (\n              <MenuItem key={key} value={key}>{ambitsCurr.get(key)}</MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n\n        <FormControl className=\"select-list\">\n          <InputLabel htmlFor=\"select-ambit-inn\">Àmbit d'innovació</InputLabel>\n          <Select\n            value={ambitInn}\n            onChange={listSelection(setAmbitInn)}\n            inputProps={{\n              name: 'ambitInn',\n              id: 'select-ambit-inn'\n            }}\n          >\n            <MenuItem value=\"\"><em>Tots els àmbits</em></MenuItem>\n            {Array.from(ambitsInn.keys()).sort().map(key => (\n              <MenuItem key={key} value={key}>{ambitsInn.get(key)}</MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n        <Typography className=\"info\">\n          {currentPrograms.size} {currentPrograms.size === 1 ? 'programa seleccionat' : 'programes seleccionats'}\n        </Typography>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={closeDialog(true)} color=\"primary\" >Aplica la selecció</Button>\n        <Button onClick={closeDialog(false)} color=\"primary\">Cancel·la</Button>\n      </DialogActions>\n\n    </Dialog>\n  );\n\n}\n\nexport default SelectProgramsDlg;\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport MapSection from './MapSection';\nimport Paper from '@material-ui/core/Paper';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Switch from '@material-ui/core/Switch';\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport ArrowDownward from '@material-ui/icons/ArrowDownward';\nimport SelectProgramsDlg from './SelectProgramsDlg';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Utils from '../utils/Utils';\n\nfunction Programes({ history }) {\n\n  const [dlgOpen, setDlgOpen] = React.useState(false);\n\n  return (\n    <AppContext.Consumer>\n      {({ data, data: { programes, ambitsCurr, ambitsInn, nivells }, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        const allSelected = currentPrograms.size === programes.size;\n\n        // Click on program name\n        const handleProgClick = id => () => history.push(`/programa/${id}`);\n\n        // Select / Unselect program\n        const handleProgSelect = id => ev => {\n          currentPrograms[currentPrograms.has(id) ? 'delete' : 'add'](id);\n          updateMap({ currentPrograms, ambitCurr: '', ambitInn: '', nivell: '' }, true, true);\n        };\n\n        // Select / unselect all programs\n        const handleSelectAll = ev => {\n          if (ev.target.checked)\n            programes.forEach((_p, id) => currentPrograms.add(id));\n          else\n            currentPrograms.clear();\n          updateMap({ currentPrograms }, true, true);\n        };\n\n        const gomap = () => document.querySelector('.smapa').scrollIntoView();\n\n        return (\n          <>\n            <Button className=\"gomap\" aria-label=\"Mapa\" onClick={gomap} >\n              <ArrowDownward className=\"left-icon\" />\n              Mapa\n            </Button>\n            <section className=\"seccio programes\">\n              <SelectProgramsDlg {...{ dlgOpen, setDlgOpen, data: { programes, ambitsCurr, ambitsInn, nivells }, updateMap }} />\n              <Paper className=\"paper\">\n                <h3>Programes d'innovació</h3>\n                <div className=\"select-progs\">\n                  <Button variant=\"outlined\" color=\"primary\" onClick={() => setDlgOpen(true)}>Selecciona per tipus</Button>\n                  <FormControlLabel\n                    className=\"select-all\"\n                    labelPlacement=\"start\"\n                    control={\n                      <Checkbox\n                        onChange={handleSelectAll}\n                        checked={allSelected}\n                      />}\n                    label=\"Selecciona'ls tots\"\n                  />\n                </div>\n                <List className=\"prog-list\">\n                  {Array.from(programes.values()).map(({ id, nom, simbol, centres }, n) => (\n                    <ListItem key={n} button className=\"list-button\">\n                      <ListItemAvatar>\n                        <Avatar src={`logos/${simbol}`} alt={nom} />\n                      </ListItemAvatar>\n                      <ListItemText\n                        primary={nom}\n                        secondary={'Centres participants: ' + Object.keys(centres).sort().map(k => `${Utils.cursCurt(k)}: ${centres[k].length}`).join(', ')}\n                        onClick={handleProgClick(id)} />\n                      <ListItemSecondaryAction>\n                        <Switch onChange={handleProgSelect(id)} checked={currentPrograms.has(id)} />\n                      </ListItemSecondaryAction>\n                    </ListItem>\n                  ))}\n                </List>\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: null, zona: null, cursos, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Programes;\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport ReportProblem from '@material-ui/icons/ReportProblem';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport Refresh from '@material-ui/icons/Refresh';\n\nfunction Error({ error, history, refetch }) {\n  return (\n    <div className=\"err-msg\">\n      <Typography >\n        <ReportProblem className=\"err-icon\" color=\"secondary\" />\n        {error || 'Error desconegut!'}\n      </Typography>\n      {\n        (refetch &&\n          <Button\n            className='action-btn'\n            aria-label=\"Reintenta\"\n            onClick={refetch}\n            variant='outlined' >\n            <Refresh className=\"left-icon\" />\n            Reintenta\n        </Button>) ||\n        (history && history.length > 1 &&\n          <Button\n            className=\"action-btn\"\n            aria-label=\"Torna\"\n            variant=\"outlined\"\n            onClick={() => history.goBack()} >\n            <ArrowBack className=\"left-icon\" />\n            Torna\n        </Button>)\n      }\n    </div>\n  );\n}\n\nexport default Error;","import React from 'react';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport CloudDownloadIcon from '@material-ui/icons/CloudDownload';\nimport Error from './Error';\nimport MapSection from './MapSection';\n\nconst MD_OPTIONS = {\n  escapeHtml: false,\n};\n\nfunction FitxaPrograma({ history, match: { params: { id } } }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        const { programes, estudis, ambitsCurr, ambitsInn } = data;\n\n        // Find the specified program\n        const programa = programes.get(id);\n        if (!programa)\n          return <Error {...{ error: `No hi ha cap programa amb el codi: ${id}`, history }} />\n\n        // Els camps id, nomCurt i color no s'utilitzen\n        const { nom, descripcio, link, ambCurr, ambInn, fitxa, video, objectius, requisits, compromisos, contacte, normativa, arees, simbol, tipus, centres } = programa;\n\n        const torna = () => history.goBack();\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={torna} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio programa\">\n              <Paper className=\"paper\">\n                <h3>{nom}</h3>\n                <div id=\"descripcio\">\n                  {simbol && <img className=\"prog-logo\" src={`logos/${simbol}`} alt={nom}></img>}\n                  <ReactMarkdown {...MD_OPTIONS}>\n                    {descripcio}\n                  </ReactMarkdown>\n                  <br clear=\"all\" />\n                </div>\n                {objectius &&\n                  <div className=\"prog-objectius\">\n                    <h4>Objectius</h4>\n                    <ReactMarkdown {...MD_OPTIONS}>\n                      {objectius}\n                    </ReactMarkdown>\n                  </div>\n                }\n                {requisits &&\n                  <div className=\"prog-requisits\">\n                    <h4>Requisits</h4>\n                    <ReactMarkdown {...MD_OPTIONS}>\n                      {requisits}\n                    </ReactMarkdown>\n                  </div>\n                }\n                {compromisos &&\n                  <div className=\"prog-compromisos\">\n                    <h4>Compromisos</h4>\n                    <ReactMarkdown {...MD_OPTIONS}>\n                      {compromisos}\n                    </ReactMarkdown>\n                  </div>\n                }\n                {normativa &&\n                  <div className=\"prog-normativa\">\n                    <h4>Normativa</h4>\n                    <ReactMarkdown {...MD_OPTIONS}>\n                      {normativa}\n                    </ReactMarkdown>\n                  </div>\n                }\n                {contacte &&\n                  <div className=\"prog-contacte\">\n                    <h4>Contacte</h4>\n                    <div><a href={`mailto:${contacte}`}>{contacte}</a></div>\n                  </div>\n                }\n                {ambInn.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>Àmbits d'innovació:</h4>\n                    <ul>\n                      {ambInn.map(a => <li key={a}>{ambitsInn.get(a)}</li>)}\n                    </ul>\n                  </div>\n                }\n                {ambCurr.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>Àmbits curriculars:</h4>\n                    <ul>\n                      {ambCurr.map(a => <li key={a}>{ambitsCurr.get(a)}</li>)}\n                    </ul>\n                  </div>\n                }\n                {arees.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>Àrees curriculars:</h4>\n                    <ul>\n                      {arees.map((a, n) => <li key={n}>{a}</li>)}\n                    </ul>\n                  </div>\n                }\n                {tipus.length > 0 &&\n                  <div className=\"prog_ambits\">\n                    <h4>Nivells educatius:</h4>\n                    <ul>\n                      {tipus.map((t, n) => <li key={n}>{estudis.get(t)}</li>)}\n                    </ul>\n                  </div>\n                }\n                {link &&\n                  <p><a href={link} target=\"_blank\" rel=\"noopener noreferrer\">Més informació sobre el programa</a></p>\n                }\n                {fitxa &&\n                  <Button variant=\"contained\" className=\"prog-fitxa\" href={fitxa} >\n                    <CloudDownloadIcon className=\"left-icon\" />\n                    Fitxa\n                  </Button>\n                }\n                {video &&\n                  <div className=\"prog-video\">\n                    <br />\n                    <ReactMarkdown {...MD_OPTIONS}>\n                      {video}\n                    </ReactMarkdown>\n                  </div>\n                }\n                <h4>Centres participants:</h4>\n                <br />\n                {Object.keys(centres).map((curs, n) => (\n                  <ExpansionPanel key={n}>\n                    <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                      <Typography className=\"wider\">{`CURS ${curs}`}</Typography>\n                      <Typography>{`${centres[curs].length} ${centres[curs].length === 1 ? 'centre' : 'centres'}`}</Typography>\n                    </ExpansionPanelSummary>\n                    <ExpansionPanelDetails className=\"small-padding-h\">\n                      <List dense>\n                        {centres[curs].sort((a, b) => a.nom.localeCompare(b.nom)).map(({ id: codi, nom, municipi, titols }, c) => (\n                          <ListItem key={c} button component=\"a\" href={`#/centre/${codi}`} className=\"small-padding-h\">\n                            <ListItemText\n                              primary={`${nom} (${municipi})`}\n                              secondary={(titols && titols[id] ? titols[id] : null)}\n                            />\n                          </ListItem>\n                        ))}\n                      </List>\n                    </ExpansionPanelDetails>\n                  </ExpansionPanel>\n                ))}\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: id, centre: null, zona: null, cursos, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaPrograma;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Avatar from '@material-ui/core/Avatar';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Typography from '@material-ui/core/Typography';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport Utils from '../utils/Utils';\nimport Error from './Error';\nimport MapSection from './MapSection';\n\n// Possible values are `perCurs` and `agregat`\nconst MODE_PROG_CENTRE = process.env.REACT_APP_MODE_PROG_CENTRE || 'agregat';\n\nfunction FitxaCentre({ history, match: { params: { codi } } }) {\n  return (\n    <AppContext.Consumer>\n      {({ data, currentPrograms, polygons, mapChanged, updateMap }) => {\n        // Find the specified program\n        const centre = data.centres.get(codi);\n        if (!centre)\n          return <Error {...{ error: `No hi ha cap programa amb el codi: ${codi}`, history }} />\n\n        // Els camps tipus, sstt, se també estan disponibles\n        const { nom, municipi, comarca, estudis, adreca, web, logo, nodes, web_propi, tel, mail, twitter, sstt, se, public: pb, programes, titols } = centre;\n        const url = nodes || web || web_propi;\n        const tancaFitxa = () => history.goBack();\n        const obrePrograma = id => () => history.push(`/programa/${id}`);\n        const servei_territorial = data.poligons.get(sstt);\n        const servei_educatiu = data.poligons.get(se);\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={tancaFitxa} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio centre\">\n              <Paper className=\"paper\">\n                {logo && <><br clear=\"all\" /><img className=\"cent-logo\" src={logo} alt={nom}></img></>}\n                <h3>{nom}</h3>\n                <div id=\"tipus\">Centre {pb ? 'públic' : 'privat concertat'}</div>\n                <br clear=\"all\" />\n                <div id=\"adreca\">\n                  <p>\n                    {adreca}<br />\n                    {`${municipi} (${comarca})`}<br />\n                    {tel && <>{`Tel. ${tel}`}<br /></>}\n                    {mail && <><a href={`mailto:${mail}`}>{mail}</a><br /></>}\n                    {twitter && <><a href={`https://twitter.com/${twitter}`} target=\"_blank\" rel=\"noopener noreferrer\">{twitter}</a><br /></>}\n                  </p>\n                </div>\n                {url && (\n                  <div id=\"link\">\n                    <h4>Portal web del centre:</h4>\n                    <a href={url} target=\"_blank\" rel=\"noopener noreferrer\">{url}</a>\n                  </div>)}\n                <div id=\"estudis\">\n                  <h4>Estudis que s'hi imparteixen:</h4>\n                  <ul>\n                    {estudis.map((e, n) => <li key={n}>{data.estudis.get(e)}</li>)}\n                  </ul>\n                </div>\n                <div id=\"zones\">\n                  <h4>Zona:</h4>\n                  <ul>\n                    {servei_territorial && <li><Link to={`/zona/${sstt}`}>{servei_territorial.nom}</Link></li>}\n                    {servei_educatiu && <li><Link to={`/zona/${se}`}>{servei_educatiu.nom}</Link></li>}\n                  </ul>\n                </div>\n                <h4>Programes d'innovació educativa on participa:</h4>\n                <br />\n                {(MODE_PROG_CENTRE === 'perCurs' &&\n                  Object.keys(programes)\n                    .map((curs, n) => (\n                      <ExpansionPanel key={n}>\n                        <ExpansionPanelSummary expandIcon={<ExpandMoreIcon />}>\n                          <Typography className=\"wider\">CURS {curs}</Typography>\n                          <Typography>{`${programes[curs].length} ${programes[curs].length === 1 ? 'programa' : 'programes'}`}</Typography>\n                        </ExpansionPanelSummary>\n                        <ExpansionPanelDetails>\n                          <ul>\n                            {programes[curs].map(({ id, nom }, c) => {\n                              return (\n                                <li key={c} >\n                                  <Button onClick={obrePrograma(id)}>{nom}{(titols && titols[id]) ? ` - ${titols[id]}` : ''}</Button>\n                                </li>\n                              );\n                            })}\n                          </ul>\n                        </ExpansionPanelDetails>\n                      </ExpansionPanel>\n                    )))\n                  ||\n                  <List >\n                    {Utils.plainArray(programes).map(({ id, nom, simbol, cursos }, n) => (\n                      <ListItem key={n} button className=\"no-padding-h-small\">\n                        <ListItemAvatar>\n                          <Avatar src={`logos/${simbol}`} alt={nom} />\n                        </ListItemAvatar>\n                        <ListItemText\n                          primary={nom}\n                          secondary={(titols && titols[id]) || `${cursos.sort().join(', ')}`}\n                          onClick={obrePrograma(id)} />\n                      </ListItem>\n                    ))}\n                  </List>\n                }\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: codi, zona: null, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaCentre;\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport IconButton from '@material-ui/core/IconButton';\nimport Error from './Error';\nimport MapSection from './MapSection';\nimport Utils from '../utils/Utils';\n\nfunction FitxaZona({ history, match: { params: { key } } }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        // Find the specified program\n        const zona = data.poligons.get(key);\n        if (!zona)\n          return <Error {...{ error: `No hi ha cap zona amb el codi: ${key}`, history }} />\n\n        // Els camps id, nomCurt i color no s'utilitzen\n        const { nom, tipus, centresInn } = zona;\n\n        const torna = () => history.goBack();\n        const obreCentre = codi => () => history.push(`/centre/${codi}`);\n        const obrePrograma = id => () => history.push(`/programa/${id}`);\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={torna} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio zona\">\n              <Paper className=\"paper\">\n                <h3>{nom}</h3>\n                <div>{`Tipus: ${tipus}`}</div>\n                <div id=\"descripcio\">\n                  <p>... aquí hi anirà l'adreça, la web i altres informacions relacionades amb el ST/SE ...</p>\n                </div>\n                <h4>Centres d'aquest servei que participen en programes d'innovació:</h4>\n                <List >\n                  {Array.from(centresInn).sort((a, b) => a.nom.localeCompare(b.nom)).map(({ id: codi, nom, municipi, programes, titols }, n) => {\n                    return (\n                      <ListItem key={n} button className=\"small-padding-h\">\n                        <ListItemText\n                          primary={`${nom} (${municipi})`}\n                          onClick={obreCentre(codi)}\n                        />\n                        <div className=\"prog-icons\">\n                          {Utils.plainArray(programes).map(({ id, nom, simbol }, k) => {\n                            const label = `${nom}${titols && titols[id] ? `: ${titols[id]}` : ''}`;\n                            return (\n                              <IconButton\n                                key={k}\n                                className=\"prog-icon\"\n                                aria-label={label}\n                                onClick={obrePrograma(id)}\n                              >\n                                <img src={`logos/${simbol}`} alt={label} title={label} />\n                              </IconButton>\n                            );\n                          })}\n                        </div>\n                      </ListItem>\n                    )\n                  })}\n                </List>\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: null, zona: key, cursos, currentPrograms, polygons, mapChanged, history, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaZona;\n","import React from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Typography from '@material-ui/core/Typography';\n\n/**\n * Basic 'loading data...' page\n */\nfunction Loading() {\n  return (\n    <div className='err-msg'>\n      <Typography>S'estan carregant les dades...</Typography>\n      <CircularProgress className='progress' />\n    </div>\n  );\n}\n\nexport default Loading;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { title, version, repository, license } from '../../package.json';\n\nfunction Footer() {\n  return (\n    <footer>\n      <div className=\"footer-content\">\n        <a className=\"logo-gencat\" href=\"https://web.gencat.cat/\" title=\"Generalitat de Catalunya\" target=\"_top\">gencat.cat</a>\n        <Typography variant=\"body2\" className=\"copyright\">\n          <a href=\"https://innovacio.xtec.cat/\">{title} v{version}</a><br />\n          <a href=\"http://www.xtec.cat\">© 2019 Departament d'Educació de la Generalitat de Catalunya</a><br />\n          <a href={`https://spdx.org/licenses/${license}.html`}>Llicència Pública de la Unió Europea {license}</a><br />\n          <a href={repository.url}>{repository.url}</a><br />\n          <br />\n          <a href=\"https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/\"><strong>Avís legal</strong></a>: D’acord amb l’article 17.1 de la Llei 19/2014, la ©Generalitat de Catalunya permet la reutilització dels continguts i de les dades sempre que se'n citi la font i la data d'actualització i que no es desnaturalitzi la informació (article 8 de la Llei 37/2007) i també que no es contradigui amb una llicència específica.\n        </Typography>\n      </div>\n    </footer>\n  );\n}\n\nexport default Footer;","import React from 'react';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport TablePagination from \"@material-ui/core/TablePagination\";\nimport ProgramIcon from '@material-ui/icons/Group';\nimport SchoolIcon from '@material-ui/icons/School';\n\nconst DEFAULT_ITEMS_PER_PAGE = Number(process.env.REACT_APP_ITEMS_PER_PAGE || 25);\n\nfunction Cerca({ history, match: { params: { query } } }) {\n\n  const [page, setPage] = React.useState(0);\n  const [itemsPerPage, setItemsPerPage] = React.useState(DEFAULT_ITEMS_PER_PAGE);\n  const [queryResults, setQueryResults] = React.useState([]);\n  const [currentQuery, setCurrentQuery] = React.useState('');\n\n  return (\n    <AppContext.Consumer>\n      {({ fuseFuncs }) => {\n\n        if (query !== currentQuery) {\n          // Perform full text search using Fuse.js\n          // See `loadData` in App.js for details about how these functions are built\n          setCurrentQuery(query);\n          setQueryResults(fuseFuncs.reduce((qr, ff) => qr.concat(ff.search(query)), []));\n        }\n\n        const goToElement = (tipus, id) => ev => {\n          history.push(`/${tipus}/${id}`);\n        };\n\n        return (\n          <>\n            <Button\n              className=\"torna\"\n              aria-label=\"Torna\"\n              onClick={() => history.goBack()} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio cerca\">\n              <Paper className=\"paper\">\n                <h2>Resultats de la cerca \"{currentQuery}\"</h2>\n                {(queryResults.length === 0 && <p>No s'ha trobat cap element coïncident amb el criteri de cerca!</p>) ||\n                  <div>\n                    <List component=\"ul\">\n                      {queryResults.slice(page * itemsPerPage, (page + 1) * itemsPerPage).map(({ item: { nom, id, tipus } }, n) => (\n                        <ListItem\n                          key={n}\n                          button\n                          onClick={goToElement(tipus, id)}\n                        >\n                          <ListItemIcon>\n                            {tipus === 'programa' ? <ProgramIcon /> : <SchoolIcon />}\n                          </ListItemIcon>\n                          <ListItemText primary={nom} />\n                        </ListItem>\n                      ))}\n                    </List>\n                    <hr />\n                    <TablePagination\n                      classes={{ spacer: 'hidden', toolbar: 'no-padding' }}\n                      component=\"nav\"\n                      page={page}\n                      rowsPerPage={itemsPerPage}\n                      onChangeRowsPerPage={ev => setItemsPerPage(ev.target.value)}\n                      count={queryResults.length}\n                      onChangePage={(ev, p) => setPage(p)}\n                      labelDisplayedRows={({ from, to, count }) => `Resultats ${from} al ${to} de ${count}`}\n                      labelRowsPerPage=\"Resultats per pàgina:\"\n                    />\n                  </div>\n                }\n              </Paper>\n            </section>\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Cerca;","import React, { Component } from 'react';\nimport { HashRouter as Router, Route } from 'react-router-dom';\nimport CheckRouteChanges from './utils/CheckRouteChanges';\n\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport MuiThemeProvider from '@material-ui/core/styles/MuiThemeProvider';\nimport { createMuiTheme } from '@material-ui/core/styles';\nimport color_error from '@material-ui/core/colors/red';\nimport Fuse from 'fuse.js';\n\nimport Utils from './utils/Utils';\nimport Header from './components/Header';\nimport Presentacio from './components/Presentacio';\nimport Programes from './components/Programes';\nimport FitxaPrograma from './components/FitxaPrograma';\nimport FitxaCentre from './components/FitxaCentre';\nimport FitxaZona from './components/FitxaZona';\nimport Error from './components/Error';\nimport Loading from './components/Loading';\nimport Footer from './components/Footer';\nimport Cerca from './components/Cerca';\nimport AppContext, { DEFAULT_STATE } from './AppContext';\n\n// Gencat dark gray\nconst color_primary = { 500: '#333' };\n\n// Gencat red\nconst color_secondary = { 500: '#c00000' };\n\n/**\n * Miscellanous values taken from environment variables\n * and from files: `.env`, `.env.development` and `.env.production`\n */\n//const API_ROOT = process.env.REACT_APP_API_ROOT || '../api';\nconst MAX_DENSITY = process.env.REACT_APP_MAX_DENSITY || 0.8;\nconst MIN_DENSITY = process.env.REACT_APP_MIN_DENSITY || 0.000001;\nconst MINMAX_DENSITY = process.env.REACT_APP_MINMAX_DENSITY || 0.4;\nconst DEBUG_GLOBAL_VAR = process.env.REACT_APP_DEBUG_GLOBAL_VAR || '';\n\n/**\n * Main Material-UI theme\n */\nconst theme = createMuiTheme({\n  palette: {\n    primary: { main: color_primary[500] },\n    secondary: { main: color_secondary[500] },\n    error: { main: color_error[500] },\n  },\n  typography: {\n    fontFamily: [\n      'Open Sans',\n      'Roboto',\n      '\"Helvetica Neue\"',\n      'Arial',\n      'sans-serif',\n    ].join(','),\n    useNextVariants: true,\n  },\n  overrides: {\n    \"MuiStepIcon\": {\n      completed: {\n        color: '#c00000 !important',\n      }\n    }\n  },\n});\n\n/**\n * Main React component\n */\nclass App extends Component {\n\n  static contextType = AppContext;\n\n  constructor() {\n    super();\n\n    // Current app sections\n    this.menuItems = [\n      {\n        id: 'presenta',\n        name: 'Presentació',\n        path: '/',\n      },\n      {\n        id: 'programes',\n        name: 'Programes',\n        path: '/programes',\n      },\n    ];\n\n    // Set the initial state\n    this.state = {\n      ...DEFAULT_STATE,\n      // Immutable attributes:\n      updateMap: this.updateMap,\n      // Functions used to perform full-text search with Fuse.js on 'centres' and 'programes', built after loading\n      fuseFuncs: [],\n      menuItems: this.menuItems,\n    };\n  }\n\n  setStateMod(values, callback = null) {\n    this.setState(values, () => {\n      if (DEBUG_GLOBAL_VAR)\n        window[DEBUG_GLOBAL_VAR] = this.state;\n      if (callback)\n        callback();\n    });\n  }\n\n\n  /**\n   * Load datasets from API or JSON files\n   */\n  loadData() {\n    this.setStateMod({ loading: true });\n    return Promise.all(\n      [\n        'data/programes.json', // `${API_ROOT}/programes/`\n        'data/instancies.json', // `${API_ROOT}/instancies/`\n        'data/centres.json',\n        'data/poligons.json',\n        'data/estudis.json',\n      ].map(uri => {\n        return fetch(uri, { method: 'GET', credentials: 'same-origin' })\n          .then(Utils.handleFetchErrors)\n          .then(response => response.json());\n      })\n    )\n      .then(([_programes, _instancies, _centres, _poligons, _estudis]) => {\n\n        // Sort data (step to be supressed with well ordered JSON sources!)\n        _centres = Utils.sortObjectArrayBy(_centres, ['sstt', 'municipi', 'nom']);\n        _programes = Utils.sortObjectArrayBy(_programes, 'nom');\n        _poligons = Utils.sortObjectArrayBy(_poligons, ['tipus', 'id', 'key']);\n\n        // Build an object with centre ids as keys, useful for optimizing searches\n        _centres.forEach(c => {\n          c.programes = [];\n        });\n\n        // Convert synthetic multi-point expressions into arrays of co-ordinates suitable for leaflet polygons\n        _poligons.forEach(p => {\n          p.poligons = p.poligons.map(pts => pts.split(',').map(pt => pt.split('|').map(vs => Number(vs))));\n          p.centresInn = new Set();\n          p.density = MIN_DENSITY;\n          p.estudisBase = {};\n          p.estudisPart = {};\n          p.centresPart = new Set();\n        });\n\n        // Prepare sets for auto-detected data\n        const currentPrograms = new Set();\n\n        // Guess missing fields in `programes`\n        // (to be supressed!)\n        _programes.forEach(p => {\n\n          // Set all programs initially selected\n          currentPrograms.add(p.id);\n\n          // Initialize `centres` (to be filled later)\n          p.centres = {};\n\n          // Empty `tipus`? then try to guess them from title and description\n          if (p.tipus.length === 0) {\n            const str = `${p.nom} ${p.nomCurt} ${p.descripcio}`;\n            if (/(FP|fp|[pP]rofessio)/.test(str))\n              p.tipus = ['CFPM', 'CFPS'];\n            else if (/(infantil|primària|escola)/.test(str))\n              p.tipus = ['EINF2C', 'EPRI'];\n            else\n              p.tipus = ['EINF2C', 'EPRI', 'ESO'];\n          }\n        });\n\n        // Convert arrays to maps\n        const centres = new Map(_centres.map(c => [c.id, c]));\n        const programes = new Map(_programes.map(p => [p.id, p]));\n        const poligons = new Map(_poligons.map(p => [p.key, p]));\n\n        // Initialize arrays of `centres` for each program, and `programa` for each centre, by curs\n        _instancies.forEach(ins => {\n          const programa = programes.get(ins.programa);\n          const centre = centres.get(ins.centre);\n          if (programa && centre) {\n            (programa.centres[ins.curs] = programa.centres[ins.curs] || []).push(centre);\n            (centre.programes[ins.curs] = centre.programes[ins.curs] || []).push(programa);\n            if (centre.sstt)\n              poligons.get(centre.sstt).centresInn.add(centre);\n            if (centre.se)\n              poligons.get(centre.se).centresInn.add(centre);\n            if (ins.titol) {\n              if (!programa.titols)\n                programa.titols = {};\n              programa.titols[centre.id] = `${programa.titols[centre.id] ? `${programa.titols[centre.id]}, ` : ''}\"${ins.titol}\" (${ins.curs})`;\n              if (!centre.titols)\n                centre.titols = {};\n              centre.titols[programa.id] = `${centre.titols[programa.id] ? `${centre.titols[programa.id]}, ` : ''}\"${ins.titol}\" (${ins.curs})`;\n            }\n          }\n          else\n            console.log(`WARNING: Instància amb programa o centre desconegut: ${ins.programa} - ${ins.centre} - ${ins.curs}`);\n        });\n\n        // Build the Fuse.js objects\n        // See: https://fusejs.io/\n        const fuseOptions = {\n          caseSensitive: false,\n          shouldSort: true,\n          tokenize: true,\n          matchAllTokens: true,\n          includeScore: true,\n          includeMatches: true,\n          threshold: 0.3,\n          location: 0,\n          distance: 4,\n          maxPatternLength: 32,\n          minMatchCharLength: 2,\n        };\n\n        const fuseFuncs = [\n          new Fuse(\n            _programes.map(({ id, nom, descripcio, titols, ambCurr, ambInn, arees, objectius, requisits, compromisos, contacte, normativa }) => ({\n              id,\n              nom,\n              descripcio,\n              titols: titols ? Object.values(titols).join(', ') : '',\n              ambCurr: ambCurr.map(a => _estudis.ambitsCurr[a]).join(', '),\n              ambInn: ambCurr.map(a => _estudis.ambitsInn[a]).join(', '),\n              arees: arees.join(', '),\n              objectius,\n              requisits,\n              compromisos,\n              contacte,\n              normativa,\n              tipus: 'programa',\n            })),\n            { ...fuseOptions, keys: ['id', 'nom', 'descripcio', 'titols', 'ambCurr', 'ambInn', 'arees', 'objectius', 'requisits', 'compromisos', 'contacte', 'normativa'] }),\n          new Fuse(\n            _centres.map(({ id, nom, municipi, comarca, titols }) => ({\n              id,\n              nom: `${nom} (${municipi})`,\n              comarca,\n              titols: titols ? Object.values(titols).join(', ') : '',\n              tipus: 'centre',\n            })),\n            { ...fuseOptions, keys: ['id', 'nom', 'comarca', 'titols'] }),\n        ];\n\n        // Update main data object\n        const data = {\n          ...this.state.data,\n          programes,\n          centres,\n          poligons,\n          estudis: new Map(Object.entries(_estudis.estudis)),\n          nivells: new Map(Object.entries(_estudis.nivells)),\n          ambitsCurr: new Map(Object.entries(_estudis.ambitsCurr)),\n          ambitsInn: new Map(Object.entries(_estudis.ambitsInn)),\n          cursosDisp: _estudis.cursos,\n        };\n\n        //this.updateLayersDensity(currentPrograms, null, data);\n\n        // Update the main state\n        this.setStateMod({\n          data,\n          dataLoaded: true,\n          polygons: [\n            { name: 'Serveis Territorials', shapes: _poligons.filter(p => p.tipus === 'ST') },\n            { name: 'Serveis Educatius de Zona', shapes: _poligons.filter(p => p.tipus === 'SEZ') },\n          ],\n          cursos: [...data.cursosDisp],\n          fuseFuncs,\n          currentPrograms,\n          loading: false,\n          error: false,\n        });\n      })\n      .catch(error => {\n        // Something wrong happened!\n        console.log(error);\n        this.setStateMod({ error: error.toString() });\n      });\n  }\n\n  /**\n   * Miscellaneous operations to be performed at startup\n   */\n  componentDidMount() {\n    // Load Google's \"Roboto\" font\n    //Utils.loadGFont('Roboto');\n    Utils.loadGFont('Open Sans');\n    // Load datasets\n    this.loadData()\n      .then(() => {\n        this.checkForLayerUpdate(window.location.hash ? window.location.hash.substr(1) : '/');\n      });\n  }\n\n  /**\n   * Update the state of the main component, scrolling to new sections when needed\n   * @param {object} state - The new settings for `state`\n   * @param {boolean} mapChanged - `true` when this change involves map points\n   */\n  updateMap = (state = {}, mapChanged = true, currentProgramsChanged = false) => {\n    this.setStateMod({ ...state, mapChanged, currentProgramsChanged });\n    window.requestAnimationFrame(() => {\n      if (currentProgramsChanged)\n        this.updateLayersDensity(this.state.programa ? new Set([this.state.programa]) : this.state.currentPrograms, this.state.cursos);\n      if (mapChanged)\n        window.setTimeout(() => this.setStateMod({ mapChanged: false }), 0);\n    });\n  }\n\n  /**\n   * Called from CheckRouteChanges when a new path is entered\n   * @param {object} props - New properties used, including a react-route location object\n   * @param {object} prevProps - Old properties, used for checking changes\n   */\n  contentUpdated = (props, prevProps) => {\n    if (props.location.pathname !== prevProps.location.pathname) {\n      this.checkForLayerUpdate(props.location.pathname);\n      window.scrollTo(0, 0);\n    }\n  };\n\n  /**\n   * Checks if the polygons density needs to be recalculated, based on the current path\n   * @param {string} pathname - Current path\n   */\n  checkForLayerUpdate = (pathname) => {\n    if (/^\\/(programes|programa\\/|centre\\/|zona\\/)/.test(pathname)) {\n      const check = /^\\/programa\\/(.*)$/.exec(pathname);\n      const programa = check && check.length === 2 ? check[1] : null;\n      this.updateMap({ programa }, true, true);\n    }\n  };\n\n  /**\n   * Update the `density` value on each polygon, based on the number of schools enroled to\n   * the current programs among the total number of schools on the polygon having at least\n   * one of the educational levels targeted by at least one of the current programs.\n   * Values can also be filtered by school year.\n   * @param {Set} currentPrograms - Set with the `id`s of the programs to be included on the calculation\n   * @param {string[]=} cursos - School years to be considered. Defaults to _null_, meaning all available years.\n   * @param {object=} data - Object containing the current datasets. Defaults to `data` in the current state.\n   */\n  updateLayersDensity = (currentPrograms, cursos = null, data = this.state.data) => {\n\n    const { poligons, programes } = data;\n\n    // Clear base arrays\n    poligons.forEach(poli => {\n      // Clear current density\n      poli.density = MIN_DENSITY;\n\n      // `estudisBase` will be filled with the number of \"school groups\" involved in at least\n      // one of the current programs, where each \"school group\" is an educational level inside a school.\n      // key: educational level (EINF2C, EPRI...)      \n      // value: number of \"school groups\" of this educational level on this polygon\n      poli.estudisBase = {};\n\n      // `estudisPart` will be filled with the total number of \"school groups\" participating in at least\n      // one of the current programs, where each \"school group\" is an educational level inside a school.\n      // key: educational level (EINF2C, EPRI...)      \n      // value: number of \"school groups\" of this type participating in the current programs on this polygon\n      poli.estudisPart = {};\n\n      poli.centresPart = new Set();\n    });\n\n    // Object with all `centres` participating in current programs\n    // key: school id\n    // value: school\n    const currentCentres = {};\n\n    // For program, fill `estudisBase` and `currentCentres`\n    currentPrograms.forEach(pid => {\n      const program = programes.get(pid);\n      if (program && program.tipus.length && Object.keys(program.centres).length) {\n        program.tipus.forEach(t => {\n          poligons.forEach(poli => {\n            poli.estudisBase[t] = poli.centres[t] || 0;\n          });\n        });\n\n        Object.keys(program.centres).forEach(ce => {\n          if (!cursos || cursos.includes(ce)) {\n            program.centres[ce].forEach(centre => {\n              currentCentres[centre.id] = centre;\n            });\n          }\n        });\n      }\n    });\n\n    // For each school, fill `estudisPart` on their associated polygons (ST and SZ)\n    Object.values(currentCentres).forEach(centre => {\n      const st = poligons.get(centre.sstt);\n      const se = poligons.get(centre.se);\n      centre.estudis.forEach(tipus => {\n        if (st && st.estudisBase[tipus]) {\n          st.estudisPart[tipus] = (st.estudisPart[tipus] ? st.estudisPart[tipus] + 1 : 1);\n          st.centresPart.add(centre.id);\n        }\n        if (se && se.estudisBase[tipus]) {\n          se.estudisPart[tipus] = (se.estudisPart[tipus] ? se.estudisPart[tipus] + 1 : 1);\n          se.centresPart.add(centre.id);\n        }\n      });\n    });\n\n    // Finally, calculate the density of each polygon\n    // (ratio between the summations of `estudisPart` and `estudisBase`)\n    let maxDensityST = 0, maxDensitySE = 0;\n    poligons.forEach(poli => {\n      let n = 0, d = 0;\n      Object.keys(poli.estudisPart).forEach(tipus => {\n        if (poli.estudisBase[tipus]) {\n          n += poli.estudisPart[tipus];\n          d += poli.estudisBase[tipus];\n        }\n      });\n      if (d > 0) {\n        poli.density = n / d;\n        if (poli.tipus === 'ST')\n          maxDensityST = Math.max(maxDensityST, poli.density);\n        else\n          maxDensitySE = Math.max(maxDensitySE, poli.density);\n      }\n    });\n\n    // Compute correction factors\n    const factorST = (maxDensityST > MIN_DENSITY && maxDensityST < MINMAX_DENSITY)\n      ? MINMAX_DENSITY / maxDensityST\n      : maxDensityST > MAX_DENSITY\n        ? MAX_DENSITY / maxDensityST\n        : 1;\n    const factorSE = (maxDensitySE > MIN_DENSITY && maxDensitySE < MINMAX_DENSITY)\n      ? MINMAX_DENSITY / maxDensitySE\n      : maxDensitySE > MAX_DENSITY\n        ? MAX_DENSITY / maxDensitySE\n        : 1;\n\n    // Apply correction factors\n    poligons.forEach(poli => poli.density *= (poli.tipus === 'ST' ? factorST : factorSE));\n  }\n\n  /**\n   * Builds the App main component\n   */\n  render() {\n\n    const { error, loading } = this.state;\n\n    return (\n      <Router basename={window.location.pathname}>\n        <CssBaseline>\n          <MuiThemeProvider theme={theme}>\n            <AppContext.Provider value={this.state}>\n              <CheckRouteChanges updateHandler={this.contentUpdated}>\n                <Header />\n                <div id=\"filler\" />\n                <main>\n                  {\n                    (loading && <Loading />) ||\n                    (error && <Error {...{ error, refetch: this.loadData }} />) ||\n                    (<>\n                      <Route exact path=\"/\" component={Presentacio} />\n                      <Route path=\"/programes\" component={Programes} />\n                      <Route path=\"/centre/:codi\" component={FitxaCentre} />\n                      <Route path=\"/programa/:id\" component={FitxaPrograma} />\n                      <Route path=\"/zona/:key\" component={FitxaZona} />\n                      <Route path=\"/cerca/:query\" component={Cerca} />\n                    </>\n                    )\n                  }\n                </main>\n                <Footer />\n              </CheckRouteChanges>\n            </AppContext.Provider>\n          </MuiThemeProvider>\n        </CssBaseline>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './main.css';\nimport '../node_modules/leaflet.markercluster/dist/MarkerCluster.css';\nimport '../node_modules/leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport '../node_modules/react-leaflet-fullscreen/dist/styles.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nserviceWorker.register();\n"],"sourceRoot":""}