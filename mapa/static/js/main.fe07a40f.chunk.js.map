{"version":3,"sources":["utils/CheckRouteChanges.js","utils/Utils.js","AppContext.js","components/SearchBar.js","components/Header.js","literals.js","components/Presentacio.js","utils/TileLayer.js","utils/MarkerClusterGroup.js","components/MainMap.js","components/MapaCentre.js","components/MapSection.js","components/SelectProgramsDlg.js","components/Programes.js","components/Error.js","components/FitxaPrograma.js","components/FitxaCentre.js","components/FitxaZona.js","components/FitxaProjecte.js","components/Loading.js","components/Footer.js","components/Cerca.js","App.js","serviceWorker.js","index.js"],"names":["CheckRouteChanges","props","_this","Object","classCallCheck","this","possibleConstructorReturn","getPrototypeOf","call","updateHandler","prevProps","children","React","Component","withRouter","handleFetchErrors","response","ok","Error","statusText","sumAll","obj","values","reduce","acc","v","cursCurt","curs","length","concat","substr","getInfoSpan","info","proj","centre","react_default","a","createElement","Fragment","map","_ref","n","titol","fitxa","video","key","react_router_dom","to","hasExtraInfo","find","inf","YOUTUBE_OPTIONS","entries","autoplay","cc_lang_pref","hl","fs","modestbranding","rel","e","join","VideoIframe","_ref2","url","_ref2$title","title","_ref2$width","width","_ref2$height","height","className","src","matches","exec","youTubeId","vimeoId","type","allowFullScreen","csvExport","data","fields","Parser","f","name","parse","item","result","field","id","csvExportToFile","fileName","blob","Blob","navigator","msSaveBlob","link","document","undefined","download","URL","createObjectURL","setAttribute","style","display","body","appendChild","click","removeChild","DEFAULT_DATA","programes","Map","centres","poligons","estudis","nivells","ambitsCurr","ambitsInn","cursosDisp","DEFAULT_STATE","loading","dataLoaded","error","polygons","currentPrograms","Set","programa","cursos","mapChanged","tabMode","currentTab","currentPrjTab","dlgOpen","updateMap","fuseFuncs","menuItems","AppContext","createContext","SearchBar","_ref$closeFn","closeFn","history","_ref$mini","mini","_React$useState","useState","_React$useState2","slicedToArray","searchText","setSearchText","search","ev","preventDefault","push","onSubmit","IconButton","color","aria-label","onClick","Search_default","TextField","value","InputProps","disableUnderline","onChange","target","Close_default","location","drawerOpened","setDrawerOpened","_React$useState3","_React$useState4","searchOpened","setSearchOpened","src_AppContext","Consumer","hasDrawer","searchFn","itemAction","path","forEach","mi","current","pathname","AppBar","position","Toolbar","disableGutters","Menu_default","href","components_SearchBar","Typography","variant","noWrap","role","Drawer","anchor","open","List","ListItem","component","divider","button","ListItemIcon","ChevronLeft_default","ListItemText","primary","intro","MD_OPTIONS","escapeHtml","Presentacio","Paper","with_html_default","Button","Array","from","p","alt","simbol","LAYERS","osm","attribution","mapbox","accessToken","process","wikimedia","minZoom","maxZoom","BUILT_LAYERS","getTileLayer","_ref$type","TileLayer","require","MarkerClusterGroup","_props$clusterProps","clusterProps","el","L","markerClusterGroup","objectSpread","contextValue","leaflet","layerContainer","MapLayer","withLeaflet","TILE_LAYER","PRESERVE_MAP_BOUNDS","MAP_BOUNDS","MAX_BOUNDS","MARKERCLUSTER_PROPS","showCoverageOnHover","maxClusterRadius","MainMap","_ref$points","points","_ref$polygons","_ref$estudis","_ref$programa","_ref$poli","poli","_ref$zoom","zoom","_ref$maxZoom","OVERLAYS","flag","default","OVERLAY_SETTINGS_STORAGE","window","localStorage","getBool","getItem","setVal","val","setItem","MAP_BOUNDS_STORAGE","sessionStorage","preserveBounds","currentlySavedBounds","str","split","Number","getSavedBounds","boundsChanged","bounds","getBounds","toBBoxString","overlayChange","ov","findIndex","overlayVisible","currentLayer","stored","popupZona","zona","centresPart","size","estudisPart","estudisBase","perCent","toFixed","Popup","nom","es_Map","assign","maxBounds","onBaseLayerChange","layerIndex","onOverlayAdd","onOverlayRemove","onZoomEnd","onMoveEnd","utils_TileLayer","LayersControl","i","BaseLayer","checked","tipus","LayerGroup","shapes","filter","sh","Polygon","positions","weight","fillOpacity","Overlay","density","utils_MarkerClusterGroup","pt","Marker","lat","lng","adreca","web","get","dist_default","titleCancel","MapaCentre","point","_ref$center","center","MapSection","_ref$data","singleCentre","w","innerWidth","addSchoolsOfProgram","progId","dest","prog","keys","includes","centresInn","has","c","Stepper","nonLinear","alternativeLabel","activeStep","k","Step","StepButton","completed","SelectProgramsDlg","ambitInn","setAmbitInn","ambitCurr","setAmbitCurr","_React$useState5","_React$useState6","nivellsChk","setNivellsChk","_React$useState7","_React$useState8","setCurrentPrograms","updateCurrentPrograms","progs","ambInn","ambCurr","nivell","tag","add","useMemo","listSelection","handle","closeDialog","Dialog","onEnter","aria-labelledby","classes","paper","DialogTitle","DialogContent","_ref4","FormControlLabel","control","Checkbox","defineProperty","label","FormControl","InputLabel","htmlFor","Select","inputProps","MenuItem","sort","DialogActions","Programes","_ref2$data","allSelected","handleProgClick","handleProgSelect","components_SelectProgramsDlg","Tabs","_ev","Tab","labelPlacement","_p","clear","_ref3","ListItemAvatar","Avatar","secondary","ListItemSecondaryAction","Switch","components_MapSection","refetch","ReportProblem_default","Refresh_default","goBack","ArrowBack_default","FITXA_BASE","EXPANDED_PROGS","MAX_EXPANSION_PANELS","createExpansionPanel","content","ExpansionPanel","ExpansionPanelSummary","expandIcon","ExpandMore_default","ExpansionPanelDetails","createMDExpansionPanel","mdContent","FitxaPrograma","match","params","fill","expandedPanels","setExpandedPanels","expandPanel","components_Error","descripcio","objectius","requisits","compromisos","contacte","normativa","arees","test","FileDocument_default","Info_default","Mail_default","t","hasNc","expanded","b","localeCompare","codi","municipi","notCert","nc","Divider","base","origin","num","nomCurt","exportData","CloudDownload_default","LOGO_BASE","FitxaCentre","comarca","logo","tel","mail","twitter","sstt","se","pb","servei_territorial","servei_educatiu","Web_default","Twitter_default","container","c1","c2","plainArray","nomCentre","FitxaZona","nomcurt","cp","fax","correu","programesArray","allCentres","numCentres","root","allPrograms","total","trim","replace","FITXA_PROJ_BASE","FitxaProjecte","_ref$match$params$id","infoGroup","infoIndex","_id$split","_id$split2","prg","projNum","isNaN","_info","_centre","codiCentre","_programa","idProg","nomProg","simbolProg","startsWith","icon","Youtube_default","Loading","CircularProgress","Footer","version","license","repository","DEFAULT_ITEMS_PER_PAGE","Cerca","_ref$match$params$que","query","page","setPage","itemsPerPage","setItemsPerPage","queryResults","setQueryResults","currentQuery","setCurrentQuery","qr","ff","goToElement","slice","_ref3$item","Group_default","MapMarker_default","TablePagination","spacer","toolbar","rowsPerPage","onChangeRowsPerPage","count","onChangePage","labelDisplayedRows","labelRowsPerPage","theme","responsiveFontSizes","createMuiTheme","palette","main","typography","fontFamily","overrides","MuiStepIcon","ReactGA","initialize","App","state","bind","assertThisInitialized","firstView","callback","arguments","setState","_this3","setStateMod","Promise","all","uri","fetch","method","credentials","then","json","_programes","_instancies","_centres","_poligons","_estudis","pts","vs","cert","cent","console","log","fuseOptions","caseSensitive","shouldSort","tokenize","matchAllTokens","includeScore","includeMatches","threshold","distance","maxPatternLength","minMatchCharLength","Fuse","infos","_ref5","toConsumableArray","catch","toString","tabs","matchMedia","_this4","fontName","weights","head","FontFaceObserver","load","documentElement","classList","toLowerCase","err","loadGFont","loadData","checkTabMode","addEventListener","setTimeout","checkForLayerUpdate","hash","_this5","currentProgramsChanged","requestAnimationFrame","updateLayersDensity","haveNewLocation","pageview","scrollTo","check","currentCentres","pid","program","ce","st","maxDensityST","maxDensitySE","d","Math","max","factorST","factorSE","_this$state","basename","ThemeProvider","CssBaseline","Provider","utils_CheckRouteChanges","contentUpdated","components_Header","components_Loading","react_router","exact","components_Footer","contextType","isLocalhost","Boolean","hostname","registerValidSW","swUrl","config","serviceWorker","register","registration","onupdatefound","installingWorker","installing","onstatechange","controller","onUpdate","onSuccess","ReactDOM","render","src_App","getElementById","indexOf","contentType","headers","status","ready","unregister","reload","checkValidServiceWorker"],"mappings":"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","file":"static/js/main.fe07a40f.chunk.js","sourcesContent":["import React from 'react';\nimport { withRouter } from 'react-router-dom';\n\n// Scroll to top on each router navigation\n// See: https://reacttraining.com/react-router/web/guides/scroll-restoration\nclass CheckRouteChanges extends React.Component {\n  constructor(props) {\n    super(props);\n    this.updateHandler = props.updateHandler;\n  }\n\n  componentDidUpdate(prevProps) {\n    if (this.updateHandler)\n      this.updateHandler(this.props, prevProps);\n  }\n\n  render() {\n    return this.props.children;\n  }\n}\n\nexport default withRouter(CheckRouteChanges);\n","// From: https://github.com/zeit/next.js/issues/512#issuecomment-322026199\n\nimport React from 'react';\nimport { Link } from 'react-router-dom';\nimport FontFaceObserver from 'fontfaceobserver';\nimport { Parser } from 'json2csv';\n\n/**\n * Asynchronous loading of Google fonts\n */\nexport function loadGFont(fontName = 'Roboto', weights = '300,400,500,600') {\n  const link = document.createElement('link');\n  link.href = `https://fonts.googleapis.com/css?family=${fontName}:${weights}`;\n  link.rel = 'stylesheet';\n\n  document.head.appendChild(link);\n  const fontLoader = new FontFaceObserver(fontName);\n  fontLoader.load()\n    .then(() => document.documentElement.classList.add(fontName.replace(' ', '-').toLowerCase()))\n    .catch(err => console.error(`Unable to load ${fontName} font due to: ${err}`));\n}\n\n/**\n * Handle errors on fetch calls\n * @param {Object} response \n */\nexport function handleFetchErrors(response) {\n  if (!response.ok)\n    throw Error(response.statusText || 'Error desconegut');\n  return response;\n}\n\n/**\n * Return the addition of all values in an object of type `{key: value, key: value, ...}` where all values are numbers.\n * @param {object} obj \n */\nexport function sumAll(obj) {\n  return Object.values(obj).reduce((acc, v) => acc + v, 0);\n}\n\n/**\n * Used in objects of type {curs1: [prog1, prog2, prog3, ...], curs2: [prog1, ...], ...}\n * Returns a single array of type: [{id: prog1.id, nom: prog1.nom, cursos: [curs1, curs2, ...]}, {id: prog2.id, nom: prog2.nom, cursos: [curs1, ...]}, ...]\n * @param {object} obj - Object structured as in the description\n * @returns {object[]} - The resulting array of objects of type 'program', with a 'cursos' field.\n */\nexport function plainArray(obj) {\n  const container = {};\n  Object.keys(obj).forEach(curs => {\n    obj[curs].forEach(prog => {\n      if (!container[prog.id]) {\n        container[prog.id] = {\n          id: prog.id,\n          nom: prog.nom,\n          simbol: prog.simbol,\n          cursos: [],\n        };\n      }\n      container[prog.id].cursos.push(curs);\n    });\n  });\n  return Object.values(container).sort((c1, c2) => c1.nom.localeCompare(c2.nom));\n}\n\n/**\n * Converts an expression of type '2015-2016' to '2015-16'\n */\nexport function cursCurt(curs) {\n  return curs.length === 9 ? `${curs.substr(0, 5)}${curs.substr(7, 2)}` : curs;\n}\n\n/**\n * Builds a `span` with all the information related to a specific project (titles, courses, cards. videos)\n * @param {Object} info - Array of objects with mandatory fields `titol` and `curs`, and optional fields `video` and `fitxa`\n * @returns {React.Component}\n */\nexport function getInfoSpan(info, proj, centre) {\n  return (\n    <>\n      {info.map(({ titol, fitxa, video, curs }, n) => {\n        return (\n          <span key={n}>\n            {(fitxa || video) ?\n              <span><Link to={`/projecte/${proj}|${centre}|${n}`}>{`\"${titol}\"`}</Link>{` (${curs})`}</span> :\n              <span>{`\"${titol}\" (${curs})`}</span>\n            }\n            {n < info.length - 1 && <span>, </span>}\n          </span>\n        );\n      })}\n    </>\n  );\n}\n\n/**\n * Checks if at least one of the elements of a \"info\" group has `fitxa` or `video`\n */\nexport function hasExtraInfo(info) {\n  return (info && info.find(inf => inf.fitxa || inf.video)) ? true : false;\n}\n\n/**\n * Options passed into YouTube embed URLs\n */\nconst YOUTUBE_OPTIONS = Object.entries({\n  autoplay: 0, // Don't automatically start the video\n  cc_lang_pref: 'ca', // Preferred language for captions\n  hl: 'ca', // Preferred language for interface\n  fs: 1, // Allow full screen\n  modestbranding: 1, // Reduced branding\n  rel: 0, // related videos (see https://developers.google.com/youtube/player_parameters#release_notes_08_23_2018)\n}).map((e) => `${e[0]}=${e[1]}`).join('&');\n\n/**\n * Generates an \"iframe\" with the provided url\n * When the url matches with a YouTube video player, an \"embed\" code is used instead.\n */\nexport function VideoIframe({ url, title = '', width = 800, height = 600, className }) {\n\n  let src = url || '';\n\n  // Check for YouTube\n  // See: https://stackoverflow.com/questions/18336873/regex-to-extract-youtube-video-id\n  let matches = /(youtu\\.be\\/|[?&]v=)([^&]+)/.exec(url);\n  if (matches && matches.length === 3) {\n    const youTubeId = matches[2];\n    src = `https://www.youtube.com/embed/${youTubeId}?${YOUTUBE_OPTIONS}`;\n  }\n  // Check for Vimeo\n  else {\n    matches = /vimeo\\.com\\/([\\d]+)$/.exec(url);\n    if(matches && matches.length === 2) {\n      const vimeoId = matches[1];\n      src = `https://player.vimeo.com/video/${vimeoId}`;\n    }\n  }\n\n  return (\n    <iframe\n      className={className}\n      title={title}\n      src={src}\n      width={width}\n      height={height}\n      type=\"text/html\"\n      allowFullScreen\n    />\n  );\n}\n\n/**\n * Generates a [json2csv](https://github.com/zemirco/json2csv) object\n * containing the data of all items and returns\n * a string with the full CSV file content.\n * @param {Object} data - The data object to be exported\n * @param {Object[]} fields - An array of objects with two string attributes:\n *                            * `name` (the field name to be included in the CSV file)\n *                            * `id` (the attribute name in `data`)\n * @returns {String}\n */\nexport function csvExport(data, fields) {\n  const parser = new Parser({ fields: fields.map(f => f.name) });\n  return parser.parse(data.map(item => {\n    return fields.reduce((result, field) => {\n      result[field.name] = item[field.id] || '';\n      return result;\n    }, {});\n  }));\n}\n\n/**\n * Generates a CSV file with the provided data\n * @param {string} fileName - The proposed file name\n * @param {Object} data - The data object to be exported\n * @param {Object[]} fields - An array of objects with two string attributes:\n *                            * `name` (the field name to be included in the CSV file)\n *                            * `id` (the attribute name in `data`)\n */\nexport function csvExportToFile(fileName, data, fields) {\n  const blob = new Blob(['\\uFEFF' + csvExport(data, fields)], { type: 'text/csv;charset=utf-16;' });\n  if (navigator.msSaveBlob) // IE 10+\n    navigator.msSaveBlob(blob, fileName);\n  else {\n    const link = document.createElement(\"a\");\n    if (link.download !== undefined) {\n      // feature detection\n      // Browsers that support HTML5 download attribute\n      var url = URL.createObjectURL(blob);\n      link.setAttribute(\"href\", url);\n      link.setAttribute(\"download\", fileName);\n      link.style.display = 'none';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n    }\n  }\n}\n\n","import React from 'react';\n\nexport const DEFAULT_DATA = {\n  programes: new Map(),\n  centres: new Map(),\n  poligons: new Map(),\n  estudis: new Map(),\n  nivells: new Map(),\n  ambitsCurr: new Map(),\n  ambitsInn: new Map(),\n  cursosDisp: [],\n};\n\nexport const DEFAULT_STATE = {\n  loading: true,\n  dataLoaded: false,\n  error: false,\n  polygons: [],\n  currentPrograms: new Set(),\n  programa: null,\n  cursos: [],\n  mapChanged: true,\n  tabMode: false,\n  currentTab: 0,\n  currentPrjTab: 0,\n  dlgOpen: false,\n  // Inmutable attributes\n  updateMap: () => null,\n  fuseFuncs: [],\n  menuItems: [],\n  data: DEFAULT_DATA,\n};\n\nconst AppContext = React.createContext(DEFAULT_STATE);\n\nexport default AppContext;\n","import React from 'react';\nimport TextField from '@material-ui/core/TextField';\nimport IconButton from '@material-ui/core/IconButton';\nimport CloseIcon from '@material-ui/icons/Close';\nimport SearchIcon from '@material-ui/icons/Search';\n\nfunction SearchBar({ closeFn = () => null, history, mini = false }) {\n\n  const [searchText, setSearchText] = React.useState('');\n  const search = (ev) => {\n    ev.preventDefault();\n    closeFn();\n    history.push(`/cerca/${searchText}`);\n    setSearchText('');\n  };\n\n  return (\n    <form\n      className=\"search-bar\"\n      onSubmit={search}>\n      <IconButton\n        className=\"search-btn\"\n        color=\"inherit\"\n        aria-label=\"Cerca\"\n        title=\"Cerca\"\n        onClick={search}\n      >\n        <SearchIcon />\n      </IconButton>\n      <TextField\n        aria-label=\"Cerca text...\"\n        title=\"Cerca text...\"\n        className=\"search-text\"\n        value={searchText}\n        InputProps={{ disableUnderline: true }}\n        onChange={ev => setSearchText(ev.target.value)}\n      />\n      {!mini &&\n        <IconButton\n          className=\"search-close\"\n          color=\"inherit\"\n          aria-label=\"Tanca\"\n          title=\"Tanca\"\n          onClick={closeFn}\n        >\n          <CloseIcon />\n        </IconButton>\n      }\n    </form>\n  );\n}\n\nexport default SearchBar;\n","import React from 'react';\nimport { withRouter } from 'react-router-dom';\nimport AppContext from '../AppContext';\nimport AppBar from '@material-ui/core/AppBar';\nimport ToolBar from '@material-ui/core/Toolbar';\nimport IconButton from '@material-ui/core/IconButton';\nimport MenuIcon from '@material-ui/icons/Menu';\nimport ChevronLeftIcon from '@material-ui/icons/ChevronLeft';\nimport SearchIcon from '@material-ui/icons/Search';\nimport Typography from '@material-ui/core/Typography';\nimport SearchBar from './SearchBar';\nimport Drawer from '@material-ui/core/Drawer';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\n\nfunction Header({ history, location }) {\n\n  const [drawerOpened, setDrawerOpened] = React.useState(false);\n  const [searchOpened, setSearchOpened] = React.useState(false);\n\n  return (\n    <AppContext.Consumer>\n      {({ menuItems, searchFn }) => {\n\n        const hasDrawer = menuItems && menuItems.length > 0;\n\n        const itemAction = (item) => () => {\n          setDrawerOpened(false);\n          if (item.path)\n            history.push(item.path);\n        }\n\n        menuItems.forEach(mi => mi.current = mi.path === location.pathname);\n\n        return (\n          <>\n            <AppBar\n              className=\"header\"\n              position=\"fixed\"\n            >\n              <ToolBar\n                disableGutters={true}\n              >\n                {hasDrawer &&\n                  <IconButton\n                    className=\"main-menu-button\"\n                    color=\"inherit\"\n                    aria-label=\"Seccions\"\n                    title=\"Seccions\"\n                    onClick={() => setDrawerOpened(true)}\n                  >\n                    <MenuIcon />\n                  </IconButton>\n                }\n                <div className=\"main-header-block\">\n                  <div className=\"top-bar\">\n                    <a className=\"logo-gencat\" href=\"https://web.gencat.cat/\" title=\"Generalitat de Catalunya\" target=\"_top\">gencat.cat</a>\n                    <SearchBar {...{ className: 'search-bar', history, mini: true }} />\n                  </div>\n                  <Typography className=\"main-title\" variant=\"h6\" color=\"inherit\" noWrap>\n                    Mapa de la innovaci pedaggica\n                </Typography>\n                  <ul className=\"nav-bar\">\n                    {menuItems.map(item => (\n                      <li key={item.id}>\n                        <div className=\"nav-label\" role=\"button\" current={item.current ? 'true' : 'false'} onClick={itemAction(item)}>{item.name}</div>\n                      </li>\n                    ))}\n                  </ul>\n                </div>\n                <IconButton\n                  className=\"search-btn-small\"\n                  color=\"inherit\"\n                  aria-label=\"Cerca\"\n                  title=\"Cerca\"\n                  onClick={() => setSearchOpened(!searchOpened)}\n                >\n                  <SearchIcon />\n                </IconButton>\n              </ToolBar>\n              {searchOpened && <SearchBar {...{ closeFn: () => setSearchOpened(false), history }} />}\n            </AppBar>\n            {\n              hasDrawer &&\n              <Drawer\n                variant=\"persistent\"\n                anchor=\"left\"\n                open={drawerOpened}\n              >\n                <List>\n                  <ListItem component=\"li\" divider button onClick={() => setDrawerOpened(false)}>\n                    <ListItemIcon>\n                      <ChevronLeftIcon />\n                    </ListItemIcon>\n                    <ListItemText primary=\"Tanca el men\" />\n                  </ListItem>\n                  {menuItems.map(item => (\n                    <ListItem component=\"li\" button key={item.id} onClick={itemAction(item)}>\n                      <ListItemText primary={item.name} />\n                    </ListItem>\n                  ))}\n                </List>\n              </Drawer>\n            }\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default withRouter(Header);\n","// Textos utilitzats a l'aplicaci\n\nexport const intro = `\n<img src=\"logos/portada.png\" style=\"max-width:100%;text-align:center;\" alt=\"Mapa de la innovaci pedaggica\" />\n\ns voluntat del Departament dEducaci acompanyar els centres educatius del pas en el procs de\ntransformaci educativa per donar resposta a les necessitats del segle XXI i reconixer els esforos\nque sestan fent en termes dinnovaci pedaggica.\n\nEl mapa de la innovaci pedaggica de Catalunya s un instrument que situa en el territori i\nvisibilitza totes les iniciatives vinculades a la innovaci i a la recerca educativa que es desenvolupa\nen els centres educatius i que han estat reconegudes pel Departament dEducaci des del 2015, dacord\namb el <a href=\"http://xtec.gencat.cat/ca/innovacio/\" target=\"_blank\" rel=\"noopener noreferrer\">Marc de la Innovaci Pedaggica de Catalunya</a>. \n\nAmb el mapa de la innovaci es pretn impulsar el treball en xarxa entre els centres que comparteixen\nobjectius al llarg del territori i posar en valor la informaci que faciliti la presa de decisions a\ntota la comunitat educativa, a ladministraci i a altres agents. Aquesta presa de decisions ha de\npermetre promoure la inclusi, la cohesi i lequitat, i facilitar la participaci de tots els centres\nen lxit educatiu i la innovaci per a la millora.\n\n`;\n\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport { intro } from '../literals';\n\nconst MD_OPTIONS = {\n  escapeHtml: false,\n};\n\nfunction Presentacio({ history }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data }) => {\n        return (\n          <section className=\"seccio presenta\">\n            <Paper className=\"paper\">\n              <ReactMarkdown {...MD_OPTIONS}>\n                {intro}\n              </ReactMarkdown>\n              <Button\n                className=\"close-intro-btn\"\n                variant=\"outlined\"\n                onClick={() => history.push('/programes')}\n              >Accs al mapa</Button>\n              <div className=\"hidden\">\n                { /* Preload icons in a hidden div */\n                  data.programes && Array.from(data.programes.values()).map((p, n) => (\n                    <img alt=\"\" key={n} src={`logos/${p.simbol}`} />\n                  ))\n                }\n              </div>\n            </Paper>\n          </section>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Presentacio;","import React from 'react';\nimport { TileLayer } from 'react-leaflet';\n\nconst LAYERS = {\n  // Original OpenStreetMap\n  osm: {\n    attribution: '&amp;copy <a href=\"http://osm.org/copyright\">OpenStreetMap</a> contributors',\n    url: 'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',\n  },\n  // Mapbox.com\n  // ATENCI: Max. 50.000 visualitzacions / mes\n  // Veure https://mapbox.com\n  // Provar amb id: `mapbox.satellite`, `mapbox.streets`...\n  mapbox: {\n    attribution: 'Dades del mapa  contribudors de <a href=\"https://www.openstreetmap.org/\">OpenStreetMap</a>, <a href=\"https://creativecommons.org/licenses/by-sa/2.0/\">CC-BY-SA</a>, Imatges  <a href=\"https://www.mapbox.com/\">Mapbox</a>',\n    url: 'https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}',\n    id: 'mapbox.streets',\n    accessToken: process.env.REACT_APP_MAPBOX_TOKEN || '',\n  },\n  // Wikimedia\n  wikimedia: {\n    attribution: '<a href=\"https://wikimediafoundation.org/wiki/Maps_Terms_of_Use\">Wikimedia</a>',\n    url: 'https://maps.wikimedia.org/osm-intl/{z}/{x}/{y}{r}.png',\n    minZoom: 1,\n    maxZoom: 19,\n  }\n};\n\nconst BUILT_LAYERS = {};\n\nfunction getTileLayer({ type = 'wikimedia' }) {\n  if (!BUILT_LAYERS[type])\n    BUILT_LAYERS[type] = <TileLayer {...LAYERS[type]} />\n  return BUILT_LAYERS[type];\n}\n\nexport default getTileLayer;\n","// Workaround to erors in `react-leaflet-markercluster`\n// From: https://github.com/YUzhva/react-leaflet-markercluster/issues/71#issuecomment-466393028\n\nimport { MapLayer, withLeaflet } from 'react-leaflet';\nimport L from 'leaflet';\nrequire('leaflet.markercluster');\n// Moved to `index.js`\n// import 'leaflet.markercluster/dist/MarkerCluster.css';\n// import 'leaflet.markercluster/dist/MarkerCluster.Default.css';\n\nclass MarkerClusterGroup extends MapLayer {\n\n  createLeafletElement(props) {\n    const { clusterProps = {} } = props;\n    const el = new L.markerClusterGroup({ ...props, ...clusterProps });\n    this.contextValue = {\n      ...props.leaflet,\n      layerContainer: el\n    };\n    return el;\n  }\n}\n\nexport default withLeaflet(MarkerClusterGroup);\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { Map, Polygon, Marker, Popup, LayersControl, LayerGroup } from 'react-leaflet';\nimport TileLayer from '../utils/TileLayer';\nimport MarkerClusterGroup from '../utils/MarkerClusterGroup';\n// Moved to `index.js`:\n// import 'react-leaflet-fullscreen/dist/styles.css';\nimport FullscreenControl from 'react-leaflet-fullscreen';\nimport { sumAll } from '../utils/Utils';\n\n// See ../utils/TileLayer for all available options\nconst TILE_LAYER = process.env.REACT_APP_TILE_LAYER || 'wikimedia';\nconst PRESERVE_MAP_BOUNDS = (process.env.REACT_APP_PRESERVE_MAP_BOUNDS || 'true') === 'true';\n\n// Enlarge map bounds to make space for popups\nconst MAP_BOUNDS = [[40.50, 0.15], [42.90, 3.34]];\nconst MAX_BOUNDS = [[39.50, -0.85], [43.90, 4.34]];\n\n// Options for MarkerCluster\n// See: https://github.com/Leaflet/Leaflet.markercluster\nconst MARKERCLUSTER_PROPS = {\n  showCoverageOnHover: false, // Default is `true`\n  maxClusterRadius: 30, // Default is 80\n};\n\nexport default function MainMap({ points = [], polygons = [], estudis = [], programa = null, poli = null, zoom = 8, maxZoom = 13, updateMap }) {\n\n  // Optional overlays\n  const OVERLAYS = [\n    {\n      name: 'Mostra la participaci per zones',\n      flag: 'showDensity',\n      default: false,\n    },\n    {\n      name: 'Mostra els centres',\n      flag: 'showCentres',\n      default: true,\n    },\n  ];\n\n  // Save overlay preferences to browser's local storage\n  const OVERLAY_SETTINGS_STORAGE = window.localStorage;\n  const getBool = key => OVERLAY_SETTINGS_STORAGE.getItem(key) === 'true';\n  const getInt = key => Number(OVERLAY_SETTINGS_STORAGE.getItem(key));\n  const setVal = (key, val) => OVERLAY_SETTINGS_STORAGE.setItem(key, val);\n\n  // Save the current map bounds in session storage, thus allowing to navigate between pages preserving map layout.\n  const MAP_BOUNDS_STORAGE = window.sessionStorage;\n  const saveBounds = (bounds) => MAP_BOUNDS_STORAGE.setItem('mapBounds', bounds.toBBoxString());\n  const getSavedBounds = () => {\n    const str = MAP_BOUNDS_STORAGE.getItem('mapBounds');\n    if (!str)\n      return null;\n    const values = str.split(',');\n    if (values.length !== 4)\n      return null;\n    return [[\n      Number(values[1]), // Lat SW\n      Number(values[0]), // Lng SW\n    ], [\n      Number(values[3]), // Lat NE\n      Number(values[2]), // Lng NE\n    ]];\n  };\n\n  // Don't preserve map bounds in `single polygon` mode\n  const preserveBounds = PRESERVE_MAP_BOUNDS && poli === null;\n  const currentlySavedBounds = preserveBounds && getSavedBounds();\n\n  // Handle zoom changes\n  const boundsChanged = ev => {\n    if (preserveBounds && ev.target && ev.target.getBounds)\n      saveBounds(ev.target.getBounds());\n  }\n\n  // Line width and opacity of polygons\n  const lineWidth = 2;\n  const minOpacity = 0;\n\n  // Force `updateMap` when changing some layout settings\n  const onBaseLayerChange = (ev) => {\n    const layerIndex = polygons.findIndex(p => p.name === ev.name);\n    if (layerIndex >= 0) {\n      setVal('currentLayer', layerIndex);\n      if (getBool(OVERLAYS[0].flag))\n        updateMap({}, false);\n    }\n  }\n\n  // Force `updateMap` when changing some overlay settings\n  const overlayChange = (type) => (ev) => {\n    const ov = OVERLAYS.findIndex(ov => ov.name === ev.name);\n    if (ov >= 0) {\n      const overlayVisible = (type === 'add');\n      OVERLAY_SETTINGS_STORAGE.setItem(OVERLAYS[ov].flag, overlayVisible);\n      if (ov === 0 && overlayVisible)\n        updateMap({}, false, false);\n    }\n  }\n\n  // Current layer defaults to \"SEZ\" (ndex 1)\n  const currentLayer = getInt('currentLayer');\n  setVal('currentLayer', currentLayer);\n\n  // Set default or stored value in each overlay\n  OVERLAYS.forEach(ov => {\n    const stored = OVERLAY_SETTINGS_STORAGE.getItem(ov.flag);\n    setVal(ov.flag, stored === null ? ov.default : stored);\n  });\n\n  const popupCentre = (centre) => (\n    <Popup>\n      <h4><Link to={`/centre/${centre.id}`}>{centre.nom}</Link></h4>\n      <p>{centre.adreca}<br />\n        <a href={centre.web} target=\"_blank\" rel=\"noopener noreferrer\">{centre.web}</a></p>\n      <p>{`${centre.estudis.map(e => estudis.get(e)).join(', ')}.`}</p>\n    </Popup>\n  );\n\n  const popupZona = (zona) => {\n    const centresPart = zona.centresPart.size;\n    const estudisPart = sumAll(zona.estudisPart);\n    const estudisBase = sumAll(zona.estudisBase);\n    const perCent = (estudisBase > 0 ? (estudisPart / estudisBase) * 100 : 0).toFixed(1);\n    return <Popup>\n      <h4><Link to={`/zona/${zona.key}`}>{zona.nom}</Link></h4>\n      {(centresPart &&\n        <p>\n          <span>{`Centres participants ${programa ? 'al programa seleccionat' : 'als programes seleccionats'}: ${centresPart}`}</span><br />\n          <span>{`ndex de participaci: ${perCent}%`}</span>\n        </p>) ||\n        <p>No hi ha cap centre que participi als programes seleccionats.</p>\n      }\n    </Popup>\n  };\n\n  return (\n    <Map\n      className=\"mapa markercluster-map\"\n      {...{\n        maxZoom,\n        minZoom: zoom,\n        bounds: (poli && poli.bounds) || currentlySavedBounds || MAP_BOUNDS,\n        maxBounds: MAX_BOUNDS,\n        onBaseLayerChange,\n        onOverlayAdd: overlayChange('add'),\n        onOverlayRemove: overlayChange('remove'),\n        onZoomEnd: boundsChanged,\n        onMoveEnd: boundsChanged,\n      }}\n    >\n      <TileLayer type={TILE_LAYER} />\n      <LayersControl position=\"topright\">\n        {polygons.map((p, i) => (\n          <LayersControl.BaseLayer name={p.name} key={i} checked={poli !== null ? i === (poli.tipus === 'SEZ' ? 1 : 0) : i === currentLayer}>\n            <LayerGroup>\n              {p.shapes.filter(sh => poli === null || poli === sh).map((sh, n) => (\n                <Polygon key={n} positions={sh.poligons} weight={lineWidth} fillOpacity={minOpacity}>\n                  {popupZona(sh)}\n                </Polygon>))}\n            </LayerGroup>\n          </LayersControl.BaseLayer>\n        ))}\n        <LayersControl.Overlay name={OVERLAYS[0].name} checked={poli === null && getBool(OVERLAYS[0].flag)}>\n          <LayerGroup>\n            {polygons[currentLayer].shapes.filter(sh => poli === null || poli === sh).map((sh, n) => (\n              <Polygon key={n} positions={sh.poligons} weight={0} fillOpacity={sh.density}>\n                {popupZona(sh)}\n              </Polygon>))}\n          </LayerGroup>\n        </LayersControl.Overlay>\n        <LayersControl.Overlay name={OVERLAYS[1].name} checked={poli !== null || getBool(OVERLAYS[1].flag)}>\n          <MarkerClusterGroup clusterProps={MARKERCLUSTER_PROPS}>\n            {points.map(pt => (\n              <Marker key={pt.id} position={[pt.lat, pt.lng]}>\n                {popupCentre(pt)}\n              </Marker>\n            ))}\n          </MarkerClusterGroup>\n        </LayersControl.Overlay>\n      </LayersControl>\n      <FullscreenControl\n        position=\"topleft\"\n        title=\"Mostra el mapa a pantalla completa\"\n        titleCancel=\"Surt de la pantalla completa\"\n      />\n    </Map>\n  )\n}\n","import React from 'react';\nimport { Map, Marker } from 'react-leaflet';\nimport TileLayer from '../utils/TileLayer';\n\n// See ../utils/TileLayer for all available options\nconst TILE_LAYER = process.env.REACT_APP_TILE_LAYER || 'wikimedia';\nconst MAP_BOUNDS = [[40.50, 0.15], [42.90, 3.34]];\n\nexport default function MapaCentre({ point, center = [41.7, 1.8], zoom = 8, maxZoom = 19 }) {\n\n  return (\n    <Map\n      className=\"mapa-centre\"\n      {...{ center, zoom, maxZoom, minZoom: 8, maxBounds: MAP_BOUNDS }}\n    >\n      <TileLayer type={TILE_LAYER} />\n      <Marker key={point.id} position={[point.lat, point.lng]} />\n    </Map>\n  )\n}","import React from 'react';\nimport Paper from '@material-ui/core/Paper';\nimport MainMap from './MainMap';\nimport MapaCentre from './MapaCentre';\nimport Stepper from '@material-ui/core/Stepper';\nimport Step from '@material-ui/core/Step';\nimport StepButton from '@material-ui/core/StepButton';\nimport { cursCurt } from '../utils/Utils';\n\nfunction MapSection({ data: { programes, centres, poligons, estudis, cursosDisp }, programa, centre, zona, cursos, currentPrograms, polygons, mapChanged, updateMap }) {\n\n  const singleCentre = centre ? centres.get(centre) : null;\n  const poli = zona ? poligons.get(zona) : null;\n  const w = window.innerWidth;\n  const zoom = w < 600 ? 7 : w < 820 ? 8 : w < 1300 ? 7 : 8;\n\n  const addSchoolsOfProgram = (progId, dest) => {\n    const prog = programes.get(progId);\n    if (prog)\n      Object.keys(prog.centres).forEach(curs => {\n        if (!cursos || cursos.includes(curs))\n          prog.centres[curs].forEach(centre => {\n            if ((!poli || poli.centresInn.has(centre)) && !dest.find(c => c.id === centre.id))\n              dest.push(centre)\n          });\n      });\n    return dest;\n  };\n\n  const points = [];\n  if (!mapChanged) {\n    if (singleCentre) {\n      points.push(singleCentre);\n    }\n    else if (programa)\n      addSchoolsOfProgram(programa, points);\n    else\n      currentPrograms.forEach(progId => addSchoolsOfProgram(progId, points));\n  }\n\n  const handleSelectCurs = curs => ev => {\n    const result = [];\n    cursosDisp.forEach(c => {\n      if ((curs === c && !cursos.includes(c)) || (curs !== c && cursos.includes(c)))\n        result.push(c);\n    });\n    updateMap({ cursos: result }, true, true);\n\n  }\n\n  return (\n    <section className=\"seccio smapa\">\n      <Paper className={singleCentre ? 'paper' : 'paper no-padding-top'}>\n        {(singleCentre &&\n          <MapaCentre\n            {...{\n              point: singleCentre,\n              center: [singleCentre.lat, singleCentre.lng],\n              zoom: 15,\n              maxZoom: 19,\n            }}\n          />) ||\n          <>\n            <Stepper\n              className=\"cursos\"\n              nonLinear\n              alternativeLabel\n              activeStep={null}\n            >\n              {cursosDisp.map((c, k) => (\n                <Step key={c}>\n                  <StepButton\n                    onClick={handleSelectCurs(c)}\n                    completed={cursos.includes(c)}\n                  >{cursCurt(c)}</StepButton>\n                </Step>\n              ))}\n            </Stepper>\n            <MainMap\n              {...{\n                points,\n                polygons,\n                programa,\n                poli,\n                zoom,\n                maxZoom: 19,\n                estudis,\n                updateMap\n              }}\n            />\n          </>\n        }\n      </Paper>\n    </section>\n  );\n}\n\nexport default MapSection;\n","import React from 'react';\n\nimport Button from '@material-ui/core/Button';\nimport Dialog from '@material-ui/core/Dialog';\nimport DialogActions from '@material-ui/core/DialogActions';\nimport DialogContent from '@material-ui/core/DialogContent';\nimport DialogTitle from '@material-ui/core/DialogTitle';\nimport FormControl from '@material-ui/core/FormControl';\nimport InputLabel from '@material-ui/core/InputLabel';\nimport Select from '@material-ui/core/Select';\nimport MenuItem from '@material-ui/core/MenuItem';\nimport Typography from '@material-ui/core/Typography';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\n\n\nfunction SelectProgramsDlg({ dlgOpen, data: { programes, ambitsCurr, ambitsInn, nivells }, updateMap }) {\n\n  const [ambitInn, setAmbitInn] = React.useState('');\n  const [ambitCurr, setAmbitCurr] = React.useState('');\n  const [nivellsChk, setNivellsChk] = React.useState(Array.from(nivells).reduce((v, [n]) => { v[n] = true; return v; }, {}));\n\n  // Better to user a react reducer?\n  const [currentPrograms, setCurrentPrograms] = React.useState(new Set());\n\n  const updateCurrentPrograms = () => {\n    const progs = new Set();\n    programes.forEach((prog, id) => {\n      if (\n        (ambitInn === '' || prog.ambInn.includes(ambitInn)) &&\n        (ambitCurr === '' || prog.ambCurr.includes(ambitCurr)) &&\n        Object.keys(nivellsChk).find(nivell => nivellsChk[nivell] && nivells.get(nivell).find(tag => prog.tipus.includes(tag)))\n      )\n        progs.add(id);\n    });\n    setCurrentPrograms(progs);\n    // TODO: Comptar centres!\n  };\n\n  React.useMemo(updateCurrentPrograms, [ambitInn, ambitCurr, nivellsChk]);\n\n  const listSelection = handle => ev => {\n    handle(ev.target.value);\n  };\n\n  const handleCheckNivell = n => ev => {\n    setNivellsChk({ ...nivellsChk, [n]: ev.target.checked });\n  };\n\n  const closeDialog = ok => ev => {\n    updateMap(Object.assign({ dlgOpen: false }, (ok && { currentPrograms }) || {}), true, ok);\n  };\n\n  return (\n    <Dialog\n      open={dlgOpen}\n      onEnter={updateCurrentPrograms}\n      aria-labelledby=\"dialog-title\"\n      classes={{ paper: 'stretch-dlg' }}\n    >\n      <DialogTitle id=\"dialog-title\">Tipus de programes</DialogTitle>\n      <DialogContent className=\"dialog-content\">\n        <div className=\"nivells\">\n          {Array.from(nivells).map(([nivell]) => (\n            <FormControlLabel\n              key={nivell}\n              className=\"select-nivell\"\n              control={\n                < Checkbox\n                  onChange={handleCheckNivell(nivell)}\n                  value={nivell}\n                  checked={nivellsChk[nivell]}\n                />}\n              label={nivell}\n            />\n          ))}\n        </div>\n        <FormControl className=\"select-list\">\n          <InputLabel htmlFor=\"select-ambit-curr\">mbit curricular</InputLabel>\n          <Select\n            value={ambitCurr}\n            onChange={listSelection(setAmbitCurr)}\n            inputProps={{\n              name: 'ambitCurr',\n              id: 'select-ambit-curr'\n            }}\n          >\n            <MenuItem value=\"\"><em>Tots els mbits</em></MenuItem>\n            {Array.from(ambitsCurr.keys()).sort().map(key => (\n              <MenuItem key={key} value={key}>{ambitsCurr.get(key)}</MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n\n        <FormControl className=\"select-list\">\n          <InputLabel htmlFor=\"select-ambit-inn\">mbit d'innovaci</InputLabel>\n          <Select\n            value={ambitInn}\n            onChange={listSelection(setAmbitInn)}\n            inputProps={{\n              name: 'ambitInn',\n              id: 'select-ambit-inn'\n            }}\n          >\n            <MenuItem value=\"\"><em>Tots els mbits</em></MenuItem>\n            {Array.from(ambitsInn.keys()).sort().map(key => (\n              <MenuItem key={key} value={key}>{ambitsInn.get(key)}</MenuItem>\n            ))}\n          </Select>\n        </FormControl>\n        <Typography className=\"info\">\n          {currentPrograms.size} {currentPrograms.size === 1 ? 'programa seleccionat' : 'programes seleccionats'}\n        </Typography>\n      </DialogContent>\n      <DialogActions>\n        <Button onClick={closeDialog(true)} color=\"primary\" >Aplica la selecci</Button>\n        <Button onClick={closeDialog(false)} color=\"primary\">Cancella</Button>\n      </DialogActions>\n\n    </Dialog>\n  );\n\n}\n\nexport default SelectProgramsDlg;\n","import React from 'react';\nimport AppContext from '../AppContext';\nimport MapSection from './MapSection';\nimport Paper from '@material-ui/core/Paper';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemSecondaryAction from '@material-ui/core/ListItemSecondaryAction';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Switch from '@material-ui/core/Switch';\nimport Avatar from '@material-ui/core/Avatar';\nimport Button from '@material-ui/core/Button';\nimport SelectProgramsDlg from './SelectProgramsDlg';\nimport Checkbox from '@material-ui/core/Checkbox';\nimport FormControlLabel from '@material-ui/core/FormControlLabel';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport { cursCurt } from '../utils/Utils';\n\nfunction Programes({ history }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data, data: { programes, ambitsCurr, ambitsInn, nivells }, cursos, currentPrograms, polygons, mapChanged, updateMap, tabMode, currentTab, dlgOpen }) => {\n        const allSelected = currentPrograms.size === programes.size;\n\n        // Click on program name\n        const handleProgClick = id => () => history.push(`/programa/${id}`);\n\n        // Select / Unselect program\n        const handleProgSelect = id => ev => {\n          currentPrograms[currentPrograms.has(id) ? 'delete' : 'add'](id);\n          updateMap({ currentPrograms, ambitCurr: '', ambitInn: '', nivell: '' }, true, true);\n        };\n\n        // Select / unselect all programs\n        const handleSelectAll = ev => {\n          if (ev.target.checked)\n            programes.forEach((_p, id) => currentPrograms.add(id));\n          else\n            currentPrograms.clear();\n          updateMap({ currentPrograms }, true, true);\n        };\n\n        const tabSelected = (_ev, value) => updateMap({ currentTab: value });\n\n        return (\n          <>\n            <SelectProgramsDlg {...{ dlgOpen, data: { programes, ambitsCurr, ambitsInn, nivells }, updateMap }} />\n            {tabMode &&\n              <Tabs\n                className=\"prog-tabs\"\n                value={currentTab}\n                onChange={tabSelected}\n                variant=\"fullWidth\"\n              >\n                <Tab label=\"Mapa\" />\n                <Tab label=\"Programes\" />\n              </Tabs>\n            }\n            {(!tabMode || currentTab === 1) &&\n              <section className={`seccio programes`}>\n                <Paper className=\"paper\">\n                  <div className=\"select-progs\">\n                    <Button variant=\"outlined\" color=\"primary\" onClick={() => updateMap({ dlgOpen: true })}>Selecciona per tipus</Button>\n                    <FormControlLabel\n                      className=\"select-all\"\n                      labelPlacement=\"start\"\n                      control={\n                        <Checkbox\n                          onChange={handleSelectAll}\n                          checked={allSelected}\n                        />}\n                      label=\"Selecciona'ls tots\"\n                    />\n                  </div>\n                  <List className=\"prog-list\">\n                    {Array.from(programes.values()).map(({ id, nom, simbol, centres }, n) => (\n                      <ListItem key={n} button className=\"list-button\">\n                        <ListItemAvatar>\n                          <Avatar src={`logos/mini/${simbol}`} alt={nom} />\n                        </ListItemAvatar>\n                        <ListItemText\n                          primary={nom}\n                          secondary={'Centres ' + Object.keys(centres).sort().map(k => `${cursCurt(k)}: ${centres[k].length}`).join(', ')}\n                          onClick={handleProgClick(id)} />\n                        <ListItemSecondaryAction>\n                          <Switch onChange={handleProgSelect(id)} checked={currentPrograms.has(id)} />\n                        </ListItemSecondaryAction>\n                      </ListItem>\n                    ))}\n                  </List>\n                </Paper>\n              </section>\n            }\n            {(!tabMode || currentTab === 0) &&\n              <MapSection {...{ data, programa: null, centre: null, zona: null, cursos, currentPrograms, polygons, mapChanged, updateMap }} />\n            }\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Programes;\n","import React from 'react';\nimport Button from '@material-ui/core/Button';\nimport Typography from '@material-ui/core/Typography';\nimport ReportProblem from '@material-ui/icons/ReportProblem';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport Refresh from '@material-ui/icons/Refresh';\n\nfunction Error({ error, history, refetch }) {\n  return (\n    <div className=\"err-msg\">\n      <Typography >\n        <ReportProblem className=\"err-icon\" color=\"secondary\" />\n        {error || 'Error desconegut!'}\n      </Typography>\n      {\n        (refetch &&\n          <Button\n            className='action-btn'\n            aria-label=\"Reintenta\"\n            onClick={refetch}\n            variant='outlined' >\n            <Refresh className=\"left-icon\" />\n            Reintenta\n        </Button>) ||\n        (history && history.length > 1 &&\n          <Button\n            className=\"action-btn\"\n            aria-label=\"Torna\"\n            variant=\"outlined\"\n            onClick={() => history.goBack()} >\n            <ArrowBack className=\"left-icon\" />\n            Torna\n        </Button>)\n      }\n    </div>\n  );\n}\n\nexport default Error;","import React from 'react';\nimport ReactMarkdown from 'react-markdown/with-html';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport Typography from '@material-ui/core/Typography';\nimport Divider from '@material-ui/core/Divider';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport DocumentIcon from 'mdi-material-ui/FileDocument';\nimport InfoIcon from '@material-ui/icons/Info';\nimport MailIcon from '@material-ui/icons/Mail';\nimport DownloadIcon from '@material-ui/icons/CloudDownload';\nimport Error from './Error';\nimport MapSection from './MapSection';\nimport { getInfoSpan, hasExtraInfo, csvExportToFile } from '../utils/Utils';\n\nconst FITXA_BASE = process.env.REACT_APP_FITXA_BASE || 'https://clic.xtec.cat/pub/fitxes/';\n\n// Programs with schools list expanded by default\nconst EXPANDED_PROGS = [\n  \"1001\" // \"Reconeixement de projectes d'innovaci pedaggica\"\n];\n\n// Maximum number of expected expansion panels (increase it if needed!)\nconst MAX_EXPANSION_PANELS = 25;\n\n// Options for React-Markdown\n// See: https://github.com/rexxars/react-markdown#options\nconst MD_OPTIONS = {\n  escapeHtml: false,\n};\n\n/**\n * Export the list of schools to a CSV spreadsheet\n */\nfunction exportData(programa) {\n\n  const { centres, info } = programa;\n\n  const fields = [\n    { name: 'CODI', id: 'codi' },\n    { name: 'CENTRE', id: 'centre' },\n    { name: 'CURS', id: 'curs' },\n    { name: 'PROGRAMA', id: 'programa' },\n  ];\n\n  if (info){\n    fields.push({ name: 'TITOL', id: 'titol' });\n    fields.push({ name: 'INFO', id: 'url' });\n  }\n\n  const base = `${window.location.origin}${window.location.pathname}#`;\n\n  const data = Object.keys(centres).reduce((result, curs) => {\n    centres[curs].forEach(centre => {\n      const inf = info && info[centre.id] && info[centre.id].find(i => i.curs === curs);\n      result.push({\n        centre: `${centre.nom} (${centre.municipi})`,\n        codi: centre.id,\n        curs,\n        programa: programa.nom,\n        titol: inf ? inf.titol : '',\n        url: inf ? `${base}/projecte/${programa.id}|${centre.id}|${inf.num || 0}` : '',\n      });\n    });\n    return result;\n  }, []);\n\n  return csvExportToFile(\n    `centres-${programa.nomCurt}.csv`,\n    data,\n    fields,\n  );\n}\n\n// Creates a Material-UI expansion panel with the provided title and content\nfunction createExpansionPanel(className, title, content) {\n  return (\n    <ExpansionPanel className={className}>\n      <ExpansionPanelSummary className=\"small-padding-h\" expandIcon={<ExpandMoreIcon />}>\n        <Typography variant=\"h6\">{title}</Typography>\n        {/*<h3 style={{ margin: 0 }}>{title}</h3>*/}\n      </ExpansionPanelSummary>\n      <ExpansionPanelDetails className=\"small-padding-h\">\n        {content}\n      </ExpansionPanelDetails>\n    </ExpansionPanel>\n  );\n}\n\n// Same as `createExpansionPanel`, but with Markdown content\nfunction createMDExpansionPanel(className, title, mdContent) {\n  return createExpansionPanel(className, title,\n    <div>\n      <ReactMarkdown {...MD_OPTIONS}>\n        {mdContent}\n      </ReactMarkdown>\n    </div>\n  );\n}\n\nfunction FitxaPrograma({ history, match: { params: { id } } }) {\n\n  const [expandedPanels, setExpandedPanels] = React.useState((new Array(MAX_EXPANSION_PANELS)).fill(EXPANDED_PROGS.includes(id), 0, 10));\n  const expandPanel = n => ev => {\n    setExpandedPanels(expandedPanels.map((p, i) => (i === n) ? !p : p));\n  }\n\n  return (\n    <AppContext.Consumer>\n      {({ data, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        const { programes, estudis, ambitsCurr, ambitsInn } = data;\n\n        // Find the specified program\n        const programa = programes.get(id);\n        if (!programa)\n          return <Error {...{ error: `No hi ha cap programa amb el codi: ${id}`, history }} />\n\n        // Deconstruct `programa`\n        const { nom, descripcio, link, ambCurr, ambInn, fitxa, video, objectius, requisits, compromisos, contacte, normativa, arees, simbol, tipus, centres } = programa;\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={() => history.goBack()} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio programa\">\n              <Paper className=\"paper\">\n                <div className=\"logo-nom-seccio\">\n                  {simbol && <img className=\"seccio-logo\" src={`logos/${simbol}`} alt={nom} />}\n                  <div className=\"nom-seccio\">\n                    <Typography variant=\"h4\">{nom}</Typography>\n                  </div>\n                </div>\n                <div id=\"descripcio\">\n                  <ReactMarkdown {...MD_OPTIONS}>\n                    {descripcio}\n                  </ReactMarkdown>\n                </div>\n                <div id=\"info\">\n                  {fitxa &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={`${/^http.?:\\/\\//.test(fitxa) ? '' : FITXA_BASE}${fitxa}`}\n                      title=\"Descarrega la fitxa del projecte\" >\n                      <DocumentIcon className=\"left-icon\" />\n                      Fitxa\n                    </Button>\n                  }\n                  {link &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={link}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title={link}>\n                      <InfoIcon className=\"left-icon\" />\n                      Web\n                    </Button>\n                  }\n                  {contacte &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={`mailto:${contacte}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title={contacte}>\n                      <MailIcon className=\"left-icon\" />\n                      Contacte\n                    </Button>\n                  }\n                  {video &&\n                    <div className=\"prog-video\">\n                      <br />\n                      <ReactMarkdown {...MD_OPTIONS}>\n                        {video}\n                      </ReactMarkdown>\n                    </div>\n                  }\n                </div>\n                {objectius && createMDExpansionPanel('prog-objectius', 'Objectius', objectius)}\n                {requisits && createMDExpansionPanel('prog-requisits', 'Requisits', requisits)}\n                {compromisos && createMDExpansionPanel('prog-compromisos', 'Compromisos', compromisos)}\n                {normativa && createMDExpansionPanel('prog-normativa', 'Normativa', normativa)}\n                {createExpansionPanel('prog-ambits', 'mbits, rees i nivells', (\n                  <div>\n                    {ambInn.length > 0 &&\n                      <div className=\"prog_ambits\">\n                        <h4>mbits d'innovaci:</h4>\n                        <ul>\n                          {ambInn.map(a => <li key={a}>{ambitsInn.get(a)}</li>)}\n                        </ul>\n                      </div>\n                    }\n                    {ambCurr.length > 0 &&\n                      <div className=\"prog_ambits\">\n                        <h4>mbits curriculars:</h4>\n                        <ul>\n                          {ambCurr.map(a => <li key={a}>{ambitsCurr.get(a)}</li>)}\n                        </ul>\n                      </div>\n                    }\n                    {arees.length > 0 &&\n                      <div className=\"prog_ambits\">\n                        <h4>rees curriculars:</h4>\n                        <ul>\n                          {arees.map((a, n) => <li key={n}>{a}</li>)}\n                        </ul>\n                      </div>\n                    }\n                    {tipus.length > 0 &&\n                      <div className=\"prog_ambits\">\n                        <h4>Nivells educatius:</h4>\n                        <ul>\n                          {tipus.map((t, n) => <li key={n}>{estudis.get(t)}</li>)}\n                        </ul>\n                      </div>\n                    }\n                  </div>\n                ))}\n                <br />\n                {Object.keys(centres).sort().map((curs, n) => {\n                  let hasNc = false;\n                  return (\n                    <ExpansionPanel key={n} expanded={expandedPanels[n]}>\n                      <ExpansionPanelSummary className=\"small-padding-h\" expandIcon={<ExpandMoreIcon />} onClick={expandPanel(n)}>\n                        <Typography className=\"wider\">{`CURS ${curs}`}</Typography>\n                        <Typography>{`${centres[curs].length} ${centres[curs].length === 1 ? 'centre' : 'centres'}`}</Typography>\n                      </ExpansionPanelSummary>\n                      {expandedPanels[n] &&\n                        <ExpansionPanelDetails className=\"small-padding-h flow-v\">\n                          <List className=\"wider\">\n                            {centres[curs].sort((a, b) => a.nom.localeCompare(b.nom)).map(({ id: codi, nom, municipi, info, notCert }, c) => {\n                              const link = (info && hasExtraInfo(info[id])) ? null : `#/centre/${codi}`;\n                              const nc = notCert.has(`${id}|${curs}`);\n                              hasNc = hasNc || nc;\n                              return (\n                                <ListItem key={c} button component={link ? 'a' : 'div'} href={link} className=\"small-padding-h\">\n                                  <ListItemText\n                                    primary={`${nom} (${municipi})${nc ? ' *' : ''}`}\n                                    secondary={info && info[id] && getInfoSpan(info[id], id, codi)}\n                                  />\n                                </ListItem>\n                              )\n                            }\n                            )}\n                          </List>\n                          {hasNc &&\n                            <>\n                              <Divider />\n                              <Typography className=\"padding-one\">*: Participaci en curs, pendent de certificar</Typography>\n                            </>\n                          }\n                        </ExpansionPanelDetails>\n                      }\n                    </ExpansionPanel>\n                  );\n                })}\n                <br />\n                <Button\n                  variant=\"contained\"\n                  className=\"csv-btn\"\n                  title='Descarrega la llista de centres en format CSV'\n                  onClick={() => exportData(programa)}\n                >\n                  <DownloadIcon className=\"left-icon\" />\n                  CSV\n                </Button>\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: id, centre: null, zona: null, cursos, currentPrograms, polygons, mapChanged, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaPrograma;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport ListItemAvatar from '@material-ui/core/ListItemAvatar';\nimport Avatar from '@material-ui/core/Avatar';\nimport Typography from '@material-ui/core/Typography';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport WebIcon from 'mdi-material-ui/Web';\nimport MailIcon from '@material-ui/icons/Mail';\nimport TwitterIcon from 'mdi-material-ui/Twitter';\nimport DownloadIcon from '@material-ui/icons/CloudDownload';\nimport { plainArray, getInfoSpan, hasExtraInfo, csvExportToFile } from '../utils/Utils';\nimport Error from './Error';\nimport MapSection from './MapSection';\n\nconst LOGO_BASE = process.env.REACT_APP_LOGO_BASE || 'https://clic.xtec.cat/pub/logos/';\n\n/**\n * Export the list of programs to a CSV spreadsheet\n */\nfunction exportData(centre) {\n  const { programes, info } = centre;\n\n  const fields = [\n    { name: 'CODI', id: 'codi' },\n    { name: 'CENTRE', id: 'centre' },\n    { name: 'CURS', id: 'curs' },\n    { name: 'PROGRAMA', id: 'programa' },\n    { name: 'INFO', id: 'url' }\n  ];\n\n  if (info)\n    fields.push({ name: 'TITOL', id: 'titol' });\n\n  const base = `${window.location.origin}${window.location.pathname}#`;\n  const nomCentre = `${centre.nom} (${centre.municipi})`;\n\n  const data = Object.keys(programes).reduce((result, curs) => {\n    programes[curs].forEach(prog => {\n      const inf = info && info[prog.id] && info[prog.id].find(i => i.curs === curs);\n      result.push({\n        centre: nomCentre,\n        codi: centre.id,\n        curs,\n        programa: prog.nom,\n        url: inf ? `${base}/projecte/${prog.id}|${centre.id}|${inf.num || 0}` : `${base}/programa/${prog.id}`,\n        titol: inf ? inf.titol : '',\n      });\n    });\n    return result;\n  }, []);\n\n  return csvExportToFile(\n    `programes-${centre.id}.csv`,\n    data,\n    fields,\n  );\n}\n\nfunction FitxaCentre({ history, match: { params: { codi } } }) {\n  return (\n    <AppContext.Consumer>\n      {({ data, currentPrograms, polygons, mapChanged, updateMap }) => {\n        // Find the specified program\n        const centre = data.centres.get(codi);\n        if (!centre)\n          return <Error {...{ error: `No hi ha cap programa amb el codi: ${codi}`, history }} />\n\n        const { nom, municipi, comarca, estudis, adreca, web, logo, tel, mail, twitter, sstt, se, pb, programes, info, notCert } = centre;\n        const tancaFitxa = () => history.goBack();\n        const servei_territorial = data.poligons.get(sstt);\n        const servei_educatiu = data.poligons.get(se);\n        let hasNc = false;\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={tancaFitxa} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio centre\">\n              <Paper className=\"paper\">\n                <div className=\"logo-nom-seccio\">\n                  {logo && <img className=\"seccio-logo\" src={`${/^http.?:\\/\\//.test(logo) ? '' : LOGO_BASE}${logo}`} alt={nom} />}\n                  <div className=\"nom-seccio\">\n                    <Typography variant=\"h4\">{nom}</Typography>\n                    <div id=\"tipus\">Centre {pb ? 'pblic' : 'privat concertat'}</div>\n                  </div>\n                </div>\n                <div className=\"adreca\">\n                  <p>\n                    {adreca}<br />\n                    {`${municipi} (${comarca})`}<br />\n                    {tel && <>{`Tel. ${tel}`}</>}\n                  </p>\n                </div>\n                <div id=\"info\">\n                  {web &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={web}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title={web}\n                    >\n                      <WebIcon className=\"left-icon\" />\n                      Web\n                    </Button>\n                  }\n                  {twitter &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={`https://twitter.com/${twitter}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title={twitter}\n                    >\n                      <TwitterIcon className=\"left-icon\" />\n                      Twitter\n                    </Button>\n                  }\n                  {mail &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={`mailto:${mail}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title={mail}\n                    >\n                      <MailIcon className=\"left-icon\" />\n                      Contacte\n                    </Button>\n                  }\n                </div>\n                <Typography variant=\"h6\">Estudis</Typography>\n                <ul>\n                  {estudis.map((e, n) => <li key={n}>{data.estudis.get(e)}</li>)}\n                </ul>\n                <Typography variant=\"h6\">Zones</Typography>\n                <ul>\n                  {servei_territorial && <li><Link to={`/zona/${sstt}`}>{servei_territorial.nom}</Link></li>}\n                  {servei_educatiu && <li><Link to={`/zona/${se}`}>{servei_educatiu.nom}</Link></li>}\n                </ul>\n                <br />\n                <Typography variant=\"h6\">Programes on participa</Typography>\n                <List >\n                  {plainArray(programes).map(({ id, nom, simbol, cursos }, n) => {\n                    const link = (info && hasExtraInfo(info[id])) ? null : `#/programa/${id}`;\n                    return (\n                      <ListItem key={n} button className=\"no-padding-h-small\" component={link ? 'a' : 'div'} href={link}>\n                        <ListItemAvatar>\n                          <Avatar src={`logos/mini/${simbol}`} alt={nom} />\n                        </ListItemAvatar>\n                        <ListItemText\n                          primary={nom}\n                          secondary={(info && info[id] && getInfoSpan(info[id], id, codi)) || `${cursos.length === 1 ? 'Curs' : 'Cursos'} ${cursos.sort().map(c => {\n                            const nc = notCert.has(`${id}|${c}`);\n                            hasNc = hasNc || nc;\n                            return `${c}${nc ? ' *' : ''}`;\n                          }).join(', ')}`}\n                        />\n                      </ListItem>\n                    );\n                  })}\n                </List>\n                {hasNc &&\n                  <>\n                    <br />\n                    <Typography>*: Participaci en curs, pendent de certificar</Typography>\n                  </>\n                }\n                <br />\n                <Button\n                  variant=\"contained\"\n                  className=\"csv-btn\"\n                  title='Descarrega la llista de programes en format CSV'\n                  onClick={() => exportData(centre)}\n                >\n                  <DownloadIcon className=\"left-icon\" />\n                  CSV\n                </Button>\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: codi, zona: null, currentPrograms, polygons, mapChanged, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaCentre;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport Avatar from '@material-ui/core/Avatar';\nimport WebIcon from 'mdi-material-ui/Web';\nimport MailIcon from '@material-ui/icons/Mail';\nimport Error from './Error';\nimport MapSection from './MapSection';\nimport Typography from '@material-ui/core/Typography';\nimport ExpansionPanel from '@material-ui/core/ExpansionPanel';\nimport ExpansionPanelSummary from '@material-ui/core/ExpansionPanelSummary';\nimport ExpansionPanelDetails from '@material-ui/core/ExpansionPanelDetails';\nimport ExpandMoreIcon from '@material-ui/icons/ExpandMore';\nimport DownloadIcon from '@material-ui/icons/CloudDownload';\nimport { getInfoSpan, hasExtraInfo, csvExportToFile } from '../utils/Utils';\n\n\n/**\n * Export the list of schools to a CSV spreadsheet\n */\nfunction exportData(programesArray, centresInn, nomcurt) {\n\n  const fields = [\n    { name: 'CODI', id: 'codi' },\n    { name: 'CENTRE', id: 'centre' },\n    { name: 'CURS', id: 'curs' },\n    { name: 'PROGRAMA', id: 'programa' },\n    { name: 'TITOL', id: 'titol' },\n    { name: 'INFO', id: 'url' },\n  ];\n\n  const base = `${window.location.origin}${window.location.pathname}#`;\n\n  const data = programesArray.reduce((total, programa) => {\n    const { centres, info } = programa;\n    return Object.keys(centres).reduce((result, curs) => {\n      centres[curs].filter(c => centresInn.has(c)).forEach(centre => {\n        const inf = info && info[centre.id] && info[centre.id].find(i => i.curs === curs);\n        result.push({\n          centre: `${centre.nom} (${centre.municipi})`,\n          codi: centre.id,\n          curs,\n          programa: programa.nom,\n          titol: inf ? inf.titol : '',\n          url: inf ? `${base}/projecte/${programa.id}|${centre.id}|${inf.num || 0}` : '',\n        });\n      });\n      return result;\n    }, total);\n  }, []);\n\n  return csvExportToFile(\n    `programes-${nomcurt.trim().replace(/ /g, '_')}.csv`,\n    data,\n    fields,\n  );\n}\n\n\nfunction FitxaZona({ history, match: { params: { key } } }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data, cursos, currentPrograms, polygons, mapChanged, updateMap }) => {\n        // Find the specified program\n        const zona = data.poligons.get(key);\n        if (!zona)\n          return <Error {...{ error: `No hi ha cap zona amb el codi: ${key}`, history }} />\n\n        // Els camps id, nomCurt i color no s'utilitzen\n        const { tipus, nom, nomcurt, logo, cp, adreca, municipi, comarca, tel, fax, correu, web, centresInn, programes } = zona;\n        const programesArray = Array.from(programes).sort((a, b) => a.nom.localeCompare(b.nom));\n\n        const torna = () => history.goBack();\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={torna} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio zona\">\n              <Paper className=\"paper\">\n                <div className=\"logo-nom-seccio\">\n                  {logo && <img className={`seccio-logo ${tipus === 'ST' ? '' : 'se-logo'}`} src={logo} alt={nom} />}\n                  <div className=\"nom-seccio\">\n                    <Typography variant=\"h4\">{nom}</Typography>\n                  </div>\n                </div>\n                <div className=\"adreca\">\n                  <p>\n                    {adreca}<br />\n                    {`${cp} ${municipi} (${comarca})`}<br />\n                    {tel && <>{`Tel. ${tel}`}<br /></>}\n                    {fax && <>{`Fax. ${fax}`}<br /></>}\n                  </p>\n                </div>\n                <div id=\"info\">\n                  {web &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={web}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title={web}\n                    >\n                      <WebIcon className=\"left-icon\" />\n                      Web\n                    </Button>\n                  }\n                  {correu &&\n                    <Button\n                      variant=\"contained\"\n                      className=\"info-btn\"\n                      href={`mailto:${correu}`}\n                      target=\"_blank\"\n                      rel=\"noopener noreferrer\"\n                      title={correu}\n                    >\n                      <MailIcon className=\"left-icon\" />\n                      Contacte\n                    </Button>\n                  }\n                </div>\n                <Typography variant=\"h6\">Programes amb presncia en aquest territori</Typography>\n                <br />\n                {programesArray.map((prog, n) => {\n                  const centres = prog.allCentres.filter(c => centresInn.has(c));\n                  const numCentres = centres.length;\n                  return (\n                    <ExpansionPanel key={n}>\n                      <ExpansionPanelSummary classes={{ root: 'small-padding-h', content: 'zona-prog' }} expandIcon={<ExpandMoreIcon />}>\n                        <Link className=\"zona-prog-logo\" to={`/programa/${prog.id}`}><Avatar src={`logos/mini/${prog.simbol}`} alt={prog.nom} /></Link>\n                        <Typography className=\"wider\">{prog.nom}</Typography>\n                        <Typography>{`${numCentres} centre${numCentres === 1 ? '' : 's'}`}</Typography>\n                      </ExpansionPanelSummary>\n                      <ExpansionPanelDetails className=\"small-padding-h\">\n                        <List>\n                          {centres.map(({ id, nom, municipi, info, allPrograms }, n) => {\n                            const link = (info && hasExtraInfo(info[prog.id])) ? null : `#/centre/${id}`;\n                            return (\n                              <ListItem key={n} button component={link ? 'a' : 'div'} href={link} className=\"small-padding-h\">\n                                <ListItemText\n                                  primary={`${nom} (${municipi})`}\n                                  secondary={info && info[prog.id] && getInfoSpan(info[prog.id], prog.id, id)}\n                                />\n                              </ListItem>\n                            );\n                          })}\n                        </List>\n                      </ExpansionPanelDetails>\n                    </ExpansionPanel>\n                  )\n                })}\n                <br />\n                <Button\n                  variant=\"contained\"\n                  className=\"csv-btn\"\n                  title='Descarrega la llista de programes i centres en format CSV'\n                  onClick={() => exportData(programesArray, centresInn, nomcurt)}\n                >\n                  <DownloadIcon className=\"left-icon\" />\n                  CSV\n                </Button>\n\n              </Paper>\n            </section>\n            <MapSection {...{ data, programa: null, centre: null, zona: key, cursos, currentPrograms, polygons, mapChanged, updateMap }} />\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default FitxaZona;\n","import React from 'react';\nimport { Link } from 'react-router-dom';\nimport { VideoIframe } from '../utils/Utils';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport Error from './Error';\nimport Typography from '@material-ui/core/Typography';\nimport Tabs from '@material-ui/core/Tabs';\nimport Tab from '@material-ui/core/Tab';\nimport DocumentIcon from 'mdi-material-ui/FileDocument';\nimport VideoIcon from 'mdi-material-ui/Youtube';\n\nconst LOGO_BASE = process.env.REACT_APP_LOGO_BASE || 'https://clic.xtec.cat/pub/logos/';\nconst FITXA_PROJ_BASE = process.env.REACT_APP_FITXA_PROJ_BASE || 'https://clic.xtec.cat/pub/projectes/';\n\nfunction FitxaProjecte({ history, match: { params: { id = '' } } }) {\n\n  return (\n    <AppContext.Consumer>\n      {({ data, currentPrjTab, updateMap }) => {\n        const { programes, centres } = data;\n\n        // Find the specified project\n        const [prg, codi, projNum] = id.split('|');\n        let programa, centre, infoGroup, infoIndex, info;\n        if (\n          !prg || !codi || !projNum ||\n          isNaN(infoIndex = Number(projNum)) ||\n          !(programa = programes.get(prg)) ||\n          !(centre = centres.get(codi)) ||\n          !(infoGroup = programa.info[codi]) ||\n          (infoGroup.length <= infoIndex) ||\n          !(info = infoGroup[infoIndex])\n        )\n          return <Error {...{ error: `No hi ha cap projecte amb el codi \"${id}\"`, history }} />\n\n        // Deconstruct main objects\n        const { titol, fitxa, video, curs } = info;\n        const { id: codiCentre, nom: nomCentre, municipi, logo } = centre;\n        const { id: idProg, nom: nomProg, simbol: simbolProg } = programa;\n\n        // Check if tabs are needed\n        const tabMode = (fitxa ? true : false) && (video ? true : false);\n        const tabSelected = (_ev, value) => updateMap({ currentPrjTab: value });\n\n        return (\n          <>\n            <Button className=\"torna\" aria-label=\"Torna\" onClick={() => history.goBack()} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio projecte\">\n              <Paper className=\"paper\">\n                <Typography variant=\"h4\">Projecte \"{titol}\"</Typography>\n                <div className=\"info-proj\">\n                  <img src={logo ? `${/^http.?:\\/\\//.test(logo) ? '' : LOGO_BASE}${logo}` : `logos/logo_${nomCentre.startsWith('Escola') ? 'cole' : 'insti'}.png`} alt={nomCentre} />\n                  <Typography variant=\"h6\"> <Link to={`/centre/${codiCentre}`}>{nomCentre}</Link><br />{municipi}</Typography>\n                  <img src={`logos/${simbolProg}`} alt={nomProg} />\n                  <Typography variant=\"h6\"> <Link to={`/programa/${idProg}`}>{nomProg}</Link><br />Curs {curs}</Typography>\n                </div>\n                <div className=\"proj-media\">\n                  {tabMode &&\n                    <Tabs\n                      className=\"proj-tabs\"\n                      value={currentPrjTab}\n                      onChange={tabSelected}\n                      variant=\"fullWidth\"\n                    >\n                      <Tab\n                        label=\"Video\"\n                        icon={<VideoIcon />}\n                      />\n                      <Tab\n                        label=\"Fitxa\"\n                        icon={<DocumentIcon />}\n                      />\n                    </Tabs>\n                  }\n                  {video && (!tabMode || currentPrjTab === 0) &&\n                    <VideoIframe\n                      className=\"proj-video\"\n                      title=\"Vdeo del projecte\"\n                      url={video}\n                    />\n                  }\n                  {fitxa && (!tabMode || currentPrjTab === 1) &&\n                    <iframe\n                      className=\"proj-pdf\"\n                      title=\"Fitxa del projecte\"\n                      src={`${/^https?:\\/\\//.test(fitxa) ? '' : FITXA_PROJ_BASE}${fitxa}`}\n                      width=\"100%\"\n                      height=\"100%\"\n                      type=\"application/pdf\"\n                      allowFullScreen\n                    />\n                  }\n                </div>\n              </Paper>\n            </section>\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n\n}\n\nexport default FitxaProjecte;","import React from 'react';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport Typography from '@material-ui/core/Typography';\n\n/**\n * Basic 'loading data...' page\n */\nfunction Loading() {\n  return (\n    <div className='err-msg'>\n      <Typography>S'estan carregant les dades...</Typography>\n      <CircularProgress className='progress' />\n    </div>\n  );\n}\n\nexport default Loading;\n","import React from 'react';\nimport Typography from '@material-ui/core/Typography';\nimport { title, version, repository, license } from '../../package.json';\n\nfunction Footer() {\n  return (\n    <footer>\n      <div className=\"footer-content\">\n        <a className=\"logo-gencat\" href=\"https://web.gencat.cat/\" title=\"Generalitat de Catalunya\" target=\"_top\">gencat.cat</a>\n        <Typography variant=\"body2\" className=\"copyright\">\n          <a href=\"https://innovacio.xtec.cat/\">{title} v{version}</a><br />\n          <a href=\"http://www.xtec.cat\"> 2019 Departament d'Educaci de la Generalitat de Catalunya</a><br />\n          <a href={`https://spdx.org/licenses/${license}.html`}>Llicncia Pblica de la Uni Europea {license}</a><br />\n          <a href={repository.url}>{repository.url}</a><br />\n          <br />\n          <strong>Bstia de contacte</strong>: <a href=\"mailto:innovacio@xtec.cat\">innovacio@xtec.cat</a><br />\n          <br />\n          <a href=\"https://web.gencat.cat/ca/menu-ajuda/ajuda/avis_legal/\"><strong>Avs legal</strong></a>: Dacord amb larticle 17.1 de la Llei 19/2014, la Generalitat de Catalunya permet la reutilitzaci dels continguts i de les dades sempre que se'n citi la font i la data d'actualitzaci i que no es desnaturalitzi la informaci (article 8 de la Llei 37/2007) i tamb que no es contradigui amb una llicncia especfica.\n        </Typography>\n      </div>\n    </footer>\n  );\n}\n\nexport default Footer;","import React from 'react';\nimport AppContext from '../AppContext';\nimport Paper from '@material-ui/core/Paper';\nimport Button from '@material-ui/core/Button';\nimport ArrowBack from '@material-ui/icons/ArrowBack';\nimport Avatar from '@material-ui/core/Avatar';\nimport List from '@material-ui/core/List';\nimport ListItem from '@material-ui/core/ListItem';\nimport ListItemIcon from '@material-ui/core/ListItemIcon';\nimport ListItemText from '@material-ui/core/ListItemText';\nimport TablePagination from \"@material-ui/core/TablePagination\";\nimport ProgramIcon from '@material-ui/icons/Group';\nimport SchoolIcon from 'mdi-material-ui/MapMarker';\n\nconst DEFAULT_ITEMS_PER_PAGE = Number(process.env.REACT_APP_ITEMS_PER_PAGE || 25);\n\nfunction Cerca({ history, match: { params: { query = '' } } }) {\n\n  // Remove extra spaces\n  query = query.trim();\n  \n  const [page, setPage] = React.useState(0);\n  const [itemsPerPage, setItemsPerPage] = React.useState(DEFAULT_ITEMS_PER_PAGE);\n  const [queryResults, setQueryResults] = React.useState([]);\n  const [currentQuery, setCurrentQuery] = React.useState('');\n\n  return (\n    <AppContext.Consumer>\n      {({ fuseFuncs }) => {\n\n        if (query !== currentQuery) {\n          // Perform full text search using Fuse.js\n          // See `loadData` in App.js for details about how these functions are built\n          setCurrentQuery(query);\n          setQueryResults(fuseFuncs.reduce((qr, ff) => qr.concat(ff.search(query)), []));\n        }\n\n        const goToElement = (tipus, id) => ev => {\n          history.push(`/${tipus}/${id}`);\n        };\n\n        return (\n          <>\n            <Button\n              className=\"torna\"\n              aria-label=\"Torna\"\n              onClick={() => history.goBack()} >\n              <ArrowBack className=\"left-icon\" />\n              Torna\n            </Button>\n            <section className=\"seccio cerca\">\n              <Paper className=\"paper\">\n                <h2>Resultats de la cerca \"{currentQuery}\"</h2>\n                {(queryResults.length === 0 && <p>No s'ha trobat cap element concident amb el criteri de cerca!</p>) ||\n                  <div>\n                    <List component=\"ul\">\n                      {queryResults.slice(page * itemsPerPage, (page + 1) * itemsPerPage).map(({ item: { nom, id, tipus, simbol } }, n) => (\n                        <ListItem\n                          key={n}\n                          button\n                          onClick={goToElement(tipus, id)}\n                        >\n                          <ListItemIcon>\n                            {simbol ? <Avatar src={`logos/mini/${simbol}`} alt={nom} /> : tipus === 'programa' ? <ProgramIcon /> : <SchoolIcon />}\n                          </ListItemIcon>\n                          <ListItemText primary={nom} />\n                        </ListItem>\n                      ))}\n                    </List>\n                    <hr />\n                    <TablePagination\n                      classes={{ spacer: 'hidden', toolbar: 'wrap' }}\n                      component=\"nav\"\n                      page={page}\n                      rowsPerPage={itemsPerPage}\n                      onChangeRowsPerPage={ev => setItemsPerPage(ev.target.value)}\n                      count={queryResults.length}\n                      onChangePage={(ev, p) => setPage(p)}\n                      labelDisplayedRows={({ from, to, count }) => `Resultats ${from} al ${to} de ${count}`}\n                      labelRowsPerPage=\"Resultats per pgina:\"\n                    />\n                  </div>\n                }\n              </Paper>\n            </section>\n          </>\n        );\n      }}\n    </AppContext.Consumer>\n  );\n}\n\nexport default Cerca;","import React, { Component } from 'react';\nimport { HashRouter as Router, Route, Switch, Redirect } from 'react-router-dom';\nimport CheckRouteChanges from './utils/CheckRouteChanges';\nimport ReactGA from 'react-ga';\nimport CssBaseline from '@material-ui/core/CssBaseline';\nimport ThemeProvider from '@material-ui/styles/ThemeProvider';\nimport { createMuiTheme, responsiveFontSizes } from '@material-ui/core/styles';\nimport Fuse from 'fuse.js';\nimport { handleFetchErrors, loadGFont } from './utils/Utils';\nimport Header from './components/Header';\nimport Presentacio from './components/Presentacio';\nimport Programes from './components/Programes';\nimport FitxaPrograma from './components/FitxaPrograma';\nimport FitxaCentre from './components/FitxaCentre';\nimport FitxaZona from './components/FitxaZona';\nimport FitxaProjecte from './components/FitxaProjecte';\nimport Error from './components/Error';\nimport Loading from './components/Loading';\nimport Footer from './components/Footer';\nimport Cerca from './components/Cerca';\nimport AppContext, { DEFAULT_STATE } from './AppContext';\n\n/**\n * Miscellanous values taken from environment variables\n * and from files: `.env`, `.env.development` and `.env.production`\n */\n//const API_ROOT = process.env.REACT_APP_API_ROOT || '../api';\nconst MAX_DENSITY = process.env.REACT_APP_MAX_DENSITY || 0.8;\nconst MIN_DENSITY = process.env.REACT_APP_MIN_DENSITY || 0.000001;\nconst MINMAX_DENSITY = process.env.REACT_APP_MINMAX_DENSITY || 0.4;\nconst DEBUG_GLOBAL_VAR = process.env.REACT_APP_DEBUG_GLOBAL_VAR || '';\nconst ANALYTICS_UA = process.env.REACT_APP_ANALYTICS_UA || '';\n\n/**\n * Main Material-UI theme\n */\nconst theme = responsiveFontSizes(\n  createMuiTheme({\n    palette: {\n      // Gencat dark gray\n      primary: { main: '#333' },\n      // Gencat red\n      secondary: { main: '#c00000' },\n      // Material-UI red\n      error: { main: '#f44336' },\n    },\n    typography: {\n      fontFamily: '\"Open Sans\", Roboto, \"Helvetica Neue\", Arial, sans-serif',\n    },\n    overrides: {\n      MuiStepIcon: {\n        completed: {\n          color: '#c00000 !important',\n        }\n      }\n    },\n  })\n);\n\n/**\n * Initialize GA\n */\nif (ANALYTICS_UA)\n  ReactGA.initialize(ANALYTICS_UA);\n\n/**\n * Main React component\n */\nclass App extends Component {\n\n  static contextType = AppContext;\n\n  constructor() {\n    super();\n\n    // Main sections\n    this.menuItems = [\n      {\n        id: 'presenta',\n        name: 'Presentaci',\n        path: '/',\n      },\n      {\n        id: 'programes',\n        name: 'Programes',\n        path: '/programes',\n      },\n      {\n        id: 'projectes',\n        name: 'Projectes',\n        path: '/programa/1001',\n      },\n    ];\n\n    // Set the initial state\n    this.state = {\n      ...DEFAULT_STATE,\n      // Immutable attributes:\n      updateMap: this.updateMap.bind(this),\n      // Functions used to perform full-text search with Fuse.js on 'centres' and 'programes', built after loading\n      fuseFuncs: [],\n      menuItems: this.menuItems,\n    };\n\n    // Flag indicating that the first path should be reported to GA\n    this.firstView = true;\n  }\n\n  /**\n   * Should be called on all the updates of `this.state`\n   * @param {Object} values - The state values to be updated\n   * @param {Function=} callback - Optional callback method to be called immediatly after state is updated\n   */\n  setStateMod(values, callback = null) {\n    this.setState(values, () => {\n\n      // Global variable used to quickly inspect `this.state` on the debug console\n      // `REACT_APP_DEBUG_GLOBAL_VAR` should be set only in `.env.development`\n      if (DEBUG_GLOBAL_VAR)\n        window[DEBUG_GLOBAL_VAR] = this.state;\n\n      if (callback)\n        callback();\n    });\n  }\n\n  /**\n   * Load the datasets from JSON files and arrange internal variables\n   * @returns {Promise}\n   */\n  loadData() {\n    // Set the app in \"loading\" mode\n    this.setStateMod({ loading: true });\n\n    return Promise.all(\n      // Launch all fetch promises in parallel\n      [\n        'data/programes.json',\n        'data/instancies.json',\n        'data/centres.json',\n        'data/poligons.json',\n        'data/estudis.json',\n      ].map(uri => {\n        return fetch(uri, { method: 'GET', credentials: 'same-origin' })\n          .then(handleFetchErrors)\n          .then(response => response.json());\n      })\n    )\n      .then(([_programes, _instancies, _centres, _poligons, _estudis]) => {\n\n        // Build an object with centre ids as keys, useful for optimizing searches\n        _centres.forEach(c => {\n          c.programes = {};\n          c.allPrograms = new Set();\n          c.notCert = new Set();\n        });\n\n        // Convert synthetic multi-point expressions into arrays of co-ordinates suitable for leaflet polygons\n        _poligons.forEach(p => {\n          p.poligons = p.poligons.map(pts => pts.split(',').map(pt => pt.split('|').map(vs => Number(vs))));\n          p.centresInn = new Set();\n          p.programes = new Set();\n          p.density = MIN_DENSITY;\n          p.estudisBase = {};\n          p.estudisPart = {};\n          p.centresPart = new Set();\n        });\n\n        // Prepare sets for auto-detected data\n        const currentPrograms = new Set();\n\n        // Initialize transient properties\n        _programes.forEach(p => {\n          // Set all programs initially selected\n          currentPrograms.add(p.id);\n          // Initialize `centres` and `allCentres` (to be filled later)\n          p.centres = {};\n          p.allCentres = new Set();\n        });\n\n        // Convert arrays to maps\n        const centres = new Map(_centres.map(c => [c.id, c]));\n        const programes = new Map(_programes.map(p => [p.id, p]));\n        const poligons = new Map(_poligons.map(p => [p.key, p]));\n\n        // Initialize arrays of `centres` for each program, and `programa` for each centre, by `curs`\n        _instancies.forEach(({ programa, centre, curs, titol, cert, fitxa, video }) => {\n          const prog = programes.get(programa);\n          const cent = centres.get(centre);\n          if (prog && cent) {\n            (prog.centres[curs] = prog.centres[curs] || []).push(cent);\n            prog.allCentres.add(cent);\n            (cent.programes[curs] = cent.programes[curs] || []).push(prog);\n            cent.allPrograms.add(prog);\n            if (cent.sstt) {\n              const p = poligons.get(cent.sstt);\n              p.centresInn.add(cent);\n              p.programes.add(prog);\n            }\n            if (cent.se) {\n              const p = poligons.get(cent.se);\n              p.centresInn.add(cent);\n              p.programes.add(prog);\n            }\n            if (titol) {\n              const info = {\n                titol,\n                curs,\n              };\n              if (fitxa)\n                info.fitxa = fitxa;\n              if (video)\n                info.video = video;\n\n              if (!prog.info)\n                prog.info = {};\n              if (!prog.info[cent.id])\n                prog.info[cent.id] = [];\n              prog.info[cent.id].push(info);\n\n              if (!cent.info)\n                cent.info = {};\n              if (!cent.info[prog.id])\n                cent.info[prog.id] = [];\n              cent.info[prog.id].push(info);\n            }\n            if (!cert)\n              cent.notCert.add(`${programa}|${curs}`);\n          }\n          else\n            console.log(`WARNING: Instncia amb programa o centre desconegut: ${programa} - ${centre} - ${curs}`);\n        });\n\n        // Summarize and put in order programs and schools\n        centres.forEach(c => {\n          c.allPrograms = Array.from(c.allPrograms).sort((a, b) => a.nom.localeCompare(b.nom));\n        });\n        programes.forEach(p => {\n          p.allCentres = Array.from(p.allCentres).sort((a, b) => a.nom.localeCompare(b.nom));\n        });\n\n        // Build the Fuse.js objects\n        // See: https://fusejs.io/\n        const fuseOptions = {\n          caseSensitive: false,\n          shouldSort: true,\n          tokenize: true,\n          matchAllTokens: true,\n          includeScore: true,\n          includeMatches: true,\n          threshold: 0.3,\n          location: 0,\n          distance: 4,\n          maxPatternLength: 32,\n          minMatchCharLength: 2,\n        };\n\n        const fuseFuncs = [\n          new Fuse(\n            _programes.map(({ id, nom, simbol, descripcio, info, ambCurr, ambInn, arees, objectius, requisits, compromisos, contacte, normativa }) => ({\n              id,\n              nom,\n              simbol,\n              descripcio,\n              info: info ? Object.values(info).map(infos => infos.map(inf => inf.titol)).join(', ') : '',\n              ambCurr: ambCurr.map(a => _estudis.ambitsCurr[a]).join(', '),\n              ambInn: ambInn.map(a => _estudis.ambitsInn[a]).join(', '),\n              arees: arees.join(', '),\n              objectius,\n              requisits,\n              compromisos,\n              contacte,\n              normativa,\n              tipus: 'programa',\n            })),\n            { ...fuseOptions, keys: ['id', 'nom', 'descripcio', 'info', 'ambCurr', 'ambInn', 'arees', 'objectius', 'requisits', 'compromisos', 'contacte', 'normativa'] }),\n          new Fuse(\n            _centres.map(({ id, nom, municipi, comarca, info }) => ({\n              id,\n              nom: `${nom} (${municipi})`,\n              comarca,\n              info: info ? Object.values(info).map(infos => infos.map(inf => inf.titol)).join(', ') : '',\n              tipus: 'centre',\n            })),\n            { ...fuseOptions, keys: ['id', 'nom', 'comarca', 'info'] }),\n        ];\n\n        // Build the main `data` object\n        const data = {\n          ...this.state.data,\n          programes,\n          centres,\n          poligons,\n          estudis: new Map(Object.entries(_estudis.estudis)),\n          nivells: new Map(Object.entries(_estudis.nivells)),\n          ambitsCurr: new Map(Object.entries(_estudis.ambitsCurr)),\n          ambitsInn: new Map(Object.entries(_estudis.ambitsInn)),\n          cursosDisp: _estudis.cursos,\n        };\n\n        // Update the main state\n        this.setStateMod({\n          data,\n          dataLoaded: true,\n          polygons: [\n            { name: 'Serveis Territorials', shapes: _poligons.filter(p => p.tipus === 'ST') },\n            { name: 'Serveis Educatius de Zona', shapes: _poligons.filter(p => p.tipus === 'SEZ') },\n          ],\n          cursos: [...data.cursosDisp],\n          fuseFuncs,\n          currentPrograms,\n          loading: false,\n          error: false,\n        });\n      })\n      .catch(error => {\n        // Something wrong happened!\n        console.log(error);\n        this.setStateMod({ error: error.toString() });\n      });\n  }\n\n  /**\n   * Checks if the content of the main page should be arranged in two tabs instead of two colums.\n   * This should be done when the display width is below 840px.\n   * @return {boolean} - `true` when in \"tabs\" mode\n   */\n  checkTabMode() {\n    const tabs = window.matchMedia('(max-width: 840px)').matches;\n\n    // Update state and map when tabs mode changes\n    if (this.state.tabMode !== tabs)\n      this.updateMap({ tabMode: tabs });\n\n    return tabs;\n  }\n\n  /**\n   * Operations to be performed at startup\n   */\n  componentDidMount() {\n    // Load Google's \"Open Sans\" font\n    loadGFont('Open Sans');\n    // Load datasets\n    this.loadData()\n      .then(() => {\n        // Check if tabs should be used\n        this.checkTabMode();\n        // Check the tabs mode when window resizes\n        window.addEventListener('resize', this.checkTabMode.bind(this));\n        // Pseudo-asynchronous checking of map layers\n        window.setTimeout(() => {\n          this.checkForLayerUpdate(window.location.hash ? window.location.hash.substr(1) : '/');\n        }, 0);\n      });\n  }\n\n  /**\n   * Update the state of the main component and the maps\n   * @param {object} [state={}] - The new settings for `state`\n   * @param {boolean} [mapChanged=true] - `true` when this change involves map points\n   * @param {boolean} [currentProgramsChanged=false] - `true` when the list of current programs has changed\n   * @param {function} [callback] - Optional function to be called after state is changed\n   */\n  updateMap(state = {}, mapChanged = true, currentProgramsChanged = false, callback = null) {\n    // Update state\n    // The `mapChanged` flag will prevent LeafLet to place popup points on the map\n    this.setStateMod({ ...state, mapChanged, currentProgramsChanged }, callback);\n    // Pseudo-asyncronously update layers and map\n    window.requestAnimationFrame(() => {\n      if (currentProgramsChanged)\n        this.updateLayersDensity(this.state.programa ? new Set([this.state.programa]) : this.state.currentPrograms, this.state.cursos);\n      if (mapChanged)\n        // After the repainting of all components (timeout zero), refresh the map leaving the restriction to place points on it\n        window.setTimeout(() => this.setStateMod({ mapChanged: false }), 0);\n    });\n  }\n\n  /**\n   * Called from CheckRouteChanges when a new path is entered\n   * @param {object} props - New properties used, including a react-route location object\n   * @param {object} prevProps - Old properties, used for checking changes\n   */\n  contentUpdated(props, prevProps) {\n    // Check if there is a new pathname\n    const haveNewLocation = props.location.pathname !== prevProps.location.pathname;\n\n    // Report new path to GA\n    if (ANALYTICS_UA && (haveNewLocation || this.firstView)) {\n      this.firstView = false;\n      ReactGA.pageview(props.location.pathname);\n    }\n\n    // Check for layers to be updated and scroll to top of page\n    if (haveNewLocation) {\n      this.checkForLayerUpdate(props.location.pathname);\n      window.scrollTo(0, 0);\n    }\n  };\n\n  /**\n   * Check if the polygons density needs to be recalculated, based on the current path\n   * @param {string} pathname - Current path\n   */\n  checkForLayerUpdate(pathname) {\n    if (/^\\/(programes|programa\\/|centre\\/|zona\\/)/.test(pathname)) {\n      const check = /^\\/programa\\/(.*)$/.exec(pathname);\n      const programa = check && check.length === 2 ? check[1] : null;\n      this.updateMap({ programa }, true, true);\n    }\n  };\n\n  /**\n   * Update the `density` value on each polygon, based on the number of schools enroled to\n   * the current programs among the total number of schools on the polygon having at least\n   * one of the educational levels targeted by at least one of the current programs.\n   * Values can also be filtered by school year.\n   * @param {Set} currentPrograms - Set with the `id`s of the programs to be included on the calculation\n   * @param {string[]=} cursos - School years to be considered. Defaults to _null_, meaning all available years.\n   * @param {object=} data - Object containing the current datasets. Defaults to `data` in the current state.\n   */\n  updateLayersDensity(currentPrograms, cursos = null, data = this.state.data) {\n\n    // De-structure the needed fields of `data`\n    const { poligons, programes } = data;\n\n    // Clear base arrays\n    poligons.forEach(poli => {\n      // Clear current density\n      poli.density = MIN_DENSITY;\n\n      // `estudisBase` will be filled with the number of \"school groups\" involved in at least\n      // one of the current programs, where each \"school group\" is an educational level inside a school.\n      // key: educational level (EINF2C, EPRI...)      \n      // value: number of \"school groups\" of this educational level on this polygon\n      poli.estudisBase = {};\n\n      // `estudisPart` will be filled with the total number of \"school groups\" participating in at least\n      // one of the current programs, where each \"school group\" is an educational level inside a school.\n      // key: educational level (EINF2C, EPRI...)      \n      // value: number of \"school groups\" of this type participating in the current programs on this polygon\n      poli.estudisPart = {};\n\n      poli.centresPart = new Set();\n    });\n\n    // Object with all `centres` participating in current programs\n    // key: school id\n    // value: school\n    const currentCentres = {};\n\n    // For program, fill `estudisBase` and `currentCentres`\n    currentPrograms.forEach(pid => {\n      const program = programes.get(pid);\n      if (program && program.tipus.length && Object.keys(program.centres).length) {\n        program.tipus.forEach(t => {\n          poligons.forEach(poli => {\n            poli.estudisBase[t] = poli.centres[t] || 0;\n          });\n        });\n\n        Object.keys(program.centres).forEach(ce => {\n          if (!cursos || cursos.includes(ce)) {\n            program.centres[ce].forEach(centre => {\n              currentCentres[centre.id] = centre;\n            });\n          }\n        });\n      }\n    });\n\n    // For each school, fill `estudisPart` on their associated polygons (ST and SZ)\n    Object.values(currentCentres).forEach(centre => {\n      const st = poligons.get(centre.sstt);\n      const se = poligons.get(centre.se);\n      centre.estudis.forEach(tipus => {\n        if (st && st.estudisBase[tipus]) {\n          st.estudisPart[tipus] = (st.estudisPart[tipus] ? st.estudisPart[tipus] + 1 : 1);\n          st.centresPart.add(centre.id);\n        }\n        if (se && se.estudisBase[tipus]) {\n          se.estudisPart[tipus] = (se.estudisPart[tipus] ? se.estudisPart[tipus] + 1 : 1);\n          se.centresPart.add(centre.id);\n        }\n      });\n    });\n\n    // Calculate the density of each polygon\n    // (ratio between the summations of `estudisPart` and `estudisBase`)\n    let maxDensityST = 0, maxDensitySE = 0;\n    poligons.forEach(poli => {\n      let n = 0, d = 0;\n      Object.keys(poli.estudisBase).forEach(tipus => {\n        if (poli.estudisBase[tipus]) {\n          n += (poli.estudisPart[tipus] || 0);\n          d += poli.estudisBase[tipus];\n        }\n      });\n      if (d > 0) {\n        poli.density = Math.max(MIN_DENSITY, n / d);\n        if (poli.tipus === 'ST')\n          maxDensityST = Math.max(maxDensityST, poli.density);\n        else\n          maxDensitySE = Math.max(maxDensitySE, poli.density);\n      }\n    });\n\n    // Compute the correction factor for _Serveis Territorials_\n    const factorST = (maxDensityST > MIN_DENSITY && maxDensityST < MINMAX_DENSITY)\n      ? MINMAX_DENSITY / maxDensityST\n      : maxDensityST > MAX_DENSITY\n        ? MAX_DENSITY / maxDensityST\n        : 1;\n\n    // Compute the correction factor for _Serveis Educatius_\n    const factorSE = (maxDensitySE > MIN_DENSITY && maxDensitySE < MINMAX_DENSITY)\n      ? MINMAX_DENSITY / maxDensitySE\n      : maxDensitySE > MAX_DENSITY\n        ? MAX_DENSITY / maxDensitySE\n        : 1;\n\n    // Apply correction factors\n    poligons.forEach(poli => poli.density *= (poli.tipus === 'ST' ? factorST : factorSE));\n  }\n\n  /**\n   * Builds the App main component\n   */\n  render() {\n\n    // Take `error` and `loading` flags from `this.state`\n    const { error, loading } = this.state;\n\n    return (\n      <Router basename={window.location.pathname}>\n        <ThemeProvider theme={theme}>\n          <CssBaseline>\n            <AppContext.Provider value={this.state}>\n              <CheckRouteChanges updateHandler={this.contentUpdated.bind(this)}>\n                <Header />\n                <div className=\"filler\" />\n                <main>\n                  {\n                    (loading && <Loading />) ||\n                    (error && <Error {...{ error, refetch: this.loadData.bind(this) }} />) ||\n                    <Switch>\n                      <Route exact path=\"/\" component={Presentacio} />\n                      <Route path=\"/programes\" component={Programes} />\n                      <Route path=\"/centre/:codi\" component={FitxaCentre} />\n                      <Route path=\"/programa/:id\" component={FitxaPrograma} />\n                      <Route path=\"/projecte/:id\" component={FitxaProjecte} />\n                      <Route path=\"/zona/:key\" component={FitxaZona} />\n                      <Route path=\"/cerca/:query\" component={Cerca} />\n                      <Redirect to=\"/\" />\n                    </Switch>\n                  }\n                </main>\n                <Footer />\n              </CheckRouteChanges>\n            </AppContext.Provider>\n          </CssBaseline>\n        </ThemeProvider>\n      </Router>\n    );\n  }\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n  // [::1] is the IPv6 localhost address.\n  window.location.hostname === '[::1]' ||\n  // 127.0.0.1/8 is considered localhost for IPv4.\n  window.location.hostname.match(\n    /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n  )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      //const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js${window.location.search.indexOf('debug') >= 0 ? '?debug' : ''}`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n            'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\n// Register the valid SW\nfunction registerValidSW(swUrl, config) {\n  return navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './main.css';\nimport '../node_modules/leaflet.markercluster/dist/MarkerCluster.css';\nimport '../node_modules/leaflet.markercluster/dist/MarkerCluster.Default.css';\nimport '../node_modules/react-leaflet-fullscreen/dist/styles.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(<App />, document.getElementById('root'));\n\nserviceWorker.register();\n"],"sourceRoot":""}