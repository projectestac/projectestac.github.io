(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{137:function(e,t,a){e.exports=a(365)},142:function(e,t,a){},143:function(e,t,a){},365:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(18),c=a.n(l),o=(a(142),a(44)),i=a(22),s=a(21),u=(a(143),a(125)),d=a.n(u);var m=function(e){var t=e.urls,a=e.interval,l=Object(n.useState)(0),c=Object(s.a)(l,2),o=c[0],i=c[1];return window.setTimeout(function(){i((o+1)%t.length)},1e3*a),r.a.createElement("div",{className:"fullFrame"},r.a.createElement("iframe",{className:"pageView",name:"view",title:"Page view",allowFullScreen:"true",src:t[o],onLoad:function(){return window.scrollTo(0,0)}},r.a.createElement("p",null,"Your browser does not support iframes!")))},f=a(35),g=a(126),p=a.n(g),E=a(41),h=a.n(E),v=a(40),b=a.n(v),y=a(24),w=a.n(y),C=a(127),k=a.n(C);var O=function(){return r.a.createElement("div",{className:"waiting"},r.a.createElement("h4",null,"S'estan llegint les dades..."),r.a.createElement(k.a,{className:"wheel"}))},P=a(26),j=a.n(P),S=a(30),N=a.n(S),T=a(31),D=a.n(T),U=a(23),L=a.n(U),q=a(29),I=a.n(q),R=a(16),M=a.n(R);var A=function(e){var t=e.conf.categories,a=e.selectPostsByDateAndCategory,n=r.a.useState(!1),l=Object(s.a)(n,2),c=l[0],o=l[1];return r.a.createElement("div",null,r.a.createElement("h3",null,"Categories"),r.a.createElement(L.a,{control:r.a.createElement(I.a,{checked:c,onChange:function(){t.forEach(function(e){e.selected=!c}),a(),o(!c)}}),label:"Selecciona totes les categories"}),r.a.createElement(j.a,{className:"catList",component:"nav"},t.map(function(e,t){return r.a.createElement(N.a,{key:t,selected:e.selected,onClick:(n=e,function(){n.selected=!n.selected,n.selected||o(!1),a()})},r.a.createElement(D.a,null,r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.name}})));var n})),r.a.createElement(M.a,{variant:"body2"},t.filter(function(e){return e.selected}).length,"/",t.length," categories seleccionades"))};var B=function(e){var t=e.conf.tags,a=e.selectPostsByDateAndCategory,n=r.a.useState(!1),l=Object(s.a)(n,2),c=l[0],o=l[1],i=function(e){return function(){e.selected=!e.selected,e.selected||o(!1),a()}};return r.a.createElement("div",null,r.a.createElement("h3",null,"Etiquetes"),r.a.createElement(L.a,{control:r.a.createElement(I.a,{checked:c,onChange:function(){t.forEach(function(e){e.selected=!c}),a(),o(!c)}}),label:"Selecciona totes les etiquetes"}),r.a.createElement(j.a,{className:"catList",component:"nav"},t.map(function(e,t){return r.a.createElement(N.a,{key:t,selected:e.selected,onClick:i(e)},r.a.createElement(D.a,null,r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.name}})))})),r.a.createElement(M.a,{variant:"body2"},t.filter(function(e){return e.selected}).length,"/",t.length," etiquetes seleccionades"))};var _=function(e){var t=e.conf.posts,a=e.countUrls,n=r.a.useState(!1),l=Object(s.a)(n,2),c=l[0],o=l[1],i=function(e){return function(){e.selected=!e.selected,e.selected||o(!1),a()}};return r.a.createElement("div",null,r.a.createElement("h3",null,"Articles"),r.a.createElement(L.a,{control:r.a.createElement(I.a,{checked:c,onChange:function(){t.forEach(function(e){e.selected=!c}),a(),o(!c)}}),label:"Selecciona tots els articles"}),r.a.createElement(j.a,{component:"nav",className:"postList"},t.filter(function(e){return e.inRange}).map(function(e,t){return r.a.createElement(N.a,{key:t,selected:e.selected,onClick:i(e)},r.a.createElement(D.a,{primary:r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.title.rendered}}),secondary:e.modified.toLocaleString()}))})),r.a.createElement(M.a,{variant:"body2"},t.filter(function(e){return e.selected}).length,"/",t.filter(function(e){return e.inRange}).length," articles seleccionats"))};var F=function(e){var t=e.conf.pages,a=e.countUrls,n=r.a.useState(!1),l=Object(s.a)(n,2),c=l[0],o=l[1],i=function(e){return function(){e.selected=!e.selected,e.selected||o(!1),a()}};return r.a.createElement("div",null,r.a.createElement("h3",null,"P\xe0gines"),r.a.createElement(L.a,{control:r.a.createElement(I.a,{checked:c,onChange:function(){t.forEach(function(e){e.selected=!c}),a(),o(!c)}}),label:"Selecciona totes les p\xe0gines"}),r.a.createElement(j.a,{className:"pagesList",component:"nav"},t.filter(function(e){return e.inRange}).map(function(e,t){return r.a.createElement(N.a,{key:t,selected:e.selected,onClick:i(e)},r.a.createElement(D.a,{primary:r.a.createElement("span",{dangerouslySetInnerHTML:{__html:e.title.rendered}}),secondary:e.modified.toLocaleString()}))})),r.a.createElement(M.a,{variant:"body2"},t.filter(function(e){return e.inRange&&e.selected}).length,"/",t.filter(function(e){return e.inRange}).length," p\xe0gines seleccionades"))},W=a(129),Y=(a(291),a(59));var H=function(e){var t=e.conf,a=e.setConf,n=e.selectPostsByDateAndCategory,l=function(e){return function(r){var l="from"===e?r:t.dateFrom,c="to"===e?r:t.dateTo;l>c?a(Object(i.a)({},t,{err:"Error: La data inicial ha de ser anterior o igual a la final!"})):n(l,c)}};return r.a.createElement(Y.b,{utils:W.a,locale:"ca"},r.a.createElement("div",null,r.a.createElement("h3",null,"Interval de dates per als articles"),r.a.createElement(Y.a,{className:"date",keyboard:!0,label:"Data inicial",format:"DD/MM/YYYY",disableOpenOnEnter:!0,value:t.dateFrom,onChange:l("from")}),r.a.createElement(Y.a,{className:"date",keyboard:!0,label:"Data final",format:"DD/MM/YYYY",disableOpenOnEnter:!0,value:t.dateTo,onChange:l("to")})))},x=a(57),z=a.n(x),X=a(58),G=a.n(X);var J=function(e){var t=e.conf,a=e.setConf,n=function(e){a(Object(i.a)({},t,Object(f.a)({},e.target.id,!0===e.target.checked)))};return r.a.createElement("div",{className:"options"},r.a.createElement("h3",null,"Opcions de visualitzaci\xf3"),r.a.createElement("p",null,"Heu seleccionat ",t.numUrls," ",1===t.numUrls?"element":"elements"," per mostrar."),r.a.createElement(h.a,{id:"interval",label:"Temps entre p\xe0gines",className:"intervalInput",variant:"outlined",type:"number",value:t.interval,InputLabelProps:{shrink:!0},onChange:function(e){var n=e.target.value;n>0&&n<100&&a(Object(i.a)({},t,Object(f.a)({},e.target.id,n)))},InputProps:{endAdornment:r.a.createElement(z.a,{position:"end"},"Segons")}}),r.a.createElement(L.a,{control:r.a.createElement(G.a,{id:"randomOrder",checked:t.randomOrder,onChange:n}),label:"Mostra les p\xe0gines i els articles en ordre aleatori"}),r.a.createElement(L.a,{control:r.a.createElement(G.a,{id:"includeCategoryPages",checked:t.includeCategoryPages,onChange:n}),label:"Mostra les p\xe0gines de les categories (cursos, grups, seccions...)"}),r.a.createElement(L.a,{control:r.a.createElement(G.a,{id:"includeTagPages",checked:t.includeTagPages,onChange:n}),label:"Mostra les p\xe0gines de les etiquetes (projectes, activitats, campanyes...)'"}))};var V=function(e){var t=e.conf,a=e.setConf,n=e.checkSite,l=e.selectPostsByDateAndCategory,c=e.countUrls;return r.a.createElement(b.a,{className:"main"},r.a.createElement("div",{className:"sitePrompt"},r.a.createElement(h.a,{id:"wpSite",label:"URL del lloc web WordPress (bloc, Nodes...)",value:t.wpSite,onChange:function(e){return a(Object(i.a)({},t,Object(f.a)({},e.target.id,e.target.value)))},margin:"normal"}),r.a.createElement(w.a,{variant:"contained",color:"primary",onClick:n,disabled:!p.a.isURL(t.wpSite)},"Connecta")),t.loading&&r.a.createElement(O,null),t.err&&r.a.createElement("p",{className:"error"},"ERROR: ",t.err),t.posts&&r.a.createElement(H,{conf:t,setConf:a,selectPostsByDateAndCategory:l}),t.categories&&r.a.createElement(A,{conf:t,setConf:a,selectPostsByDateAndCategory:l}),t.tags&&r.a.createElement(B,{conf:t,setConf:a,selectPostsByDateAndCategory:l}),t.posts&&r.a.createElement(_,{conf:t,countUrls:c}),t.pages&&r.a.createElement(F,{conf:t,countUrls:c}),t.categories&&r.a.createElement(J,{conf:t,setConf:a}))},$=a(136),K=a.n($);var Q=function(){return r.a.createElement("header",{className:"head"},r.a.createElement("h2",null,r.a.createElement("img",{src:"ico/icon64.png",alt:"Logotip",className:"logo"}),"Carrusel d'articles WordPress"),r.a.createElement("p",null,"Aquesta aplicaci\xf3 permet mostrar de manera autom\xe0tica el contingut d'un lloc web que funcioni amb ",r.a.createElement("a",{href:"https://wordpress.org"},"WordPress"),", com ara XTEC-Blocs o \xc0gora-Nodes."),r.a.createElement("p",null,"Introdu\xefu l'URL del lloc web que vulgueu mostrar, espereu que es carreguin les dades (pot trigar una estona llarga!) i seleccioneu par\xe0metres com ara el rang de dates, les categories, les etiquetes o les p\xe0gines que vulgueu que es mostrin. Tamb\xe9 podeu marcar i desmarcar individualment cada un dels articles i p\xe0gines per indicar si han d'apar\xe8ixer al carrusel."),r.a.createElement("p",null,"Un cop seleccionat el contingut a mostrar indiqueu el temps d'espera entre una p\xe0gina i la seg\xfcent, aix\xed com si voleu que es mostrin les p\xe0gines a l'atzar o b\xe9 ordenades per data de publicaci\xf3. Finalment, feu clic al bot\xf3 \"Inicia la presentaci\xf3\" i veureu com les p\xe0gines aniran mostrant-se de manera autom\xe0tica a la finestra principal, que podeu posar en mode de pantalla completa amb la tecla ",r.a.createElement("strong",null,"F11"),"."))};var Z=function(){return r.a.createElement("footer",{className:"foot"},r.a.createElement("p",null,"\xa9 2019 Departament d'Educaci\xf3 de la Generalitat de Catalunya",r.a.createElement("br",null),"Codi font de l'aplicaci\xf3 disponible a ",r.a.createElement("a",{href:"https://github.com/projectestac/wp-show"},"GitHub")," sota els termes de la Llic\xe8ncia P\xfablica de la Uni\xf3 Europea EUPL v. 1.2"))};var ee=function(){var e=Object(n.useState)({wpSite:localStorage.getItem("wpSite")||"",interval:10,ready:!1,err:null,loading:!1,categories:null,tags:null,pages:null,posts:null,dateFrom:new Date,dateTo:new Date,includeCategoryPages:!0,includeTagPages:!1,randomOrder:!0,numUrls:0}),t=Object(s.a)(e,2),a=t[0],l=t[1],c=Object(n.useState)(!1),u=Object(s.a)(c,2),f=u[0],g=u[1],p=function e(t,a,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],l=arguments.length>4&&void 0!==arguments[4]?arguments[4]:100,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,i=arguments.length>6&&void 0!==arguments[6]?arguments[6]:1,s="".concat(t,"/wp-json/wp/v2/").concat(a,"/?page=").concat(++c,"&per_page=").concat(l,"&_envelope=1&").concat(n.map(function(e){return"_fields[]=".concat(e)}).join("&"));console.log("Fetching page ".concat(c,"/").concat(i," of ").concat(s));var u=function(){return c<i?e(t,a,n,r,l,c,i):r};return d()(s,{jsonpCallback:"_jsonp",timeout:7e3}).then(function(e){return function(e){if(!e.ok)throw Error(e.statusText||"Error desconegut");return e}(e)}).then(function(e){return e.json()}).then(function(e){return e.headers&&e.headers["X-WP-TotalPages"]&&(i=e.headers["X-WP-TotalPages"]),e.body&&r.push.apply(r,Object(o.a)(e.body)),u()}).catch(function(e){return console.log("Error fetching page ".concat(c," of ").concat(a,": ").concat(e)),u()})},E=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=a.pages,n=a.posts,r=a.categories,c=a.tags,o=a.includeCategoryPages,s=a.includeTagPages,u=t.filter(function(e){return e.selected}).length+n.filter(function(e){return e.selected}).length+(o?r.filter(function(e){return e.selected}).length:0)+(s?c.filter(function(e){return e.selected}).length:0);return e&&l(Object(i.a)({},a,{numUrls:u})),u},h=function(e){for(var t=e.length;0!==t;){var a=Math.floor(Math.random()*t),n=e[t-=1];e[t]=e[a],e[a]=n}return e};return r.a.createElement("div",{className:"App"},!f&&r.a.createElement("div",null,r.a.createElement(Q,null),r.a.createElement(V,{conf:a,setConf:l,checkSite:function(){for(var e=a.wpSite;e.endsWith("/");)e=e.substr(0,e.length-1);l(Object(i.a)({},a,{wpSite:e,err:null,loading:!0,categories:null,pages:null,posts:null,numUrls:0}));var t=[],n=[],r=[],c=[];Promise.all([p(e,"categories",["id","link","name","count"],t),p(e,"tags",["id","link","name","count"],n),p(e,"pages",["id","link","modified","type","status","title"],c),p(e,"posts",["id","link","modified","type","status","title","categories","tags"],r)]).then(function(){if(0===t.length)throw new Error("No s'ha trobat cap categoria! Podria ser que l'adre\xe7a fos incorrecta, que ara mateix no estigui funcionant o que no es tracti d'un lloc WordPress");localStorage.setItem("wpSite",e),t=t.filter(function(e){return e.count>0}).sort(function(e,t){return e.name<t.name?-1:1}),n=n.filter(function(e){return e.count>0}).sort(function(e,t){return e.name<t.name?-1:1}),[t,n,c,r].forEach(function(e){return e.forEach(function(e){return e.selected=!1})}),r.forEach(function(e){return e.inRange="post"===e.type&&"publish"===e.status}),c.forEach(function(e){return e.inRange="page"===e.type&&"publish"===e.status});var o=new Date;[c,r].forEach(function(e){e.forEach(function(e){e.modified=new Date(e.modified),e.modified<o&&(o=e.modified)}),e.sort(function(e,t){return e.modified>t.modified?-1:e.modified<t.modified?1:e.title<t.title?-1:1})}),o=new Date(o-864e5),l(Object(i.a)({},a,{loading:!1,categories:t,tags:n,pages:c,posts:r,dateFrom:o,dateTo:new Date,numUrls:0,err:null}))}).catch(function(e){console.log("Error fetching data: ".concat(e.message)),l(Object(i.a)({},a,{loading:!1,err:e.message}))})},selectPostsByDateAndCategory:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a.dateFrom,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:a.dateTo,n=a.posts,r=a.categories.filter(function(e){return e.selected}).map(function(e){return e.id}),c=a.tags.filter(function(e){return e.selected}).map(function(e){return e.id});n.forEach(function(a){var n=a.categories,l=a.tags,o=a.modified,i=a.type,s=a.status;a.inRange=o>=e&&o<=t&&"post"===i&&"publish"===s,a.selected=a.inRange&&(n.map(function(e){return r.includes(e)}).includes(!0)||l.map(function(e){return c.includes(e)}).includes(!0))}),l(Object(i.a)({},a,{dateFrom:e,dateTo:t,err:null,numUrls:E(!1)}))},countUrls:E})),!f&&r.a.createElement("div",null,r.a.createElement("div",{className:"playBtn"},r.a.createElement(w.a,{variant:"contained",color:"primary",onClick:function(){return g(!0)},disabled:0===a.numUrls},"Inicia la visualitzaci\xf3",r.a.createElement(K.a,{className:"leftIcon"}))),r.a.createElement(Z,null)),f&&r.a.createElement(m,{urls:function(){var e=a.posts,t=a.pages,n=a.categories,r=a.tags,l=a.includeCategoryPages,c=a.includeTagPages,i=a.randomOrder,s=[];return s.push.apply(s,Object(o.a)(e.filter(function(e){return e.selected}).map(function(e){return e.link}))),s.push.apply(s,Object(o.a)(t.filter(function(e){return e.selected}).map(function(e){return e.link}))),l&&s.push.apply(s,Object(o.a)(n.filter(function(e){return e.selected}).map(function(e){return e.link}))),c&&s.push.apply(s,Object(o.a)(r.filter(function(e){return e.selected}).map(function(e){return e.link}))),i?h(s):s}(),interval:a.interval}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[137,1,2]]]);
//# sourceMappingURL=main.ccfd9a54.chunk.js.map